<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="åŒ…è£…å™¨ç±»å‹ï¼Œç”¨äºåˆ›å»º `T` çš„æœªåˆå§‹åŒ–å®ä¾‹ã€‚"><title>MaybeUninit in core::mem - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-f3501f0f5ae15dfb.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="core" data-themes="" data-resource-suffix="1.71.0" data-rustdoc-version="1.71.0-dev" data-search-js="search-4926e5fc22a5646a.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="sidebar-items1.71.0.js"></script><script defer src="../../static.files/main-f0540c1d82cde29b.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc union"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../core/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../core/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">MaybeUninit</a></h2><div class="sidebar-elems"><section><h3><a href="#implementations">Methods</a></h3><ul class="block"><li><a href="#method.array_assume_init">array_assume_init</a></li><li><a href="#method.as_bytes">as_bytes</a></li><li><a href="#method.as_bytes_mut">as_bytes_mut</a></li><li><a href="#method.as_mut_ptr">as_mut_ptr</a></li><li><a href="#method.as_ptr">as_ptr</a></li><li><a href="#method.assume_init">assume_init</a></li><li><a href="#method.assume_init_drop">assume_init_drop</a></li><li><a href="#method.assume_init_mut">assume_init_mut</a></li><li><a href="#method.assume_init_read">assume_init_read</a></li><li><a href="#method.assume_init_ref">assume_init_ref</a></li><li><a href="#method.new">new</a></li><li><a href="#method.slice_as_bytes">slice_as_bytes</a></li><li><a href="#method.slice_as_bytes_mut">slice_as_bytes_mut</a></li><li><a href="#method.slice_as_mut_ptr">slice_as_mut_ptr</a></li><li><a href="#method.slice_as_ptr">slice_as_ptr</a></li><li><a href="#method.slice_assume_init_mut">slice_assume_init_mut</a></li><li><a href="#method.slice_assume_init_ref">slice_assume_init_ref</a></li><li><a href="#method.transpose">transpose</a></li><li><a href="#method.uninit">uninit</a></li><li><a href="#method.uninit_array">uninit_array</a></li><li><a href="#method.write">write</a></li><li><a href="#method.write_slice">write_slice</a></li><li><a href="#method.write_slice_cloned">write_slice_cloned</a></li><li><a href="#method.zeroed">zeroed</a></li></ul><h3><a href="#trait-implementations">Trait Implementations</a></h3><ul class="block"><li><a href="#impl-Clone-for-MaybeUninit%3CT%3E">Clone</a></li><li><a href="#impl-Copy-for-MaybeUninit%3CT%3E">Copy</a></li><li><a href="#impl-Debug-for-MaybeUninit%3CT%3E">Debug</a></li></ul><h3><a href="#synthetic-implementations">Auto Trait Implementations</a></h3><ul class="block"><li><a href="#impl-RefUnwindSafe-for-MaybeUninit%3CT%3E">RefUnwindSafe</a></li><li><a href="#impl-Send-for-MaybeUninit%3CT%3E">Send</a></li><li><a href="#impl-Sync-for-MaybeUninit%3CT%3E">Sync</a></li><li><a href="#impl-Unpin-for-MaybeUninit%3CT%3E">Unpin</a></li><li><a href="#impl-UnwindSafe-for-MaybeUninit%3CT%3E">UnwindSafe</a></li></ul><h3><a href="#blanket-implementations">Blanket Implementations</a></h3><ul class="block"><li><a href="#impl-Any-for-MaybeUninit%3CT%3E">Any</a></li><li><a href="#impl-Borrow%3CT%3E-for-MaybeUninit%3CT%3E">Borrow&lt;T&gt;</a></li><li><a href="#impl-BorrowMut%3CT%3E-for-MaybeUninit%3CT%3E">BorrowMut&lt;T&gt;</a></li><li><a href="#impl-From%3CT%3E-for-MaybeUninit%3CT%3E">From&lt;T&gt;</a></li><li><a href="#impl-Into%3CU%3E-for-MaybeUninit%3CT%3E">Into&lt;U&gt;</a></li><li><a href="#impl-TryFrom%3CU%3E-for-MaybeUninit%3CT%3E">TryFrom&lt;U&gt;</a></li><li><a href="#impl-TryInto%3CU%3E-for-MaybeUninit%3CT%3E">TryInto&lt;U&gt;</a></li></ul></section><h2><a href="index.html">In core::mem</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press â€˜Sâ€™ to search, â€˜?â€™ for more optionsâ€¦" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Union <a href="../index.html">core</a>::<wbr><a href="index.html">mem</a>::<wbr><a class="union" href="#">MaybeUninit</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><span class="since" title="Stable since Rust version 1.36.0">1.36.0</span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#249-252">source</a> Â· <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>#[repr(transparent)]
pub union MaybeUninit&lt;T&gt; {
    /* private fields */
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>åŒ…è£…å™¨ç±»å‹ï¼Œç”¨äºåˆ›å»º <code>T</code> çš„æœªåˆå§‹åŒ–å®ä¾‹ã€‚</p>
<h2 id="åˆå§‹åŒ–ä¸å˜é‡"><a href="#åˆå§‹åŒ–ä¸å˜é‡">åˆå§‹åŒ–ä¸å˜é‡</a></h2>
<p>é€šå¸¸ï¼Œç¼–è¯‘å™¨å‡å®šå·²æ ¹æ®å˜é‡ç±»å‹çš„è¦æ±‚æ­£ç¡®åˆå§‹åŒ–äº†å˜é‡ã€‚ä¾‹å¦‚ï¼Œå¼•ç”¨ç±»å‹çš„å˜é‡å¿…é¡»å¯¹é½ä¸”éç©ºã€‚
å³ä½¿åœ¨ä¸å®‰å…¨çš„ä»£ç ä¸­ï¼Œè¿™ä¹Ÿå¿…é¡»å§‹ç»ˆä¿æŒä¸å˜ã€‚
å› æ­¤ï¼Œå°†å¼•ç”¨ç±»å‹çš„å˜é‡åˆå§‹åŒ–ä¸ºé›¶ä¼šå¯¼è‡´ç¬æ—¶ <a href="../../reference/behavior-considered-undefined.html">æœªå®šä¹‰çš„è¡Œä¸º</a>ï¼Œæ— è®ºè¯¥å¼•ç”¨æ˜¯å¦æ›¾ç»ç”¨äºè®¿é—®å†…å­˜ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::{<span class="self">self</span>, MaybeUninit};

<span class="kw">let </span>x: <span class="kw-2">&amp;</span>i32 = <span class="kw">unsafe </span>{ mem::zeroed() }; <span class="comment">// æœªå®šä¹‰çš„è¡Œä¸ºï¼ âš ï¸
// ä¸ `MaybeUninit&lt;&amp;i32&gt;` ç­‰æ•ˆçš„ä»£ç ï¼š
</span><span class="kw">let </span>x: <span class="kw-2">&amp;</span>i32 = <span class="kw">unsafe </span>{ MaybeUninit::zeroed().assume_init() }; <span class="comment">// æœªå®šä¹‰çš„è¡Œä¸ºï¼ âš ï¸</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Ballow(invalid_value)%5D%0Afn+main()+%7B%0Ause+std::mem::%7Bself,+MaybeUninit%7D;%0A%0Alet+x:+%26i32+=+unsafe+%7B+mem::zeroed()+%7D;+//+%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%EF%BC%81+%E2%9A%A0%EF%B8%8F%0A//+%E4%B8%8E+%60MaybeUninit%3C%26i32%3E%60+%E7%AD%89%E6%95%88%E7%9A%84%E4%BB%A3%E7%A0%81%EF%BC%9A%0Alet+x:+%26i32+=+unsafe+%7B+MaybeUninit::zeroed().assume_init()+%7D;+//+%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%EF%BC%81+%E2%9A%A0%EF%B8%8F%0A%7D&amp;edition=2021">Run</a></div>
<p>ç¼–è¯‘å™¨åˆ©ç”¨è¿™ä¸€ç‚¹è¿›è¡Œå„ç§ä¼˜åŒ–ï¼Œä¾‹å¦‚å–æ¶ˆè¿è¡Œæ—¶æ£€æŸ¥å’Œä¼˜åŒ– <code>enum</code> å¸ƒå±€ã€‚</p>
<p>åŒæ ·ï¼Œå®Œå…¨æœªåˆå§‹åŒ–çš„å­˜å‚¨å™¨å¯ä»¥åŒ…å«ä»»ä½•å†…å®¹ï¼Œè€Œ <code>bool</code> å¿…é¡»å§‹ç»ˆä¸º <code>true</code> æˆ– <code>false</code>ã€‚å› æ­¤ï¼Œåˆ›å»ºæœªåˆå§‹åŒ–çš„ <code>bool</code> æ˜¯æœªå®šä¹‰çš„è¡Œä¸ºï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::{<span class="self">self</span>, MaybeUninit};

<span class="kw">let </span>b: bool = <span class="kw">unsafe </span>{ mem::uninitialized() }; <span class="comment">// æœªå®šä¹‰çš„è¡Œä¸ºï¼ âš ï¸
// ä¸ `MaybeUninit&lt;bool&gt;` ç­‰æ•ˆçš„ä»£ç ï¼š
</span><span class="kw">let </span>b: bool = <span class="kw">unsafe </span>{ MaybeUninit::uninit().assume_init() }; <span class="comment">// æœªå®šä¹‰çš„è¡Œä¸ºï¼ âš ï¸</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Ballow(invalid_value)%5D%0Afn+main()+%7B%0Ause+std::mem::%7Bself,+MaybeUninit%7D;%0A%0Alet+b:+bool+=+unsafe+%7B+mem::uninitialized()+%7D;+//+%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%EF%BC%81+%E2%9A%A0%EF%B8%8F%0A//+%E4%B8%8E+%60MaybeUninit%3Cbool%3E%60+%E7%AD%89%E6%95%88%E7%9A%84%E4%BB%A3%E7%A0%81%EF%BC%9A%0Alet+b:+bool+=+unsafe+%7B+MaybeUninit::uninit().assume_init()+%7D;+//+%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%EF%BC%81+%E2%9A%A0%EF%B8%8F%0A%7D&amp;edition=2021">Run</a></div>
<p>æ­¤å¤–ï¼Œæœªåˆå§‹åŒ–çš„å­˜å‚¨å™¨çš„ç‰¹æ®Šä¹‹å¤„åœ¨äºå®ƒæ²¡æœ‰å›ºå®šçš„å€¼ (â€œfixedâ€ è¡¨ç¤º â€œit wonâ€™t change without being written toâ€)ã€‚å¤šæ¬¡è¯»å–ç›¸åŒçš„æœªåˆå§‹åŒ–å­—èŠ‚ä¼šäº§ç”Ÿä¸åŒçš„ç»“æœã€‚
è¿™ä½¿å¾—åœ¨å˜é‡ä¸­å…·æœ‰æœªåˆå§‹åŒ–çš„æ•°æ®æˆä¸ºæœªå®šä¹‰çš„è¡Œä¸ºï¼Œå³ä½¿è¯¥å˜é‡å…·æœ‰æ•´æ•°ç±»å‹ä¹Ÿå¯ä»¥ä¿ç•™ä»»ä½•å›ºå®šä½æ¨¡å¼</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::{<span class="self">self</span>, MaybeUninit};

<span class="kw">let </span>x: i32 = <span class="kw">unsafe </span>{ mem::uninitialized() }; <span class="comment">// æœªå®šä¹‰çš„è¡Œä¸ºï¼ âš ï¸
// ä¸ `MaybeUninit&lt;i32&gt;` ç­‰æ•ˆçš„ä»£ç ï¼š
</span><span class="kw">let </span>x: i32 = <span class="kw">unsafe </span>{ MaybeUninit::uninit().assume_init() }; <span class="comment">// æœªå®šä¹‰çš„è¡Œä¸ºï¼ âš ï¸</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Ballow(invalid_value)%5D%0Afn+main()+%7B%0Ause+std::mem::%7Bself,+MaybeUninit%7D;%0A%0Alet+x:+i32+=+unsafe+%7B+mem::uninitialized()+%7D;+//+%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%EF%BC%81+%E2%9A%A0%EF%B8%8F%0A//+%E4%B8%8E+%60MaybeUninit%3Ci32%3E%60+%E7%AD%89%E6%95%88%E7%9A%84%E4%BB%A3%E7%A0%81%EF%BC%9A%0Alet+x:+i32+=+unsafe+%7B+MaybeUninit::uninit().assume_init()+%7D;+//+%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%EF%BC%81+%E2%9A%A0%EF%B8%8F%0A%7D&amp;edition=2021">Run</a></div>
<p>æœ€é‡è¦çš„æ˜¯ï¼Œè¯·è®°ä½ï¼Œå¤§å¤šæ•°ç±»å‹éƒ½æœ‰é¢å¤–çš„ä¸å˜é‡ï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨ç±»å‹çº§åˆ«è¢«åˆå§‹åŒ–ã€‚
ä¾‹å¦‚ï¼Œå°† <code>1</code> åˆå§‹åŒ–çš„ <a href="../../std/vec/struct.Vec.html"><code>Vec&lt;T&gt;</code></a> è§†ä¸ºå·²åˆå§‹åŒ– (åœ¨å½“å‰å®ç°ä¸‹; è¿™å¹¶ä¸æ„æˆç¨³å®šçš„ä¿è¯)ï¼Œå› ä¸ºç¼–è¯‘å™¨çŸ¥é“çš„å”¯ä¸€è¦æ±‚æ˜¯æ•°æ®æŒ‡é’ˆå¿…é¡»ä¸ºéç©ºå€¼ã€‚
åˆ›å»ºè¿™æ ·çš„ <code>Vec&lt;T&gt;</code> ä¸ä¼šç«‹å³å¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºï¼Œä½†æ˜¯åœ¨å¤§å¤šæ•°å®‰å…¨æ“ä½œ (åŒ…æ‹¬ä¸¢å¼ƒæ“ä½œ) ä¸­éƒ½å°†å¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚</p>
<h2 id="examples"><a href="#examples">Examples</a></h2>
<p><code>MaybeUninit&lt;T&gt;</code> ç”¨äºå¯ç”¨ä¸å®‰å…¨ä»£ç æ¥å¤„ç†æœªåˆå§‹åŒ–çš„æ•°æ®ã€‚
è¿™æ˜¯å‘ç¼–è¯‘å™¨å‘å‡ºçš„ä¿¡å·ï¼ŒæŒ‡ç¤ºæ­¤å¤„çš„æ•°æ®å¯èƒ½ä¸è¢«åˆå§‹åŒ–ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="comment">// åˆ›å»ºä¸€ä¸ªæ˜¾å¼æœªåˆå§‹åŒ–çš„å¼•ç”¨ã€‚
// ç¼–è¯‘å™¨çŸ¥é“ `MaybeUninit&lt;T&gt;` å†…éƒ¨çš„æ•°æ®å¯èƒ½æ— æ•ˆï¼Œå› æ­¤ä¸æ˜¯ UBï¼š
</span><span class="kw">let </span><span class="kw-2">mut </span>x = MaybeUninit::&lt;<span class="kw-2">&amp;</span>i32&gt;::uninit();
<span class="comment">// å°†å…¶è®¾ç½®ä¸ºæœ‰æ•ˆå€¼ã€‚
</span>x.write(<span class="kw-2">&amp;</span><span class="number">0</span>);
<span class="comment">// æå–å·²åˆå§‹åŒ–çš„æ•°æ® - ä»…åœ¨æ­£ç¡®åˆå§‹åŒ– `x` ä¹‹å * æ‰å…è®¸è¿™æ ·åšï¼
</span><span class="kw">let </span>x = <span class="kw">unsafe </span>{ x.assume_init() };</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0A//+%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%98%BE%E5%BC%8F%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E5%BC%95%E7%94%A8%E3%80%82%0A//+%E7%BC%96%E8%AF%91%E5%99%A8%E7%9F%A5%E9%81%93+%60MaybeUninit%3CT%3E%60+%E5%86%85%E9%83%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%83%BD%E6%97%A0%E6%95%88%EF%BC%8C%E5%9B%A0%E6%AD%A4%E4%B8%8D%E6%98%AF+UB%EF%BC%9A%0Alet+mut+x+=+MaybeUninit::%3C%26i32%3E::uninit();%0A//+%E5%B0%86%E5%85%B6%E8%AE%BE%E7%BD%AE%E4%B8%BA%E6%9C%89%E6%95%88%E5%80%BC%E3%80%82%0Ax.write(%260);%0A//+%E6%8F%90%E5%8F%96%E5%B7%B2%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E6%95%B0%E6%8D%AE+-+%E4%BB%85%E5%9C%A8%E6%AD%A3%E7%A1%AE%E5%88%9D%E5%A7%8B%E5%8C%96+%60x%60+%E4%B9%8B%E5%90%8E+*+%E6%89%8D%E5%85%81%E8%AE%B8%E8%BF%99%E6%A0%B7%E5%81%9A%EF%BC%81%0Alet+x+=+unsafe+%7B+x.assume_init()+%7D;%0A%7D&amp;edition=2021">Run</a></div>
<p>ç„¶åï¼Œç¼–è¯‘å™¨çŸ¥é“ä¸ä¼šå¯¹æ­¤ä»£ç è¿›è¡Œä»»ä½•é”™è¯¯çš„å‡è®¾æˆ–ä¼˜åŒ–ã€‚</p>
<p>æ‚¨å¯ä»¥è®¤ä¸º <code>MaybeUninit&lt;T&gt;</code> æœ‰ç‚¹åƒ <code>Option&lt;T&gt;</code>ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•è¿è¡Œæ—¶è·Ÿè¸ªä¸”æ²¡æœ‰ä»»ä½•å®‰å…¨æ£€æŸ¥ã€‚</p>
<h3 id="out-pointers"><a href="#out-pointers">out-pointers</a></h3>
<p>æ‚¨å¯ä»¥ä½¿ç”¨ <code>MaybeUninit&lt;T&gt;</code> æ¥å®ç° â€œout-pointersâ€: ä¸å…¶ä»å‡½æ•°ä¸­è¿”å›æ•°æ®ï¼Œè¿˜ä¸å¦‚å°†å…¶ä¼ é€’ç»™æŸä¸ª (uninitialized) å†…å­˜çš„æŒ‡é’ˆä»¥å°†ç»“æœæ”¾å…¥å…¶ä¸­ã€‚
å½“å¯¹è°ƒç”¨è€…æ¥è¯´ï¼Œæ§åˆ¶ç»“æœå­˜å‚¨åœ¨å†…å­˜ä¸­çš„åˆ†é…æ–¹å¼å¾ˆé‡è¦å¹¶ä¸”æ‚¨å¸Œæœ›é¿å…ä¸å¿…è¦çš„ç§»åŠ¨æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">unsafe fn </span>make_vec(out: <span class="kw-2">*mut </span>Vec&lt;i32&gt;) {
    <span class="comment">// `write` ä¸ä¸¢å¼ƒæ—§å†…å®¹ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚
    </span>out.write(<span class="macro">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);
}

<span class="kw">let </span><span class="kw-2">mut </span>v = MaybeUninit::uninit();
<span class="kw">unsafe </span>{ make_vec(v.as_mut_ptr()); }
<span class="comment">// ç°åœ¨æˆ‘ä»¬çŸ¥é“ `v` å·²åˆå§‹åŒ–ï¼ è¿™ä¹Ÿå¯ä»¥ç¡®ä¿æ­£ç¡®ä¸¢å¼ƒ vectorã€‚
</span><span class="kw">let </span>v = <span class="kw">unsafe </span>{ v.assume_init() };
<span class="macro">assert_eq!</span>(<span class="kw-2">&amp;</span>v, <span class="kw-2">&amp;</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Aunsafe+fn+make_vec(out:+*mut+Vec%3Ci32%3E)+%7B%0A++++//+%60write%60+%E4%B8%8D%E4%B8%A2%E5%BC%83%E6%97%A7%E5%86%85%E5%AE%B9%EF%BC%8C%E8%BF%99%E4%B8%80%E7%82%B9%E5%BE%88%E9%87%8D%E8%A6%81%E3%80%82%0A++++out.write(vec!%5B1,+2,+3%5D);%0A%7D%0A%0Alet+mut+v+=+MaybeUninit::uninit();%0Aunsafe+%7B+make_vec(v.as_mut_ptr());+%7D%0A//+%E7%8E%B0%E5%9C%A8%E6%88%91%E4%BB%AC%E7%9F%A5%E9%81%93+%60v%60+%E5%B7%B2%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%81+%E8%BF%99%E4%B9%9F%E5%8F%AF%E4%BB%A5%E7%A1%AE%E4%BF%9D%E6%AD%A3%E7%A1%AE%E4%B8%A2%E5%BC%83+vector%E3%80%82%0Alet+v+=+unsafe+%7B+v.assume_init()+%7D;%0Aassert_eq!(%26v,+%26%5B1,+2,+3%5D);%0A%7D&amp;edition=2021">Run</a></div>
<h3 id="é€å…ƒç´ åˆå§‹åŒ–æ•°ç»„"><a href="#é€å…ƒç´ åˆå§‹åŒ–æ•°ç»„">é€å…ƒç´ åˆå§‹åŒ–æ•°ç»„</a></h3>
<p><code>MaybeUninit&lt;T&gt;</code> å¯ç”¨äºé€ä¸ªå…ƒç´ åˆå§‹åŒ–å¤§æ•°ç»„ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::{<span class="self">self</span>, MaybeUninit};

<span class="kw">let </span>data = {
    <span class="comment">// åˆ›å»ºä¸€ä¸ªæœªåˆå§‹åŒ–çš„ `MaybeUninit` æ•°ç»„ã€‚
    // `assume_init` æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºæˆ‘ä»¬å£°ç§°è¿™é‡Œå·²ç»åˆå§‹åŒ–çš„ç±»å‹æ˜¯ä¸€å † `MaybeUninit`ï¼Œä¸éœ€è¦åˆå§‹åŒ–ã€‚
    </span><span class="kw">let </span><span class="kw-2">mut </span>data: [MaybeUninit&lt;Vec&lt;u32&gt;&gt;; <span class="number">1000</span>] = <span class="kw">unsafe </span>{
        MaybeUninit::uninit().assume_init()
    };

    <span class="comment">// ä¸¢å¼ƒ `MaybeUninit` ä»€ä¹ˆéƒ½ä¸åš
    </span><span class="kw">for </span>elem <span class="kw">in </span><span class="kw-2">&amp;mut </span>data[..] {
        elem.write(<span class="macro">vec!</span>[<span class="number">42</span>]);
    }

    <span class="comment">// ä¸€åˆ‡éƒ½å·²åˆå§‹åŒ–ã€‚
    // å°†æ•°ç»„è½¬æ¢ä¸ºåˆå§‹åŒ–çš„ç±»å‹ã€‚
    </span><span class="kw">unsafe </span>{ mem::transmute::&lt;<span class="kw">_</span>, [Vec&lt;u32&gt;; <span class="number">1000</span>]&gt;(data) }
};

<span class="macro">assert_eq!</span>(<span class="kw-2">&amp;</span>data[<span class="number">0</span>], <span class="kw-2">&amp;</span>[<span class="number">42</span>]);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::%7Bself,+MaybeUninit%7D;%0A%0Alet+data+=+%7B%0A++++//+%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84+%60MaybeUninit%60+%E6%95%B0%E7%BB%84%E3%80%82%0A++++//+%60assume_init%60+%E6%98%AF%E5%AE%89%E5%85%A8%E7%9A%84%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%88%91%E4%BB%AC%E5%A3%B0%E7%A7%B0%E8%BF%99%E9%87%8C%E5%B7%B2%E7%BB%8F%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E7%B1%BB%E5%9E%8B%E6%98%AF%E4%B8%80%E5%A0%86+%60MaybeUninit%60%EF%BC%8C%E4%B8%8D%E9%9C%80%E8%A6%81%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%82%0A++++let+mut+data:+%5BMaybeUninit%3CVec%3Cu32%3E%3E;+1000%5D+=+unsafe+%7B%0A++++++++MaybeUninit::uninit().assume_init()%0A++++%7D;%0A%0A++++//+%E4%B8%A2%E5%BC%83+%60MaybeUninit%60+%E4%BB%80%E4%B9%88%E9%83%BD%E4%B8%8D%E5%81%9A%0A++++for+elem+in+%26mut+data%5B..%5D+%7B%0A++++++++elem.write(vec!%5B42%5D);%0A++++%7D%0A%0A++++//+%E4%B8%80%E5%88%87%E9%83%BD%E5%B7%B2%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%82%0A++++//+%E5%B0%86%E6%95%B0%E7%BB%84%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E7%B1%BB%E5%9E%8B%E3%80%82%0A++++unsafe+%7B+mem::transmute::%3C_,+%5BVec%3Cu32%3E;+1000%5D%3E(data)+%7D%0A%7D;%0A%0Aassert_eq!(%26data%5B0%5D,+%26%5B42%5D);%0A%7D&amp;edition=2021">Run</a></div>
<p>æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨éƒ¨åˆ†åˆå§‹åŒ–çš„æ•°ç»„ï¼Œè¿™äº›æ•°ç»„å¯ä»¥åœ¨ä¸ç¨³å®šçš„æ•°æ®ç»“æ„ä¸­æ‰¾åˆ°ã€‚</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="comment">// åˆ›å»ºä¸€ä¸ªæœªåˆå§‹åŒ–çš„ `MaybeUninit` æ•°ç»„ã€‚
// `assume_init` æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºæˆ‘ä»¬å£°ç§°è¿™é‡Œå·²ç»åˆå§‹åŒ–çš„ç±»å‹æ˜¯ä¸€å † `MaybeUninit`ï¼Œä¸éœ€è¦åˆå§‹åŒ–ã€‚
</span><span class="kw">let </span><span class="kw-2">mut </span>data: [MaybeUninit&lt;String&gt;; <span class="number">1000</span>] = <span class="kw">unsafe </span>{ MaybeUninit::uninit().assume_init() };
<span class="comment">// è®¡ç®—æˆ‘ä»¬åˆ†é…çš„å…ƒç´ æ•°ã€‚
</span><span class="kw">let </span><span class="kw-2">mut </span>data_len: usize = <span class="number">0</span>;

<span class="kw">for </span>elem <span class="kw">in </span><span class="kw-2">&amp;mut </span>data[<span class="number">0</span>..<span class="number">500</span>] {
    elem.write(String::from(<span class="string">&quot;hello&quot;</span>));
    data_len += <span class="number">1</span>;
}

<span class="comment">// å¯¹äºæ•°ç»„ä¸­çš„æ¯ä¸ªé¡¹ï¼Œå¦‚æœæˆ‘ä»¬åˆ†é…äº†å®ƒï¼Œåˆ™å°†å…¶ä¸¢å¼ƒã€‚
</span><span class="kw">for </span>elem <span class="kw">in </span><span class="kw-2">&amp;mut </span>data[<span class="number">0</span>..data_len] {
    <span class="kw">unsafe </span>{ elem.assume_init_drop(); }
}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0A//+%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84+%60MaybeUninit%60+%E6%95%B0%E7%BB%84%E3%80%82%0A//+%60assume_init%60+%E6%98%AF%E5%AE%89%E5%85%A8%E7%9A%84%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%88%91%E4%BB%AC%E5%A3%B0%E7%A7%B0%E8%BF%99%E9%87%8C%E5%B7%B2%E7%BB%8F%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E7%B1%BB%E5%9E%8B%E6%98%AF%E4%B8%80%E5%A0%86+%60MaybeUninit%60%EF%BC%8C%E4%B8%8D%E9%9C%80%E8%A6%81%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%82%0Alet+mut+data:+%5BMaybeUninit%3CString%3E;+1000%5D+=+unsafe+%7B+MaybeUninit::uninit().assume_init()+%7D;%0A//+%E8%AE%A1%E7%AE%97%E6%88%91%E4%BB%AC%E5%88%86%E9%85%8D%E7%9A%84%E5%85%83%E7%B4%A0%E6%95%B0%E3%80%82%0Alet+mut+data_len:+usize+=+0;%0A%0Afor+elem+in+%26mut+data%5B0..500%5D+%7B%0A++++elem.write(String::from(%22hello%22));%0A++++data_len+%2B=+1;%0A%7D%0A%0A//+%E5%AF%B9%E4%BA%8E%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E6%AF%8F%E4%B8%AA%E9%A1%B9%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%88%91%E4%BB%AC%E5%88%86%E9%85%8D%E4%BA%86%E5%AE%83%EF%BC%8C%E5%88%99%E5%B0%86%E5%85%B6%E4%B8%A2%E5%BC%83%E3%80%82%0Afor+elem+in+%26mut+data%5B0..data_len%5D+%7B%0A++++unsafe+%7B+elem.assume_init_drop();+%7D%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
<h3 id="é€å­—æ®µåˆå§‹åŒ–ç»“æ„ä½“"><a href="#é€å­—æ®µåˆå§‹åŒ–ç»“æ„ä½“">é€å­—æ®µåˆå§‹åŒ–ç»“æ„ä½“</a></h3>
<p>æ‚¨å¯ä»¥ä½¿ç”¨ <code>MaybeUninit&lt;T&gt;</code> å’Œ <a href="../ptr/macro.addr_of_mut.html" title="macro core::ptr::addr_of_mut"><code>std::ptr::addr_of_mut</code></a> å®æ¥é€å­—æ®µåˆå§‹åŒ–ç»“æ„ä½“ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;
<span class="kw">use </span>std::ptr::addr_of_mut;

<span class="attr">#[derive(Debug, PartialEq)]
</span><span class="kw">pub struct </span>Foo {
    name: String,
    list: Vec&lt;u8&gt;,
}

<span class="kw">let </span>foo = {
    <span class="kw">let </span><span class="kw-2">mut </span>uninit: MaybeUninit&lt;Foo&gt; = MaybeUninit::uninit();
    <span class="kw">let </span>ptr = uninit.as_mut_ptr();

    <span class="comment">// åˆå§‹åŒ– `name` å­—æ®µ ä½¿ç”¨ `write` è€Œä¸æ˜¯é€šè¿‡ `=` èµ‹å€¼ï¼Œè€Œä¸æ˜¯åœ¨æ—§çš„ã€æœªåˆå§‹åŒ–çš„å€¼ä¸Šè°ƒç”¨ `drop`ã€‚
    </span><span class="kw">unsafe </span>{ <span class="macro">addr_of_mut!</span>((<span class="kw-2">*</span>ptr).name).write(<span class="string">&quot;Bob&quot;</span>.to_string()); }

    <span class="comment">// åˆå§‹åŒ– `list` å­—æ®µå¦‚æœæ­¤å¤„å­˜åœ¨ panicï¼Œåˆ™ `name` å­—æ®µä¸­çš„ `String` æ³„æ¼ã€‚
    </span><span class="kw">unsafe </span>{ <span class="macro">addr_of_mut!</span>((<span class="kw-2">*</span>ptr).list).write(<span class="macro">vec!</span>[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]); }

    <span class="comment">// æ‰€æœ‰å­—æ®µéƒ½å·²åˆå§‹åŒ–ï¼Œå› æ­¤æˆ‘ä»¬è°ƒç”¨ `assume_init` æ¥è·å–å·²åˆå§‹åŒ–çš„ Fooã€‚
    </span><span class="kw">unsafe </span>{ uninit.assume_init() }
};

<span class="macro">assert_eq!</span>(
    foo,
    Foo {
        name: <span class="string">&quot;Bob&quot;</span>.to_string(),
        list: <span class="macro">vec!</span>[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]
    }
);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0Ause+std::ptr::addr_of_mut;%0A%0A%23%5Bderive(Debug,+PartialEq)%5D%0Apub+struct+Foo+%7B%0A++++name:+String,%0A++++list:+Vec%3Cu8%3E,%0A%7D%0A%0Alet+foo+=+%7B%0A++++let+mut+uninit:+MaybeUninit%3CFoo%3E+=+MaybeUninit::uninit();%0A++++let+ptr+=+uninit.as_mut_ptr();%0A%0A++++//+%E5%88%9D%E5%A7%8B%E5%8C%96+%60name%60+%E5%AD%97%E6%AE%B5+%E4%BD%BF%E7%94%A8+%60write%60+%E8%80%8C%E4%B8%8D%E6%98%AF%E9%80%9A%E8%BF%87+%60=%60+%E8%B5%8B%E5%80%BC%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AF%E5%9C%A8%E6%97%A7%E7%9A%84%E3%80%81%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E5%80%BC%E4%B8%8A%E8%B0%83%E7%94%A8+%60drop%60%E3%80%82%0A++++unsafe+%7B+addr_of_mut!((*ptr).name).write(%22Bob%22.to_string());+%7D%0A%0A++++//+%E5%88%9D%E5%A7%8B%E5%8C%96+%60list%60+%E5%AD%97%E6%AE%B5%E5%A6%82%E6%9E%9C%E6%AD%A4%E5%A4%84%E5%AD%98%E5%9C%A8+panic%EF%BC%8C%E5%88%99+%60name%60+%E5%AD%97%E6%AE%B5%E4%B8%AD%E7%9A%84+%60String%60+%E6%B3%84%E6%BC%8F%E3%80%82%0A++++unsafe+%7B+addr_of_mut!((*ptr).list).write(vec!%5B0,+1,+2%5D);+%7D%0A%0A++++//+%E6%89%80%E6%9C%89%E5%AD%97%E6%AE%B5%E9%83%BD%E5%B7%B2%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%8C%E5%9B%A0%E6%AD%A4%E6%88%91%E4%BB%AC%E8%B0%83%E7%94%A8+%60assume_init%60+%E6%9D%A5%E8%8E%B7%E5%8F%96%E5%B7%B2%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84+Foo%E3%80%82%0A++++unsafe+%7B+uninit.assume_init()+%7D%0A%7D;%0A%0Aassert_eq!(%0A++++foo,%0A++++Foo+%7B%0A++++++++name:+%22Bob%22.to_string(),%0A++++++++list:+vec!%5B0,+1,+2%5D%0A++++%7D%0A);%0A%7D&amp;edition=2021">Run</a></div>
<h2 id="layout-1"><a href="#layout-1">Layout</a></h2>
<p><code>MaybeUninit&lt;T&gt;</code> ä¿è¯ä¸ <code>T</code> å…·æœ‰ç›¸åŒçš„å¤§å°ã€å¯¹é½æ–¹å¼å’Œ ABIï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::{MaybeUninit, size_of, align_of};
<span class="macro">assert_eq!</span>(size_of::&lt;MaybeUninit&lt;u64&gt;&gt;(), size_of::&lt;u64&gt;());
<span class="macro">assert_eq!</span>(align_of::&lt;MaybeUninit&lt;u64&gt;&gt;(), align_of::&lt;u64&gt;());</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::%7BMaybeUninit,+size_of,+align_of%7D;%0Aassert_eq!(size_of::%3CMaybeUninit%3Cu64%3E%3E(),+size_of::%3Cu64%3E());%0Aassert_eq!(align_of::%3CMaybeUninit%3Cu64%3E%3E(),+align_of::%3Cu64%3E());%0A%7D&amp;edition=2021">Run</a></div>
<p>ä½†æ˜¯è¯·è®°ä½ï¼Œ<em>åŒ…å«</em><code>MaybeUninit&lt;T&gt;</code> çš„ç±»å‹ä¸ä¸€å®šæ˜¯ç›¸åŒçš„å¸ƒå±€ã€‚Rust é€šå¸¸ä¸ä¿è¯ <code>Foo&lt;T&gt;</code> çš„å­—æ®µå…·æœ‰ä¸ <code>Foo&lt;U&gt;</code> ç›¸åŒçš„é¡ºåºï¼Œå³ä½¿ <code>T</code> å’Œ <code>U</code> å…·æœ‰ç›¸åŒçš„å¤§å°å’Œå¯¹é½æ–¹å¼ã€‚</p>
<p>æ­¤å¤–ï¼Œç”±äºä»»ä½•ä½å€¼å¯¹äº <code>MaybeUninit&lt;T&gt;</code> éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› æ­¤ç¼–è¯‘å™¨æ— æ³•åº”ç”¨ non-zero/niche-filling ä¼˜åŒ–ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ›´å¤§çš„å¤§å°ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="macro">assert_eq!</span>(size_of::&lt;<span class="prelude-ty">Option</span>&lt;bool&gt;&gt;(), <span class="number">1</span>);
<span class="macro">assert_eq!</span>(size_of::&lt;<span class="prelude-ty">Option</span>&lt;MaybeUninit&lt;bool&gt;&gt;&gt;(), <span class="number">2</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::%7BMaybeUninit,+size_of%7D;%0Aassert_eq!(size_of::%3COption%3Cbool%3E%3E(),+1);%0Aassert_eq!(size_of::%3COption%3CMaybeUninit%3Cbool%3E%3E%3E(),+2);%0A%7D&amp;edition=2021">Run</a></div>
<p>å¦‚æœ <code>T</code> æ˜¯ FFI å®‰å…¨çš„ï¼Œåˆ™ <code>MaybeUninit&lt;T&gt;</code> ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<p>è™½ç„¶ <code>MaybeUninit</code> æ˜¯ <code>#[repr(transparent)]</code> (è¡¨ç¤ºå®ƒä¿è¯ä¸ <code>T</code> ç›¸åŒçš„å¤§å°ï¼Œå¯¹é½æ–¹å¼å’Œ ABI)ï¼Œä½†æ˜¯è¿™ <em>ä¸ä¼š</em> æ›´æ”¹ä»»ä½•å…ˆå‰çš„è­¦å‘Šã€‚
<code>Option&lt;T&gt;</code> å’Œ <code>Option&lt;MaybeUninit&lt;T&gt;&gt;</code> å¯èƒ½ä»ç„¶å…·æœ‰ä¸åŒçš„å¤§å°ï¼Œå¹¶ä¸”åŒ…å« <code>T</code> ç±»å‹å­—æ®µçš„ç±»å‹çš„å¸ƒå±€ (å’Œå¤§å°) å¯èƒ½ä¸è¯¥å­—æ®µä¸º <code>MaybeUninit&lt;T&gt;</code> æ—¶ä¸åŒã€‚
<code>MaybeUninit</code> æ˜¯ union ç±»å‹ï¼Œunion ä¸Šçš„ <code>#[repr(transparent)]</code> ä¸ç¨³å®š (å‚è§ <a href="https://github.com/rust-lang/rust/issues/60405">è·Ÿè¸ªé—®é¢˜</a>).
éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå¯¹ union çš„ <code>#[repr(transparent)]</code> çš„ç¡®åˆ‡ä¿è¯å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¹¶ä¸” <code>MaybeUninit</code> å¯èƒ½ä¼šæˆ–å¯èƒ½ä¸ä¼šä¿ç•™ <code>#[repr(transparent)]</code>ã€‚
å°±æ˜¯è¯´ï¼Œ<code>MaybeUninit&lt;T&gt;</code> å°†æ€»æ˜¯ä¿è¯å®ƒå…·æœ‰ä¸ <code>T</code> æœ‰ç›¸åŒçš„å¤§å°ã€å¯¹é½æ–¹å¼å’Œ ABIï¼› åªæ˜¯ <code>MaybeUninit</code> å®ç°ä¿è¯çš„æ–¹å¼å¯èƒ½ä¼šæ¼”å˜ã€‚</p>
</div></details><h2 id="implementations" class="small-section-header">Implementations<a href="#implementations" class="anchor">Â§</a></h2><div id="implementations-list"><details class="toggle implementors-toggle" open><summary><section id="impl-MaybeUninit%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#270-1273">source</a><a href="#impl-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T&gt; <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.new" class="method"><span class="rightside"><span class="since" title="const since 1.36.0">const: 1.36.0</span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#290-292">source</a></span><h4 class="code-header">pub const fn <a href="#method.new" class="fn">new</a>(val: T) -&gt; <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;</h4></section></summary><div class="docblock"><p>åˆ›å»ºä¸€ä¸ªä½¿ç”¨ç»™å®šå€¼åˆå§‹åŒ–çš„æ–° <code>MaybeUninit&lt;T&gt;</code>ã€‚
åœ¨æ­¤å‡½æ•°çš„è¿”å›å€¼ä¸Šè°ƒç”¨ <a href="union.MaybeUninit.html#method.assume_init" title="method core::mem::MaybeUninit::assume_init"><code>assume_init</code></a> æ˜¯å®‰å…¨çš„ã€‚</p>
<p>æ³¨æ„ï¼Œä¸¢å¼ƒ <code>MaybeUninit&lt;T&gt;</code> æ°¸è¿œä¸ä¼šè°ƒç”¨ T çš„ä¸¢å¼ƒä»£ç ã€‚
ç¡®ä¿ <code>T</code> åœ¨åˆå§‹åŒ–æ—¶è¢«ä¸¢å¼ƒæ˜¯æ‚¨çš„è´£ä»»ã€‚</p>
<h5 id="example"><a href="#example">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span>v: MaybeUninit&lt;Vec&lt;u8&gt;&gt; = MaybeUninit::new(<span class="macro">vec!</span>[<span class="number">42</span>]);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+v:+MaybeUninit%3CVec%3Cu8%3E%3E+=+MaybeUninit::new(vec!%5B42%5D);%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.uninit" class="method"><span class="rightside"><span class="since" title="const since 1.36.0">const: 1.36.0</span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#313-315">source</a></span><h4 class="code-header">pub const fn <a href="#method.uninit" class="fn">uninit</a>() -&gt; <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;</h4></section></summary><div class="docblock"><p>ä»¥æœªåˆå§‹åŒ–çš„çŠ¶æ€åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>MaybeUninit&lt;T&gt;</code>ã€‚</p>
<p>æ³¨æ„ï¼Œä¸¢å¼ƒ <code>MaybeUninit&lt;T&gt;</code> æ°¸è¿œä¸ä¼šè°ƒç”¨ T çš„ä¸¢å¼ƒä»£ç ã€‚
ç¡®ä¿ <code>T</code> åœ¨åˆå§‹åŒ–æ—¶è¢«ä¸¢å¼ƒæ˜¯æ‚¨çš„è´£ä»»ã€‚</p>
<p>æœ‰å…³ä¸€äº›ç¤ºä¾‹ï¼Œè¯·å‚è§ <a href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">ç±»å‹çº§æ–‡æ¡£</a>ã€‚</p>
<h5 id="example-1"><a href="#example-1">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span>v: MaybeUninit&lt;String&gt; = MaybeUninit::uninit();</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+v:+MaybeUninit%3CString%3E+=+MaybeUninit::uninit();%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.uninit_array" class="method"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/96097" title="Tracking issue for const_maybe_uninit_uninit_array">unstable</a></span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#350-353">source</a></span><h4 class="code-header">pub fn <a href="#method.uninit_array" class="fn">uninit_array</a>&lt;const N: <a class="primitive" href="../primitive.usize.html">usize</a>&gt;() -&gt; <a class="primitive" href="../primitive.array.html">[Self; N]</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_uninit_array</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/96097">#96097</a>)</span></div></span></summary><div class="docblock"><p>åœ¨æœªåˆå§‹åŒ–çŠ¶æ€ä¸‹åˆ›å»º <code>MaybeUninit&lt;T&gt;</code> é¡¹çš„æ–°æ•°ç»„ã€‚</p>
<p>Note: åœ¨ future Rust ç‰ˆæœ¬ä¸­ï¼Œå½“ Rust å…è®¸ <a href="https://github.com/rust-lang/rust/issues/76001">å†…è”å¸¸é‡è¡¨è¾¾å¼</a> æ—¶ï¼Œæ­¤æ–¹æ³•å¯èƒ½å˜å¾—ä¸å¿…è¦ã€‚</p>
<p>ä¸‹é¢çš„ç¤ºä¾‹å¯ä»¥ä½¿ç”¨ <code>let mut buf = [const { MaybeUninit::&lt;u8&gt;::uninit() }; 32];</code>ã€‚</p>
<h5 id="examples-1"><a href="#examples-1">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(maybe_uninit_uninit_array, maybe_uninit_slice)]

</span><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">extern </span><span class="string">&quot;C&quot; </span>{
    <span class="kw">fn </span>read_into_buffer(ptr: <span class="kw-2">*mut </span>u8, max_len: usize) -&gt; usize;
}

<span class="doccomment">/// è¿”å›å®é™…è¯»å–çš„ (å¯èƒ½è¾ƒå°çš„) æ•°æ®åˆ‡ç‰‡
</span><span class="kw">fn </span>read(buf: <span class="kw-2">&amp;mut </span>[MaybeUninit&lt;u8&gt;]) -&gt; <span class="kw-2">&amp;</span>[u8] {
    <span class="kw">unsafe </span>{
        <span class="kw">let </span>len = read_into_buffer(buf.as_mut_ptr() <span class="kw">as </span><span class="kw-2">*mut </span>u8, buf.len());
        MaybeUninit::slice_assume_init_ref(<span class="kw-2">&amp;</span>buf[..len])
    }
}

<span class="kw">let </span><span class="kw-2">mut </span>buf: [MaybeUninit&lt;u8&gt;; <span class="number">32</span>] = MaybeUninit::uninit_array();
<span class="kw">let </span>data = read(<span class="kw-2">&amp;mut </span>buf);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(maybe_uninit_uninit_array,+maybe_uninit_slice)%5D%0A%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Aextern+%22C%22+%7B%0A++++fn+read_into_buffer(ptr:+*mut+u8,+max_len:+usize)+-%3E+usize;%0A%7D%0A%0A///+%E8%BF%94%E5%9B%9E%E5%AE%9E%E9%99%85%E8%AF%BB%E5%8F%96%E7%9A%84+(%E5%8F%AF%E8%83%BD%E8%BE%83%E5%B0%8F%E7%9A%84)+%E6%95%B0%E6%8D%AE%E5%88%87%E7%89%87%0Afn+read(buf:+%26mut+%5BMaybeUninit%3Cu8%3E%5D)+-%3E+%26%5Bu8%5D+%7B%0A++++unsafe+%7B%0A++++++++let+len+=+read_into_buffer(buf.as_mut_ptr()+as+*mut+u8,+buf.len());%0A++++++++MaybeUninit::slice_assume_init_ref(%26buf%5B..len%5D)%0A++++%7D%0A%7D%0A%0Alet+mut+buf:+%5BMaybeUninit%3Cu8%3E;+32%5D+=+MaybeUninit::uninit_array();%0Alet+data+=+read(%26mut+buf);%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.zeroed" class="method"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/91850" title="Tracking issue for const_maybe_uninit_zeroed">unstable</a></span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#395-402">source</a></span><h4 class="code-header">pub fn <a href="#method.zeroed" class="fn">zeroed</a>() -&gt; <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;</h4></section></summary><div class="docblock"><p>åœ¨æœªåˆå§‹åŒ–çŠ¶æ€ä¸‹åˆ›å»ºæ–°çš„ <code>MaybeUninit&lt;T&gt;</code>ï¼Œå¹¶ç”¨ <code>0</code> å­—èŠ‚å¡«å……å†…å­˜ã€‚å–å†³äº <code>T</code> æ˜¯å¦å·²ç»è¿›è¡Œäº†æ­£ç¡®çš„åˆå§‹åŒ–ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåˆå§‹åŒ– <code>MaybeUninit&lt;usize&gt;::zeroed()</code>ï¼Œä½†ä¸åˆå§‹åŒ– <code>MaybeUninit&lt;&amp;'static i32&gt;::zeroed()</code>ï¼Œå› ä¸ºå¼•ç”¨ä¸èƒ½ä¸ºç©ºã€‚</p>
<p>æ³¨æ„ï¼Œä¸¢å¼ƒ <code>MaybeUninit&lt;T&gt;</code> æ°¸è¿œä¸ä¼šè°ƒç”¨ T çš„ä¸¢å¼ƒä»£ç ã€‚
ç¡®ä¿ <code>T</code> åœ¨åˆå§‹åŒ–æ—¶è¢«ä¸¢å¼ƒæ˜¯æ‚¨çš„è´£ä»»ã€‚</p>
<h5 id="example-2"><a href="#example-2">Example</a></h5>
<p>æ­¤å‡½æ•°çš„æ­£ç¡®ç”¨æ³•ï¼šç”¨é›¶åˆå§‹åŒ–ç»“æ„ä½“ï¼Œå…¶ä¸­ç»“æ„ä½“çš„æ‰€æœ‰å­—æ®µéƒ½å¯ä»¥å°†ä½æ¨¡å¼ 0 ä¿ç•™ä¸ºæœ‰æ•ˆå€¼ã€‚</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span>x = MaybeUninit::&lt;(u8, bool)&gt;::zeroed();
<span class="kw">let </span>x = <span class="kw">unsafe </span>{ x.assume_init() };
<span class="macro">assert_eq!</span>(x, (<span class="number">0</span>, <span class="bool-val">false</span>));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+x+=+MaybeUninit::%3C(u8,+bool)%3E::zeroed();%0Alet+x+=+unsafe+%7B+x.assume_init()+%7D;%0Aassert_eq!(x,+(0,+false));%0A%7D&amp;edition=2021">Run</a></div>
<p>è¯¥å‡½æ•°çš„ <em>é”™è¯¯</em> ç”¨æ³•ï¼šå½“ <code>0</code> ä¸æ˜¯è¯¥ç±»å‹çš„æœ‰æ•ˆä½æ¨¡å¼æ—¶ï¼Œè°ƒç”¨ <code>x.zeroed().assume_init()</code>ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">enum </span>NotZero { One = <span class="number">1</span>, Two = <span class="number">2 </span>}

<span class="kw">let </span>x = MaybeUninit::&lt;(u8, NotZero)&gt;::zeroed();
<span class="kw">let </span>x = <span class="kw">unsafe </span>{ x.assume_init() };
<span class="comment">// åœ¨ä¸€ä¸ªå¯¹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ²¡æœ‰æœ‰æ•ˆåˆ¤åˆ«å¼çš„ `NotZero`ã€‚
// è¿™æ˜¯æœªå®šä¹‰çš„è¡Œä¸ºã€‚âš ï¸</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Aenum+NotZero+%7B+One+=+1,+Two+=+2+%7D%0A%0Alet+x+=+MaybeUninit::%3C(u8,+NotZero)%3E::zeroed();%0Alet+x+=+unsafe+%7B+x.assume_init()+%7D;%0A//+%E5%9C%A8%E4%B8%80%E4%B8%AA%E5%AF%B9%E4%B8%AD%EF%BC%8C%E6%88%91%E4%BB%AC%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%B2%A1%E6%9C%89%E6%9C%89%E6%95%88%E5%88%A4%E5%88%AB%E5%BC%8F%E7%9A%84+%60NotZero%60%E3%80%82%0A//+%E8%BF%99%E6%98%AF%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%E3%80%82%E2%9A%A0%EF%B8%8F%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.write" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.55.0, const unstable">1.55.0 (const: <a href="https://github.com/rust-lang/rust/issues/63567" title="Tracking issue for const_maybe_uninit_write">unstable</a>)</span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#488-492">source</a></span><h4 class="code-header">pub fn <a href="#method.write" class="fn">write</a>(&amp;mut self, val: T) -&gt; <a class="primitive" href="../primitive.reference.html">&amp;mut T</a></h4></section></summary><div class="docblock"><p>è®¾ç½® <code>MaybeUninit&lt;T&gt;</code> çš„å€¼ã€‚</p>
<p>è¿™å°†è¦†ç›–ä»»ä½•å…ˆå‰çš„å€¼è€Œä¸å°†å…¶ä¸¢å¼ƒï¼Œå› æ­¤è¯·æ³¨æ„ä¸è¦é‡å¤ä½¿ç”¨æ­¤ä¸¤æ¬¡ï¼Œé™¤éæ‚¨è¦è·³è¿‡è¿è¡Œææ„å‡½æ•°ã€‚
ä¸ºäº†æ‚¨çš„æ–¹ä¾¿ï¼Œè¿™ä¹Ÿå°† <code>self</code> çš„å†…å®¹ (ç°åœ¨å·²å®‰å…¨åˆå§‹åŒ–) è¿”å›å˜é‡å¼•ç”¨ã€‚</p>
<p>ç”±äºå†…å®¹å­˜å‚¨åœ¨ <code>MaybeUninit</code> ä¸­ï¼Œå¦‚æœ MaybeUninit ç¦»å¼€ä½œç”¨åŸŸè€Œæ²¡æœ‰è°ƒç”¨åˆ° <a href="union.MaybeUninit.html#method.assume_init" title="method core::mem::MaybeUninit::assume_init"><code>assume_init</code></a>ã€<a href="union.MaybeUninit.html#method.assume_init_drop" title="method core::mem::MaybeUninit::assume_init_drop"><code>assume_init_drop</code></a> æˆ–ç±»ä¼¼å¯¹è±¡ï¼Œåˆ™ä¸ä¼šä¸ºå†…éƒ¨æ•°æ®è¿è¡Œææ„å‡½æ•°ã€‚
æ¥æ”¶è¯¥å‡½æ•°è¿”å›çš„å¯å˜å¼•ç”¨çš„ä»£ç éœ€è¦è®°ä½è¿™ä¸€ç‚¹ã€‚
Rust çš„å®‰å…¨æ¨¡å‹è®¤ä¸ºæ³„æ¼æ˜¯å®‰å…¨çš„ï¼Œä½†å®ƒä»¬é€šå¸¸ä»ç„¶æ˜¯ä¸å¯å–çš„ã€‚
è¯è™½è¿™ä¹ˆè¯´ï¼Œä½†å€Ÿç”¨å¼•ç”¨ä¸å…¶ä»–ä»»ä½•ä¸€ä¸ªå€Ÿç”¨å¼•ç”¨ä¸€æ ·ï¼Œå› æ­¤ä¸ºå…¶èµ‹äºˆæ–°çš„å€¼å°†æ‘’å¼ƒæ—§çš„å†…å®¹ã€‚</p>
<h5 id="examples-2"><a href="#examples-2">Examples</a></h5>
<p>æ­£ç¡®ä½¿ç”¨æ­¤æ–¹æ³•ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>x = MaybeUninit::&lt;Vec&lt;u8&gt;&gt;::uninit();

{
    <span class="kw">let </span>hello = x.write((<span class="kw-2">&amp;</span><span class="string">b&quot;Hello, world!&quot;</span>).to_vec());
    <span class="comment">// è®¾ç½® hello ä¸ä¼šé¢„å…ˆåˆ†é…ï¼Œä½†ä¸ä¼šæ³„æ¼å®ƒä»¬
    </span><span class="kw-2">*</span>hello = (<span class="kw-2">&amp;</span><span class="string">b&quot;Hello&quot;</span>).to_vec();
    hello[<span class="number">0</span>] = <span class="string">&#39;h&#39; </span><span class="kw">as </span>u8;
}
<span class="comment">// x ç°åœ¨åˆå§‹åŒ–ï¼š
</span><span class="kw">let </span>s = <span class="kw">unsafe </span>{ x.assume_init() };
<span class="macro">assert_eq!</span>(<span class="string">b&quot;hello&quot;</span>, s.as_slice());</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+x+=+MaybeUninit::%3CVec%3Cu8%3E%3E::uninit();%0A%0A%7B%0A++++let+hello+=+x.write((%26b%22Hello,+world!%22).to_vec());%0A++++//+%E8%AE%BE%E7%BD%AE+hello+%E4%B8%8D%E4%BC%9A%E9%A2%84%E5%85%88%E5%88%86%E9%85%8D%EF%BC%8C%E4%BD%86%E4%B8%8D%E4%BC%9A%E6%B3%84%E6%BC%8F%E5%AE%83%E4%BB%AC%0A++++*hello+=+(%26b%22Hello%22).to_vec();%0A++++hello%5B0%5D+=+'h'+as+u8;%0A%7D%0A//+x+%E7%8E%B0%E5%9C%A8%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%9A%0Alet+s+=+unsafe+%7B+x.assume_init()+%7D;%0Aassert_eq!(b%22hello%22,+s.as_slice());%0A%7D&amp;edition=2021">Run</a></div>
<p>è¯¥æ–¹æ³•çš„è¿™ç§ç”¨æ³•ä¼šå¯¼è‡´æ³„æ¼ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>x = MaybeUninit::&lt;String&gt;::uninit();

x.write(<span class="string">&quot;Hello&quot;</span>.to_string());
<span class="comment">// è¿™ä¼šæ³„æ¼åŒ…å«çš„å­—ç¬¦ä¸²ï¼š
</span>x.write(<span class="string">&quot;hello&quot;</span>.to_string());
<span class="comment">// x ç°åœ¨åˆå§‹åŒ–ï¼š
</span><span class="kw">let </span>s = <span class="kw">unsafe </span>{ x.assume_init() };</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+x+=+MaybeUninit::%3CString%3E::uninit();%0A%0Ax.write(%22Hello%22.to_string());%0A//+%E8%BF%99%E4%BC%9A%E6%B3%84%E6%BC%8F%E5%8C%85%E5%90%AB%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%9A%0Ax.write(%22hello%22.to_string());%0A//+x+%E7%8E%B0%E5%9C%A8%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%9A%0Alet+s+=+unsafe+%7B+x.assume_init()+%7D;%0A%7D&amp;edition=2021">Run</a></div>
<p>è¿™ç§æ–¹æ³•å¯ä»¥ç”¨æ¥é¿å…åœ¨æŸäº›æƒ…å†µä¸‹ä¸å®‰å…¨ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªå›ºå®šå¤§å°çš„ arena å®ç°çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæä¾›äº†å›ºå®šçš„å¼•ç”¨ã€‚
æœ‰äº† <code>write</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥é¿å…é€šè¿‡è£¸æŒ‡é’ˆè·¯å¾„æ¥å†™ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>core::pin::Pin;
<span class="kw">use </span>core::mem::MaybeUninit;

<span class="kw">struct </span>PinArena&lt;T&gt; {
    memory: Box&lt;[MaybeUninit&lt;T&gt;]&gt;,
    len: usize,
}

<span class="kw">impl </span>&lt;T&gt; PinArena&lt;T&gt; {
    <span class="kw">pub fn </span>capacity(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; usize {
        <span class="self">self</span>.memory.len()
    }
    <span class="kw">pub fn </span>push(<span class="kw-2">&amp;mut </span><span class="self">self</span>, val: T) -&gt; Pin&lt;<span class="kw-2">&amp;mut </span>T&gt; {
        <span class="kw">if </span><span class="self">self</span>.len &gt;= <span class="self">self</span>.capacity() {
            <span class="macro">panic!</span>(<span class="string">&quot;Attempted to push to a full pin arena!&quot;</span>);
        }
        <span class="kw">let </span>ref_ = <span class="self">self</span>.memory[<span class="self">self</span>.len].write(val);
        <span class="self">self</span>.len += <span class="number">1</span>;
        <span class="kw">unsafe </span>{ Pin::new_unchecked(ref_) }
    }
}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23%5Ballow(unused_extern_crates)%5D%0Aextern+crate+r%23core;%0Afn+main()+%7B%0Ause+core::pin::Pin;%0Ause+core::mem::MaybeUninit;%0A%0Astruct+PinArena%3CT%3E+%7B%0A++++memory:+Box%3C%5BMaybeUninit%3CT%3E%5D%3E,%0A++++len:+usize,%0A%7D%0A%0Aimpl+%3CT%3E+PinArena%3CT%3E+%7B%0A++++pub+fn+capacity(%26self)+-%3E+usize+%7B%0A++++++++self.memory.len()%0A++++%7D%0A++++pub+fn+push(%26mut+self,+val:+T)+-%3E+Pin%3C%26mut+T%3E+%7B%0A++++++++if+self.len+%3E=+self.capacity()+%7B%0A++++++++++++panic!(%22Attempted+to+push+to+a+full+pin+arena!%22);%0A++++++++%7D%0A++++++++let+ref_+=+self.memory%5Bself.len%5D.write(val);%0A++++++++self.len+%2B=+1;%0A++++++++unsafe+%7B+Pin::new_unchecked(ref_)+%7D%0A++++%7D%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.as_ptr" class="method"><span class="rightside"><span class="since" title="const since 1.59.0">const: 1.59.0</span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#528-531">source</a></span><h4 class="code-header">pub const fn <a href="#method.as_ptr" class="fn">as_ptr</a>(&amp;self) -&gt; <a class="primitive" href="../primitive.pointer.html">*const T</a></h4></section></summary><div class="docblock"><p>è·å–æŒ‡å‘æ‰€åŒ…å«å€¼çš„æŒ‡é’ˆã€‚
é™¤éåˆå§‹åŒ– <code>MaybeUninit&lt;T&gt;</code>ï¼Œå¦åˆ™ä»è¯¥æŒ‡é’ˆè¯»å–æˆ–å°†å…¶è½¬æ¢ä¸º quot æ˜¯æœªå®šä¹‰çš„è¡Œä¸ºã€‚
å†™å…¥è¯¥æŒ‡é’ˆ (non-transitively) æŒ‡å‘çš„å†…å­˜æ˜¯æœªå®šä¹‰çš„è¡Œä¸º (<code>UnsafeCell&lt;T&gt;</code> å†…éƒ¨é™¤å¤–)ã€‚</p>
<h5 id="examples-3"><a href="#examples-3">Examples</a></h5>
<p>æ­£ç¡®ä½¿ç”¨æ­¤æ–¹æ³•ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>x = MaybeUninit::&lt;Vec&lt;u32&gt;&gt;::uninit();
x.write(<span class="macro">vec!</span>[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]);
<span class="comment">// åœ¨ `MaybeUninit&lt;T&gt;` ä¸­åˆ›å»ºå¼•ç”¨ã€‚å¯ä»¥ï¼Œå› ä¸ºæˆ‘ä»¬å·²å°†å…¶åˆå§‹åŒ–ã€‚
</span><span class="kw">let </span>x_vec = <span class="kw">unsafe </span>{ <span class="kw-2">&amp;*</span>x.as_ptr() };
<span class="macro">assert_eq!</span>(x_vec.len(), <span class="number">3</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+x+=+MaybeUninit::%3CVec%3Cu32%3E%3E::uninit();%0Ax.write(vec!%5B0,+1,+2%5D);%0A//+%E5%9C%A8+%60MaybeUninit%3CT%3E%60+%E4%B8%AD%E5%88%9B%E5%BB%BA%E5%BC%95%E7%94%A8%E3%80%82%E5%8F%AF%E4%BB%A5%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%88%91%E4%BB%AC%E5%B7%B2%E5%B0%86%E5%85%B6%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%82%0Alet+x_vec+=+unsafe+%7B+%26*x.as_ptr()+%7D;%0Aassert_eq!(x_vec.len(),+3);%0A%7D&amp;edition=2021">Run</a></div>
<p>è¿™ä¸ªæ–¹æ³•çš„é”™è¯¯ç”¨æ³•ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span>x = MaybeUninit::&lt;Vec&lt;u32&gt;&gt;::uninit();
<span class="kw">let </span>x_vec = <span class="kw">unsafe </span>{ <span class="kw-2">&amp;*</span>x.as_ptr() };
<span class="comment">// æˆ‘ä»¬åˆ›å»ºäº†å¯¹æœªåˆå§‹åŒ–çš„ vector çš„å¼•ç”¨ï¼ è¿™æ˜¯æœªå®šä¹‰çš„è¡Œä¸ºã€‚âš ï¸</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+x+=+MaybeUninit::%3CVec%3Cu32%3E%3E::uninit();%0Alet+x_vec+=+unsafe+%7B+%26*x.as_ptr()+%7D;%0A//+%E6%88%91%E4%BB%AC%E5%88%9B%E5%BB%BA%E4%BA%86%E5%AF%B9%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84+vector+%E7%9A%84%E5%BC%95%E7%94%A8%EF%BC%81+%E8%BF%99%E6%98%AF%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%E3%80%82%E2%9A%A0%EF%B8%8F%0A%7D&amp;edition=2021">Run</a></div>
<p>(è¯·æ³¨æ„ï¼Œå›´ç»•æœªåˆå§‹åŒ–æ•°æ®å¼•ç”¨çš„è§„åˆ™å°šæœªæœ€ç»ˆç¡®å®šï¼Œä½†æ˜¯é™¤éè¢«ç¡®å®šï¼Œå¦åˆ™å»ºè®®é¿å…ä½¿ç”¨å®ƒä»¬ã€‚)</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.as_mut_ptr" class="method"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/75251" title="Tracking issue for const_maybe_uninit_as_mut_ptr">unstable</a></span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#567-570">source</a></span><h4 class="code-header">pub fn <a href="#method.as_mut_ptr" class="fn">as_mut_ptr</a>(&amp;mut self) -&gt; <a class="primitive" href="../primitive.pointer.html">*mut T</a></h4></section></summary><div class="docblock"><p>è·å–æŒ‡å‘åŒ…å«å€¼çš„å¯å˜æŒ‡é’ˆã€‚
é™¤éåˆå§‹åŒ– <code>MaybeUninit&lt;T&gt;</code>ï¼Œå¦åˆ™ä»è¯¥æŒ‡é’ˆè¯»å–æˆ–å°†å…¶è½¬æ¢ä¸º quot æ˜¯æœªå®šä¹‰çš„è¡Œä¸ºã€‚</p>
<h5 id="examples-4"><a href="#examples-4">Examples</a></h5>
<p>æ­£ç¡®ä½¿ç”¨æ­¤æ–¹æ³•ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>x = MaybeUninit::&lt;Vec&lt;u32&gt;&gt;::uninit();
x.write(<span class="macro">vec!</span>[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]);
<span class="comment">// åœ¨ `MaybeUninit&lt;Vec&lt;u32&gt;&gt;` ä¸­åˆ›å»ºå¼•ç”¨ã€‚
// å¯ä»¥ï¼Œå› ä¸ºæˆ‘ä»¬å·²å°†å…¶åˆå§‹åŒ–ã€‚
</span><span class="kw">let </span>x_vec = <span class="kw">unsafe </span>{ <span class="kw-2">&amp;mut *</span>x.as_mut_ptr() };
x_vec.push(<span class="number">3</span>);
<span class="macro">assert_eq!</span>(x_vec.len(), <span class="number">4</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+x+=+MaybeUninit::%3CVec%3Cu32%3E%3E::uninit();%0Ax.write(vec!%5B0,+1,+2%5D);%0A//+%E5%9C%A8+%60MaybeUninit%3CVec%3Cu32%3E%3E%60+%E4%B8%AD%E5%88%9B%E5%BB%BA%E5%BC%95%E7%94%A8%E3%80%82%0A//+%E5%8F%AF%E4%BB%A5%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%88%91%E4%BB%AC%E5%B7%B2%E5%B0%86%E5%85%B6%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%82%0Alet+x_vec+=+unsafe+%7B+%26mut+*x.as_mut_ptr()+%7D;%0Ax_vec.push(3);%0Aassert_eq!(x_vec.len(),+4);%0A%7D&amp;edition=2021">Run</a></div>
<p>è¿™ä¸ªæ–¹æ³•çš„é”™è¯¯ç”¨æ³•ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>x = MaybeUninit::&lt;Vec&lt;u32&gt;&gt;::uninit();
<span class="kw">let </span>x_vec = <span class="kw">unsafe </span>{ <span class="kw-2">&amp;mut *</span>x.as_mut_ptr() };
<span class="comment">// æˆ‘ä»¬åˆ›å»ºäº†å¯¹æœªåˆå§‹åŒ–çš„ vector çš„å¼•ç”¨ï¼ è¿™æ˜¯æœªå®šä¹‰çš„è¡Œä¸ºã€‚âš ï¸</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+x+=+MaybeUninit::%3CVec%3Cu32%3E%3E::uninit();%0Alet+x_vec+=+unsafe+%7B+%26mut+*x.as_mut_ptr()+%7D;%0A//+%E6%88%91%E4%BB%AC%E5%88%9B%E5%BB%BA%E4%BA%86%E5%AF%B9%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84+vector+%E7%9A%84%E5%BC%95%E7%94%A8%EF%BC%81+%E8%BF%99%E6%98%AF%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%E3%80%82%E2%9A%A0%EF%B8%8F%0A%7D&amp;edition=2021">Run</a></div>
<p>(è¯·æ³¨æ„ï¼Œå›´ç»•æœªåˆå§‹åŒ–æ•°æ®å¼•ç”¨çš„è§„åˆ™å°šæœªæœ€ç»ˆç¡®å®šï¼Œä½†æ˜¯é™¤éè¢«ç¡®å®šï¼Œå¦åˆ™å»ºè®®é¿å…ä½¿ç”¨å®ƒä»¬ã€‚)</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.assume_init" class="method"><span class="rightside"><span class="since" title="const since 1.59.0">const: 1.59.0</span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#622-629">source</a></span><h4 class="code-header">pub const unsafe fn <a href="#method.assume_init" class="fn">assume_init</a>(self) -&gt; T</h4></section></summary><div class="docblock"><p>ä» <code>MaybeUninit&lt;T&gt;</code> å®¹å™¨ä¸­æå–å€¼ã€‚è¿™æ˜¯ç¡®ä¿æ•°æ®å°†è¢«ä¸¢å¼ƒçš„å¥½æ–¹æ³•ï¼Œå› ä¸ºç”Ÿæˆçš„ <code>T</code> å—åˆ°é€šå¸¸çš„ä¸¢å¼ƒå¤„ç†ã€‚</p>
<h5 id="safety"><a href="#safety">Safety</a></h5>
<p>å–å†³äºè°ƒç”¨è€…ï¼Œä»¥ç¡®ä¿ <code>MaybeUninit&lt;T&gt;</code> ç¡®å®å¤„äºåˆå§‹åŒ–çŠ¶æ€ã€‚åœ¨å†…å®¹å°šæœªå®Œå…¨åˆå§‹åŒ–æ—¶è°ƒç”¨æ­¤æ–¹æ³•ä¼šç«‹å³å¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚
<a href="#initialization-invariant">ç±»å‹çº§æ–‡æ¡£</a> ä¸­åŒ…å«äº†æœ‰å…³æ­¤åˆå§‹åŒ–ä¸å˜é‡çš„æ›´å¤šä¿¡æ¯ã€‚</p>
<p>æœ€é‡è¦çš„æ˜¯ï¼Œè¯·è®°ä½ï¼Œå¤§å¤šæ•°ç±»å‹éƒ½æœ‰é¢å¤–çš„ä¸å˜é‡ï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨ç±»å‹çº§åˆ«è¢«åˆå§‹åŒ–ã€‚
ä¾‹å¦‚ï¼Œå°† <code>1</code> åˆå§‹åŒ–çš„ <a href="../../std/vec/struct.Vec.html"><code>Vec&lt;T&gt;</code></a> è§†ä¸ºå·²åˆå§‹åŒ– (åœ¨å½“å‰å®ç°ä¸‹; è¿™å¹¶ä¸æ„æˆç¨³å®šçš„ä¿è¯)ï¼Œå› ä¸ºç¼–è¯‘å™¨çŸ¥é“çš„å”¯ä¸€è¦æ±‚æ˜¯æ•°æ®æŒ‡é’ˆå¿…é¡»ä¸ºéç©ºå€¼ã€‚</p>
<p>åˆ›å»ºè¿™æ ·çš„ <code>Vec&lt;T&gt;</code> ä¸ä¼šç«‹å³å¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºï¼Œä½†æ˜¯åœ¨å¤§å¤šæ•°å®‰å…¨æ“ä½œ (åŒ…æ‹¬ä¸¢å¼ƒæ“ä½œ) ä¸­éƒ½å°†å¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚</p>
<h5 id="examples-5"><a href="#examples-5">Examples</a></h5>
<p>æ­£ç¡®ä½¿ç”¨æ­¤æ–¹æ³•ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>x = MaybeUninit::&lt;bool&gt;::uninit();
x.write(<span class="bool-val">true</span>);
<span class="kw">let </span>x_init = <span class="kw">unsafe </span>{ x.assume_init() };
<span class="macro">assert_eq!</span>(x_init, <span class="bool-val">true</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+x+=+MaybeUninit::%3Cbool%3E::uninit();%0Ax.write(true);%0Alet+x_init+=+unsafe+%7B+x.assume_init()+%7D;%0Aassert_eq!(x_init,+true);%0A%7D&amp;edition=2021">Run</a></div>
<p>è¿™ä¸ªæ–¹æ³•çš„é”™è¯¯ç”¨æ³•ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span>x = MaybeUninit::&lt;Vec&lt;u32&gt;&gt;::uninit();
<span class="kw">let </span>x_init = <span class="kw">unsafe </span>{ x.assume_init() };
<span class="comment">// `x` å°šæœªåˆå§‹åŒ–ï¼Œå› æ­¤æœ€åä¸€è¡Œå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚âš ï¸</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+x+=+MaybeUninit::%3CVec%3Cu32%3E%3E::uninit();%0Alet+x_init+=+unsafe+%7B+x.assume_init()+%7D;%0A//+%60x%60+%E5%B0%9A%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%8C%E5%9B%A0%E6%AD%A4%E6%9C%80%E5%90%8E%E4%B8%80%E8%A1%8C%E5%AF%BC%E8%87%B4%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%E3%80%82%E2%9A%A0%EF%B8%8F%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.assume_init_read" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.60.0, const unstable">1.60.0 (const: <a href="https://github.com/rust-lang/rust/issues/63567" title="Tracking issue for const_maybe_uninit_assume_init_read">unstable</a>)</span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#692-699">source</a></span><h4 class="code-header">pub unsafe fn <a href="#method.assume_init_read" class="fn">assume_init_read</a>(&amp;self) -&gt; T</h4></section></summary><div class="docblock"><p>ä» <code>MaybeUninit&lt;T&gt;</code> å®¹å™¨ä¸­è¯»å–å€¼ã€‚ç»“æœ <code>T</code> å—é€šå¸¸çš„ drop å¤„ç†å½±å“ã€‚</p>
<p>åªè¦æœ‰å¯èƒ½ï¼Œæœ€å¥½æ”¹ç”¨ <a href="union.MaybeUninit.html#method.assume_init" title="method core::mem::MaybeUninit::assume_init"><code>assume_init</code></a>ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢é‡å¤ <code>MaybeUninit&lt;T&gt;</code> çš„å†…å®¹ã€‚</p>
<h5 id="safety-1"><a href="#safety-1">Safety</a></h5>
<p>å–å†³äºè°ƒç”¨è€…ï¼Œä»¥ç¡®ä¿ <code>MaybeUninit&lt;T&gt;</code> ç¡®å®å¤„äºåˆå§‹åŒ–çŠ¶æ€ã€‚åœ¨å†…å®¹å°šæœªå®Œå…¨åˆå§‹åŒ–æ—¶è°ƒç”¨æ­¤æ–¹æ³•ä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚
<a href="#initialization-invariant">ç±»å‹çº§æ–‡æ¡£</a> ä¸­åŒ…å«äº†æœ‰å…³æ­¤åˆå§‹åŒ–ä¸å˜é‡çš„æ›´å¤šä¿¡æ¯ã€‚</p>
<p>æ­¤å¤–ï¼Œç±»ä¼¼äº <a href="../ptr/fn.read.html" title="fn core::ptr::read"><code>ptr::read</code></a> å‡½æ•°ï¼Œè¯¥å‡½æ•°åˆ›å»ºå†…å®¹çš„æŒ‰ä½å‰¯æœ¬ï¼Œæ— è®ºæ‰€åŒ…å«çš„ç±»å‹æ˜¯å¦å®ç° <a href="../marker/trait.Copy.html" title="trait core::marker::Copy"><code>Copy</code></a> traitã€‚
å½“ä½¿ç”¨æ•°æ®çš„å¤šä¸ªå‰¯æœ¬æ—¶ (é€šè¿‡å¤šæ¬¡è°ƒç”¨ <code>assume_init_read</code>ï¼Œæˆ–å…ˆè°ƒç”¨ <code>assume_init_read</code> å†è°ƒç”¨ <a href="union.MaybeUninit.html#method.assume_init" title="method core::mem::MaybeUninit::assume_init"><code>assume_init</code></a>)ï¼Œæ‚¨æœ‰è´£ä»»ç¡®ä¿æ•°æ®ç¡®å®å¯èƒ½é‡å¤ã€‚</p>
<h5 id="examples-6"><a href="#examples-6">Examples</a></h5>
<p>æ­£ç¡®ä½¿ç”¨æ­¤æ–¹æ³•ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>x = MaybeUninit::&lt;u32&gt;::uninit();
x.write(<span class="number">13</span>);
<span class="kw">let </span>x1 = <span class="kw">unsafe </span>{ x.assume_init_read() };
<span class="comment">// `u32` æ˜¯ `Copy`ï¼Œå› æ­¤æˆ‘ä»¬å¯èƒ½ä¼šè¯»å–å¤šæ¬¡ã€‚
</span><span class="kw">let </span>x2 = <span class="kw">unsafe </span>{ x.assume_init_read() };
<span class="macro">assert_eq!</span>(x1, x2);

<span class="kw">let </span><span class="kw-2">mut </span>x = MaybeUninit::&lt;<span class="prelude-ty">Option</span>&lt;Vec&lt;u32&gt;&gt;&gt;::uninit();
x.write(<span class="prelude-val">None</span>);
<span class="kw">let </span>x1 = <span class="kw">unsafe </span>{ x.assume_init_read() };
<span class="comment">// å¤åˆ¶ `None` å€¼æ˜¯å¯ä»¥çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯èƒ½ä¼šå¤šæ¬¡è¯»å–ã€‚
</span><span class="kw">let </span>x2 = <span class="kw">unsafe </span>{ x.assume_init_read() };
<span class="macro">assert_eq!</span>(x1, x2);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+x+=+MaybeUninit::%3Cu32%3E::uninit();%0Ax.write(13);%0Alet+x1+=+unsafe+%7B+x.assume_init_read()+%7D;%0A//+%60u32%60+%E6%98%AF+%60Copy%60%EF%BC%8C%E5%9B%A0%E6%AD%A4%E6%88%91%E4%BB%AC%E5%8F%AF%E8%83%BD%E4%BC%9A%E8%AF%BB%E5%8F%96%E5%A4%9A%E6%AC%A1%E3%80%82%0Alet+x2+=+unsafe+%7B+x.assume_init_read()+%7D;%0Aassert_eq!(x1,+x2);%0A%0Alet+mut+x+=+MaybeUninit::%3COption%3CVec%3Cu32%3E%3E%3E::uninit();%0Ax.write(None);%0Alet+x1+=+unsafe+%7B+x.assume_init_read()+%7D;%0A//+%E5%A4%8D%E5%88%B6+%60None%60+%E5%80%BC%E6%98%AF%E5%8F%AF%E4%BB%A5%E7%9A%84%EF%BC%8C%E5%9B%A0%E6%AD%A4%E6%88%91%E4%BB%AC%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%A4%9A%E6%AC%A1%E8%AF%BB%E5%8F%96%E3%80%82%0Alet+x2+=+unsafe+%7B+x.assume_init_read()+%7D;%0Aassert_eq!(x1,+x2);%0A%7D&amp;edition=2021">Run</a></div>
<p>è¿™ä¸ªæ–¹æ³•çš„é”™è¯¯ç”¨æ³•ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>x = MaybeUninit::&lt;<span class="prelude-ty">Option</span>&lt;Vec&lt;u32&gt;&gt;&gt;::uninit();
x.write(<span class="prelude-val">Some</span>(<span class="macro">vec!</span>[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]));
<span class="kw">let </span>x1 = <span class="kw">unsafe </span>{ x.assume_init_read() };
<span class="kw">let </span>x2 = <span class="kw">unsafe </span>{ x.assume_init_read() };
<span class="comment">// ç°åœ¨ï¼Œæˆ‘ä»¬åˆ›å»ºäº†åŒä¸€ vector çš„ä¸¤ä¸ªå‰¯æœ¬ï¼Œå½“å®ƒä»¬éƒ½è¢«ä¸¢å¼ƒæ—¶ï¼Œå°†å¯¼è‡´åŒé‡é‡Šæ”¾ï¼</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+x+=+MaybeUninit::%3COption%3CVec%3Cu32%3E%3E%3E::uninit();%0Ax.write(Some(vec!%5B0,+1,+2%5D));%0Alet+x1+=+unsafe+%7B+x.assume_init_read()+%7D;%0Alet+x2+=+unsafe+%7B+x.assume_init_read()+%7D;%0A//+%E7%8E%B0%E5%9C%A8%EF%BC%8C%E6%88%91%E4%BB%AC%E5%88%9B%E5%BB%BA%E4%BA%86%E5%90%8C%E4%B8%80+vector+%E7%9A%84%E4%B8%A4%E4%B8%AA%E5%89%AF%E6%9C%AC%EF%BC%8C%E5%BD%93%E5%AE%83%E4%BB%AC%E9%83%BD%E8%A2%AB%E4%B8%A2%E5%BC%83%E6%97%B6%EF%BC%8C%E5%B0%86%E5%AF%BC%E8%87%B4%E5%8F%8C%E9%87%8D%E9%87%8A%E6%94%BE%EF%BC%81%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.assume_init_drop" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.60.0">1.60.0</span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#724-729">source</a></span><h4 class="code-header">pub unsafe fn <a href="#method.assume_init_drop" class="fn">assume_init_drop</a>(&amp;mut self)</h4></section></summary><div class="docblock"><p>å°†åŒ…å«çš„å€¼æ”¾ç½®åˆ°ä½ã€‚</p>
<p>å¦‚æœæ‚¨æ‹¥æœ‰ <code>MaybeUninit</code>ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ <a href="union.MaybeUninit.html#method.assume_init" title="method core::mem::MaybeUninit::assume_init"><code>assume_init</code></a> ä½œä¸ºæ›¿ä»£ã€‚</p>
<h5 id="safety-2"><a href="#safety-2">Safety</a></h5>
<p>å–å†³äºè°ƒç”¨è€…ï¼Œä»¥ç¡®ä¿ <code>MaybeUninit&lt;T&gt;</code> ç¡®å®å¤„äºåˆå§‹åŒ–çŠ¶æ€ã€‚
åœ¨å†…å®¹å°šæœªå®Œå…¨åˆå§‹åŒ–æ—¶è°ƒç”¨æ­¤æ–¹æ³•ä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚</p>
<p>æœ€é‡è¦çš„æ˜¯ï¼Œå¿…é¡»æ»¡è¶³ç±»å‹ <code>T</code> çš„æ‰€æœ‰é™„åŠ ä¸å˜é‡ï¼Œå› ä¸º <code>T</code> (æˆ–å…¶å˜ä½“) çš„ <code>Drop</code> å®ç°å¯èƒ½ä¾èµ–äºæ­¤ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå°† <a href="../../std/vec/struct.Vec.html"><code>Vec&lt;T&gt;</code></a> è®¾ç½®ä¸ºæ— æ•ˆä½†éç©ºçš„åœ°å€ä½¿å…¶åˆå§‹åŒ– (åœ¨å½“å‰å®ç°ä¸‹ï¼›
è¿™å¹¶ä¸æ„æˆç¨³å®šçš„ä¿è¯)ï¼Œå› ä¸ºç¼–è¯‘å™¨çŸ¥é“çš„å”¯ä¸€è¦æ±‚æ˜¯æ•°æ®æŒ‡é’ˆå¿…é¡»éç©ºã€‚
ä½†æ˜¯ï¼Œä¸¢å¼ƒè¿™æ ·çš„ <code>Vec&lt;T&gt;</code> ä¼šå¯¼è‡´ä¸ç¡®å®šçš„è¡Œä¸ºã€‚</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.assume_init_ref" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.55.0, const since 1.59.0">1.55.0 (const: 1.59.0)</span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#786-793">source</a></span><h4 class="code-header">pub const unsafe fn <a href="#method.assume_init_ref" class="fn">assume_init_ref</a>(&amp;self) -&gt; <a class="primitive" href="../primitive.reference.html">&amp;T</a></h4></section></summary><div class="docblock"><p>è·å–å¯¹åŒ…å«çš„å€¼çš„å…±äº«å¼•ç”¨ã€‚</p>
<p>å½“æˆ‘ä»¬è¦è®¿é—®å·²åˆå§‹åŒ–ä½†æ²¡æœ‰ <code>MaybeUninit</code> æ‰€æœ‰æƒ (é˜²æ­¢ä½¿ç”¨ <code>.assume_init()</code>) çš„ <code>MaybeUninit</code> æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚</p>
<h5 id="safety-3"><a href="#safety-3">Safety</a></h5>
<p>åœ¨å†…å®¹å°šæœªå®Œå…¨åˆå§‹åŒ–æ—¶è°ƒç”¨æ­¤æ–¹æ³•ä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºï¼šå–å†³äºè°ƒç”¨è€…ï¼Œä»¥ç¡®ä¿ <code>MaybeUninit&lt;T&gt;</code> ç¡®å®å¤„äºåˆå§‹åŒ–çŠ¶æ€ã€‚</p>
<h5 id="examples-7"><a href="#examples-7">Examples</a></h5><h6 id="æ­£ç¡®ä½¿ç”¨æ­¤æ–¹æ³•"><a href="#æ­£ç¡®ä½¿ç”¨æ­¤æ–¹æ³•">æ­£ç¡®ä½¿ç”¨æ­¤æ–¹æ³•ï¼š</a></h6>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>x = MaybeUninit::&lt;Vec&lt;u32&gt;&gt;::uninit();
<span class="comment">// åˆå§‹åŒ– `x`ï¼š
</span>x.write(<span class="macro">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);
<span class="comment">// ç°åœ¨å·²çŸ¥æˆ‘ä»¬çš„ `MaybeUninit&lt;_&gt;` å·²åˆå§‹åŒ–ï¼Œå¯ä»¥åˆ›å»ºå¯¹å…¶çš„å…±äº«å¼•ç”¨ï¼š
</span><span class="kw">let </span>x: <span class="kw-2">&amp;</span>Vec&lt;u32&gt; = <span class="kw">unsafe </span>{
    <span class="comment">// SAFETY: `x` å·²åˆå§‹åŒ–ã€‚
    </span>x.assume_init_ref()
};
<span class="macro">assert_eq!</span>(x, <span class="kw-2">&amp;</span><span class="macro">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+x+=+MaybeUninit::%3CVec%3Cu32%3E%3E::uninit();%0A//+%E5%88%9D%E5%A7%8B%E5%8C%96+%60x%60%EF%BC%9A%0Ax.write(vec!%5B1,+2,+3%5D);%0A//+%E7%8E%B0%E5%9C%A8%E5%B7%B2%E7%9F%A5%E6%88%91%E4%BB%AC%E7%9A%84+%60MaybeUninit%3C_%3E%60+%E5%B7%B2%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%88%9B%E5%BB%BA%E5%AF%B9%E5%85%B6%E7%9A%84%E5%85%B1%E4%BA%AB%E5%BC%95%E7%94%A8%EF%BC%9A%0Alet+x:+%26Vec%3Cu32%3E+=+unsafe+%7B%0A++++//+SAFETY:+%60x%60+%E5%B7%B2%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%82%0A++++x.assume_init_ref()%0A%7D;%0Aassert_eq!(x,+%26vec!%5B1,+2,+3%5D);%0A%7D&amp;edition=2021">Run</a></div>
<h6 id="è¿™ä¸ªæ–¹æ³•çš„é”™è¯¯ç”¨æ³•"><a href="#è¿™ä¸ªæ–¹æ³•çš„é”™è¯¯ç”¨æ³•">è¿™ä¸ªæ–¹æ³•çš„é”™è¯¯ç”¨æ³•ï¼š</a></h6>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span>x = MaybeUninit::&lt;Vec&lt;u32&gt;&gt;::uninit();
<span class="kw">let </span>x_vec: <span class="kw-2">&amp;</span>Vec&lt;u32&gt; = <span class="kw">unsafe </span>{ x.assume_init_ref() };
<span class="comment">// æˆ‘ä»¬åˆ›å»ºäº†å¯¹æœªåˆå§‹åŒ–çš„ vector çš„å¼•ç”¨ï¼ è¿™æ˜¯æœªå®šä¹‰çš„è¡Œä¸ºã€‚âš ï¸</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+x+=+MaybeUninit::%3CVec%3Cu32%3E%3E::uninit();%0Alet+x_vec:+%26Vec%3Cu32%3E+=+unsafe+%7B+x.assume_init_ref()+%7D;%0A//+%E6%88%91%E4%BB%AC%E5%88%9B%E5%BB%BA%E4%BA%86%E5%AF%B9%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84+vector+%E7%9A%84%E5%BC%95%E7%94%A8%EF%BC%81+%E8%BF%99%E6%98%AF%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%E3%80%82%E2%9A%A0%EF%B8%8F%0A%7D&amp;edition=2021">Run</a></div>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::{cell::Cell, mem::MaybeUninit};

<span class="kw">let </span>b = MaybeUninit::&lt;Cell&lt;bool&gt;&gt;::uninit();
<span class="comment">// ä½¿ç”¨ `Cell::set` åˆå§‹åŒ– `MaybeUninit`ï¼š
</span><span class="kw">unsafe </span>{
    b.assume_init_ref().set(<span class="bool-val">true</span>);
   <span class="comment">// ^^^^^^^^^^^^^^^
   // å¼•ç”¨æœªåˆå§‹åŒ–çš„ `Cell&lt;bool&gt;`: UB!
</span>}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::%7Bcell::Cell,+mem::MaybeUninit%7D;%0A%0Alet+b+=+MaybeUninit::%3CCell%3Cbool%3E%3E::uninit();%0A//+%E4%BD%BF%E7%94%A8+%60Cell::set%60+%E5%88%9D%E5%A7%8B%E5%8C%96+%60MaybeUninit%60%EF%BC%9A%0Aunsafe+%7B%0A++++b.assume_init_ref().set(true);%0A+++//+%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%0A+++//+%E5%BC%95%E7%94%A8%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84+%60Cell%3Cbool%3E%60:+UB!%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.assume_init_mut" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.55.0, const unstable">1.55.0 (const: unstable)</span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#903-910">source</a></span><h4 class="code-header">pub unsafe fn <a href="#method.assume_init_mut" class="fn">assume_init_mut</a>(&amp;mut self) -&gt; <a class="primitive" href="../primitive.reference.html">&amp;mut T</a></h4></section></summary><div class="docblock"><p>è·å–æ‰€åŒ…å«å€¼çš„å¯å˜ (unique) å¼•ç”¨ã€‚</p>
<p>å½“æˆ‘ä»¬è¦è®¿é—®å·²åˆå§‹åŒ–ä½†æ²¡æœ‰ <code>MaybeUninit</code> æ‰€æœ‰æƒ (é˜²æ­¢ä½¿ç”¨ <code>.assume_init()</code>) çš„ <code>MaybeUninit</code> æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚</p>
<h5 id="safety-4"><a href="#safety-4">Safety</a></h5>
<p>åœ¨å†…å®¹å°šæœªå®Œå…¨åˆå§‹åŒ–æ—¶è°ƒç”¨æ­¤æ–¹æ³•ä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºï¼šå–å†³äºè°ƒç”¨è€…ï¼Œä»¥ç¡®ä¿ <code>MaybeUninit&lt;T&gt;</code> ç¡®å®å¤„äºåˆå§‹åŒ–çŠ¶æ€ã€‚
ä¾‹å¦‚ï¼Œ<code>.assume_init_mut()</code> ä¸èƒ½ç”¨äºåˆå§‹åŒ– <code>MaybeUninit</code>ã€‚</p>
<h5 id="examples-8"><a href="#examples-8">Examples</a></h5><h6 id="æ­£ç¡®ä½¿ç”¨æ­¤æ–¹æ³•-1"><a href="#æ­£ç¡®ä½¿ç”¨æ­¤æ–¹æ³•-1">æ­£ç¡®ä½¿ç”¨æ­¤æ–¹æ³•ï¼š</a></h6>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">extern </span><span class="string">&quot;C&quot; </span>{
    <span class="doccomment">/// åˆå§‹åŒ–æ‰€æœ‰è¾“å…¥ç¼“å†²åŒºçš„å­—èŠ‚ã€‚
    </span><span class="kw">fn </span>initialize_buffer(buf: <span class="kw-2">*mut </span>[u8; <span class="number">1024</span>]);
}

<span class="kw">let </span><span class="kw-2">mut </span>buf = MaybeUninit::&lt;[u8; <span class="number">1024</span>]&gt;::uninit();

<span class="comment">// åˆå§‹åŒ– `buf`ï¼š
</span><span class="kw">unsafe </span>{ initialize_buffer(buf.as_mut_ptr()); }
<span class="comment">// ç°åœ¨æˆ‘ä»¬çŸ¥é“ `buf` å·²è¢«åˆå§‹åŒ–ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œ `.assume_init()`ã€‚
// ä½†æ˜¯ï¼Œä½¿ç”¨ `.assume_init()` å¯èƒ½ä¼šè§¦å‘ 1024 å­—èŠ‚çš„ `memcpy`ã€‚
// ä¸ºäº†æ–­è¨€æˆ‘ä»¬çš„ç¼“å†²åŒºå·²ç»åˆå§‹åŒ–è€Œä¸å¤åˆ¶å®ƒï¼Œæˆ‘ä»¬å°† `&amp;mut MaybeUninit&lt;[u8; 1024]&gt;` å‡çº§ä¸º `&amp;mut [u8; 1024]`ï¼š
</span><span class="kw">let </span>buf: <span class="kw-2">&amp;mut </span>[u8; <span class="number">1024</span>] = <span class="kw">unsafe </span>{
    <span class="comment">// SAFETY: `buf` å·²åˆå§‹åŒ–ã€‚
    </span>buf.assume_init_mut()
};

<span class="comment">// ç°åœ¨æˆ‘ä»¬å¯ä»¥å°† `buf` ç”¨ä½œæ™®é€šåˆ‡ç‰‡ï¼š
</span>buf.sort_unstable();
<span class="macro">assert!</span>(
    buf.windows(<span class="number">2</span>).all(|pair| pair[<span class="number">0</span>] &lt;= pair[<span class="number">1</span>]),
    <span class="string">&quot;buffer is sorted&quot;</span>,
);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Ballow(unexpected_cfgs)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Aunsafe+extern+%22C%22+fn+initialize_buffer(buf:+*mut+%5Bu8;+1024%5D)+%7B+*buf+=+%5B0;+1024%5D+%7D%0A%23%5Bcfg(FALSE)%5D%0Aextern+%22C%22+%7B%0A++++///+%E5%88%9D%E5%A7%8B%E5%8C%96%E6%89%80%E6%9C%89%E8%BE%93%E5%85%A5%E7%BC%93%E5%86%B2%E5%8C%BA%E7%9A%84%E5%AD%97%E8%8A%82%E3%80%82%0A++++fn+initialize_buffer(buf:+*mut+%5Bu8;+1024%5D);%0A%7D%0A%0Alet+mut+buf+=+MaybeUninit::%3C%5Bu8;+1024%5D%3E::uninit();%0A%0A//+%E5%88%9D%E5%A7%8B%E5%8C%96+%60buf%60%EF%BC%9A%0Aunsafe+%7B+initialize_buffer(buf.as_mut_ptr());+%7D%0A//+%E7%8E%B0%E5%9C%A8%E6%88%91%E4%BB%AC%E7%9F%A5%E9%81%93+%60buf%60+%E5%B7%B2%E8%A2%AB%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%8C%E5%9B%A0%E6%AD%A4%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E5%AF%B9%E5%85%B6%E8%BF%9B%E8%A1%8C+%60.assume_init()%60%E3%80%82%0A//+%E4%BD%86%E6%98%AF%EF%BC%8C%E4%BD%BF%E7%94%A8+%60.assume_init()%60+%E5%8F%AF%E8%83%BD%E4%BC%9A%E8%A7%A6%E5%8F%91+1024+%E5%AD%97%E8%8A%82%E7%9A%84+%60memcpy%60%E3%80%82%0A//+%E4%B8%BA%E4%BA%86%E6%96%AD%E8%A8%80%E6%88%91%E4%BB%AC%E7%9A%84%E7%BC%93%E5%86%B2%E5%8C%BA%E5%B7%B2%E7%BB%8F%E5%88%9D%E5%A7%8B%E5%8C%96%E8%80%8C%E4%B8%8D%E5%A4%8D%E5%88%B6%E5%AE%83%EF%BC%8C%E6%88%91%E4%BB%AC%E5%B0%86+%60%26mut+MaybeUninit%3C%5Bu8;+1024%5D%3E%60+%E5%8D%87%E7%BA%A7%E4%B8%BA+%60%26mut+%5Bu8;+1024%5D%60%EF%BC%9A%0Alet+buf:+%26mut+%5Bu8;+1024%5D+=+unsafe+%7B%0A++++//+SAFETY:+%60buf%60+%E5%B7%B2%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%82%0A++++buf.assume_init_mut()%0A%7D;%0A%0A//+%E7%8E%B0%E5%9C%A8%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E5%B0%86+%60buf%60+%E7%94%A8%E4%BD%9C%E6%99%AE%E9%80%9A%E5%88%87%E7%89%87%EF%BC%9A%0Abuf.sort_unstable();%0Aassert!(%0A++++buf.windows(2).all(%7Cpair%7C+pair%5B0%5D+%3C=+pair%5B1%5D),%0A++++%22buffer+is+sorted%22,%0A);%0A%7D&amp;edition=2021">Run</a></div>
<h6 id="è¿™ä¸ªæ–¹æ³•çš„é”™è¯¯ç”¨æ³•-1"><a href="#è¿™ä¸ªæ–¹æ³•çš„é”™è¯¯ç”¨æ³•-1">è¿™ä¸ªæ–¹æ³•çš„é”™è¯¯ç”¨æ³•ï¼š</a></h6>
<p>æ‚¨ä¸èƒ½ä½¿ç”¨ <code>.assume_init_mut()</code> åˆå§‹åŒ–å€¼ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>b = MaybeUninit::&lt;bool&gt;::uninit();
<span class="kw">unsafe </span>{
    <span class="kw-2">*</span>b.assume_init_mut() = <span class="bool-val">true</span>;
    <span class="comment">// æˆ‘ä»¬å·²ç»åˆ›å»ºäº† (mutable) å¼•ç”¨æœªåˆå§‹åŒ–çš„ `bool`!
    // è¿™æ˜¯æœªå®šä¹‰çš„è¡Œä¸ºã€‚âš ï¸
</span>}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+b+=+MaybeUninit::%3Cbool%3E::uninit();%0Aunsafe+%7B%0A++++*b.assume_init_mut()+=+true;%0A++++//+%E6%88%91%E4%BB%AC%E5%B7%B2%E7%BB%8F%E5%88%9B%E5%BB%BA%E4%BA%86+(mutable)+%E5%BC%95%E7%94%A8%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84+%60bool%60!%0A++++//+%E8%BF%99%E6%98%AF%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%E3%80%82%E2%9A%A0%EF%B8%8F%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
<p>ä¾‹å¦‚ï¼Œæ‚¨ä¸èƒ½ <a href="../../std/io/trait.Read.html"><code>Read</code></a> è¿›å…¥æœªåˆå§‹åŒ–çš„ç¼“å†²åŒºï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::{io, mem::MaybeUninit};

<span class="kw">fn </span>read_chunk (reader: <span class="kw-2">&amp;</span><span class="lifetime">&#39;_ </span><span class="kw-2">mut </span><span class="kw">dyn </span>io::Read) -&gt; io::Result&lt;[u8; <span class="number">64</span>]&gt;
{
    <span class="kw">let </span><span class="kw-2">mut </span>buffer = MaybeUninit::&lt;[u8; <span class="number">64</span>]&gt;::uninit();
    reader.read_exact(<span class="kw">unsafe </span>{ buffer.assume_init_mut() })<span class="question-mark">?</span>;
                            <span class="comment">// ^^^^^^^^^^^^^^^^^^^^^^^^
                            // (mutable) å¼•ç”¨åˆ°æœªåˆå§‹åŒ–çš„å†…å­˜ï¼
                            // è¿™æ˜¯æœªå®šä¹‰çš„è¡Œä¸ºã€‚
    </span><span class="prelude-val">Ok</span>(<span class="kw">unsafe </span>{ buffer.assume_init() })
}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::%7Bio,+mem::MaybeUninit%7D;%0A%0Afn+read_chunk+(reader:+%26'_+mut+dyn+io::Read)+-%3E+io::Result%3C%5Bu8;+64%5D%3E%0A%7B%0A++++let+mut+buffer+=+MaybeUninit::%3C%5Bu8;+64%5D%3E::uninit();%0A++++reader.read_exact(unsafe+%7B+buffer.assume_init_mut()+%7D)?;%0A++++++++++++++++++++++++++++//+%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%0A++++++++++++++++++++++++++++//+(mutable)+%E5%BC%95%E7%94%A8%E5%88%B0%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E5%86%85%E5%AD%98%EF%BC%81%0A++++++++++++++++++++++++++++//+%E8%BF%99%E6%98%AF%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%E3%80%82%0A++++Ok(unsafe+%7B+buffer.assume_init()+%7D)%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
<p>ä¹Ÿä¸èƒ½ä½¿ç”¨ç›´æ¥å­—æ®µè®¿é—®æ¥è¿›è¡Œé€å­—æ®µé€æ­¥åˆå§‹åŒ–ï¼š</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::{mem::MaybeUninit, ptr};

<span class="kw">struct </span>Foo {
    a: u32,
    b: u8,
}

<span class="kw">let </span>foo: Foo = <span class="kw">unsafe </span>{
    <span class="kw">let </span><span class="kw-2">mut </span>foo = MaybeUninit::&lt;Foo&gt;::uninit();
    ptr::write(<span class="kw-2">&amp;mut </span>foo.assume_init_mut().a <span class="kw">as </span><span class="kw-2">*mut </span>u32, <span class="number">1337</span>);
                 <span class="comment">// ^^^^^^^^^^^^^^^^^^^^^
                 // (mutable) å¼•ç”¨åˆ°æœªåˆå§‹åŒ–çš„å†…å­˜ï¼
                 // è¿™æ˜¯æœªå®šä¹‰çš„è¡Œä¸ºã€‚
    </span>ptr::write(<span class="kw-2">&amp;mut </span>foo.assume_init_mut().b <span class="kw">as </span><span class="kw-2">*mut </span>u8, <span class="number">42</span>);
                 <span class="comment">// ^^^^^^^^^^^^^^^^^^^^^
                 // (mutable) å¼•ç”¨åˆ°æœªåˆå§‹åŒ–çš„å†…å­˜ï¼
                 // è¿™æ˜¯æœªå®šä¹‰çš„è¡Œä¸ºã€‚
    </span>foo.assume_init()
};</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::%7Bmem::MaybeUninit,+ptr%7D;%0A%0Astruct+Foo+%7B%0A++++a:+u32,%0A++++b:+u8,%0A%7D%0A%0Alet+foo:+Foo+=+unsafe+%7B%0A++++let+mut+foo+=+MaybeUninit::%3CFoo%3E::uninit();%0A++++ptr::write(%26mut+foo.assume_init_mut().a+as+*mut+u32,+1337);%0A+++++++++++++++++//+%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%0A+++++++++++++++++//+(mutable)+%E5%BC%95%E7%94%A8%E5%88%B0%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E5%86%85%E5%AD%98%EF%BC%81%0A+++++++++++++++++//+%E8%BF%99%E6%98%AF%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%E3%80%82%0A++++ptr::write(%26mut+foo.assume_init_mut().b+as+*mut+u8,+42);%0A+++++++++++++++++//+%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%5E%0A+++++++++++++++++//+(mutable)+%E5%BC%95%E7%94%A8%E5%88%B0%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E5%86%85%E5%AD%98%EF%BC%81%0A+++++++++++++++++//+%E8%BF%99%E6%98%AF%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%E3%80%82%0A++++foo.assume_init()%0A%7D;%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.array_assume_init" class="method"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/96097" title="Tracking issue for const_maybe_uninit_array_assume_init">unstable</a></span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#942-952">source</a></span><h4 class="code-header">pub unsafe fn <a href="#method.array_assume_init" class="fn">array_assume_init</a>&lt;const N: <a class="primitive" href="../primitive.usize.html">usize</a>&gt;(array: <a class="primitive" href="../primitive.array.html">[Self; N]</a>) -&gt; <a class="primitive" href="../primitive.array.html">[T; N]</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_array_assume_init</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/96097">#96097</a>)</span></div></span></summary><div class="docblock"><p>ä» <code>MaybeUninit</code> å®¹å™¨æ•°ç»„ä¸­æå–å€¼ã€‚</p>
<h5 id="safety-5"><a href="#safety-5">Safety</a></h5>
<p>è°ƒç”¨è€…æœ‰è´£ä»»ä¿è¯æ•°ç»„çš„æ‰€æœ‰å…ƒç´ éƒ½å¤„äºåˆå§‹åŒ–çŠ¶æ€ã€‚</p>
<h5 id="examples-9"><a href="#examples-9">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(maybe_uninit_uninit_array)]
#![feature(maybe_uninit_array_assume_init)]
</span><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>array: [MaybeUninit&lt;i32&gt;; <span class="number">3</span>] = MaybeUninit::uninit_array();
array[<span class="number">0</span>].write(<span class="number">0</span>);
array[<span class="number">1</span>].write(<span class="number">1</span>);
array[<span class="number">2</span>].write(<span class="number">2</span>);

<span class="comment">// SAFETY: ç°åœ¨å®‰å…¨äº†ï¼Œå› ä¸ºæˆ‘ä»¬åˆå§‹åŒ–äº†æ‰€æœ‰å…ƒç´ 
</span><span class="kw">let </span>array = <span class="kw">unsafe </span>{
    MaybeUninit::array_assume_init(array)
};

<span class="macro">assert_eq!</span>(array, [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(maybe_uninit_uninit_array)%5D%0A%23!%5Bfeature(maybe_uninit_array_assume_init)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+array:+%5BMaybeUninit%3Ci32%3E;+3%5D+=+MaybeUninit::uninit_array();%0Aarray%5B0%5D.write(0);%0Aarray%5B1%5D.write(1);%0Aarray%5B2%5D.write(2);%0A%0A//+SAFETY:+%E7%8E%B0%E5%9C%A8%E5%AE%89%E5%85%A8%E4%BA%86%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%88%91%E4%BB%AC%E5%88%9D%E5%A7%8B%E5%8C%96%E4%BA%86%E6%89%80%E6%9C%89%E5%85%83%E7%B4%A0%0Alet+array+=+unsafe+%7B%0A++++MaybeUninit::array_assume_init(array)%0A%7D;%0A%0Aassert_eq!(array,+%5B0,+1,+2%5D);%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.slice_assume_init_ref" class="method"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/63569" title="Tracking issue for maybe_uninit_slice">unstable</a></span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#968-974">source</a></span><h4 class="code-header">pub unsafe fn <a href="#method.slice_assume_init_ref" class="fn">slice_assume_init_ref</a>(slice: &amp;<a class="primitive" href="../primitive.slice.html">[Self]</a>) -&gt; &amp;<a class="primitive" href="../primitive.slice.html">[T]</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_slice</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/63569">#63569</a>)</span></div></span></summary><div class="docblock"><p>å‡è®¾æ‰€æœ‰å…ƒç´ éƒ½å·²åˆå§‹åŒ–ï¼Œè¯·å¯¹å…¶è¿›è¡Œåˆ‡ç‰‡ã€‚</p>
<h5 id="safety-6"><a href="#safety-6">Safety</a></h5>
<p>å–å†³äºè°ƒç”¨è€…ï¼Œä»¥ç¡®ä¿ <code>MaybeUninit&lt;T&gt;</code> å…ƒç´ ç¡®å®å¤„äºåˆå§‹åŒ–çŠ¶æ€ã€‚</p>
<p>åœ¨å†…å®¹å°šæœªå®Œå…¨åˆå§‹åŒ–æ—¶è°ƒç”¨æ­¤æ–¹æ³•ä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚</p>
<p>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯å’Œç¤ºä¾‹ï¼Œè¯·å‚è§ <a href="union.MaybeUninit.html#method.assume_init_ref" title="method core::mem::MaybeUninit::assume_init_ref"><code>assume_init_ref</code></a>ã€‚</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.slice_assume_init_mut" class="method"><span class="rightside"><span class="since" title="const unstable">const: unstable</span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#990-994">source</a></span><h4 class="code-header">pub unsafe fn <a href="#method.slice_assume_init_mut" class="fn">slice_assume_init_mut</a>(slice: &amp;mut <a class="primitive" href="../primitive.slice.html">[Self]</a>) -&gt; &amp;mut <a class="primitive" href="../primitive.slice.html">[T]</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_slice</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/63569">#63569</a>)</span></div></span></summary><div class="docblock"><p>å‡è®¾æ‰€æœ‰å…ƒç´ éƒ½å·²åˆå§‹åŒ–ï¼Œè¯·ä¸ºå…¶è·å–å¯å˜åˆ‡ç‰‡ã€‚</p>
<h5 id="safety-7"><a href="#safety-7">Safety</a></h5>
<p>å–å†³äºè°ƒç”¨è€…ï¼Œä»¥ç¡®ä¿ <code>MaybeUninit&lt;T&gt;</code> å…ƒç´ ç¡®å®å¤„äºåˆå§‹åŒ–çŠ¶æ€ã€‚</p>
<p>åœ¨å†…å®¹å°šæœªå®Œå…¨åˆå§‹åŒ–æ—¶è°ƒç”¨æ­¤æ–¹æ³•ä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚</p>
<p>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯å’Œç¤ºä¾‹ï¼Œè¯·å‚è§ <a href="union.MaybeUninit.html#method.assume_init_mut" title="method core::mem::MaybeUninit::assume_init_mut"><code>assume_init_mut</code></a>ã€‚</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.slice_as_ptr" class="method"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/63569" title="Tracking issue for maybe_uninit_slice">unstable</a></span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#1000-1002">source</a></span><h4 class="code-header">pub fn <a href="#method.slice_as_ptr" class="fn">slice_as_ptr</a>(this: &amp;[<a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;]) -&gt; <a class="primitive" href="../primitive.pointer.html">*const T</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_slice</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/63569">#63569</a>)</span></div></span></summary><div class="docblock"><p>è·å–æŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.slice_as_mut_ptr" class="method"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/63569" title="Tracking issue for maybe_uninit_slice">unstable</a></span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#1008-1010">source</a></span><h4 class="code-header">pub fn <a href="#method.slice_as_mut_ptr" class="fn">slice_as_mut_ptr</a>(this: &amp;mut [<a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;]) -&gt; <a class="primitive" href="../primitive.pointer.html">*mut T</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_slice</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/63569">#63569</a>)</span></div></span></summary><div class="docblock"><p>è·å–æŒ‡å‘æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¯å˜æŒ‡é’ˆã€‚</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.write_slice" class="method"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#1056-1067">source</a><h4 class="code-header">pub fn <a href="#method.write_slice" class="fn">write_slice</a>&lt;'a&gt;(this: &amp;'a mut [<a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;], src: &amp;<a class="primitive" href="../primitive.slice.html">[T]</a>) -&gt; &amp;'a mut <a class="primitive" href="../primitive.slice.html">[T]</a><span class="where fmt-newline">where
    T: <a class="trait" href="../marker/trait.Copy.html" title="trait core::marker::Copy">Copy</a>,</span></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_write_slice</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/79995">#79995</a>)</span></div></span></summary><div class="docblock"><p>ä» <code>src</code> å¤åˆ¶å…ƒç´ ï¼Œå°† <code>this</code> ç°åœ¨åˆå§‹åŒ–çš„å†…å®¹è¿”å›ç»™ <code>this</code> çš„èµ„æºå¼•ç”¨ã€‚</p>
<p>å¦‚æœ <code>T</code> æœªå®ç° <code>Copy</code>ï¼Œè¯·ä½¿ç”¨ <a href="union.MaybeUninit.html#method.write_slice_cloned" title="associated function core::mem::MaybeUninit::write_slice_cloned"><code>write_slice_cloned</code></a></p>
<p>è¿™ç±»ä¼¼äº <a href="../primitive.slice.html#method.copy_from_slice" title="method slice::copy_from_slice"><code>slice::copy_from_slice</code></a>ã€‚</p>
<h5 id="panics"><a href="#panics">Panics</a></h5>
<p>å¦‚æœä¸¤ä¸ªåˆ‡ç‰‡çš„é•¿åº¦ä¸åŒï¼Œåˆ™æ­¤å‡½æ•°å°†ä¸º panicã€‚</p>
<h5 id="examples-10"><a href="#examples-10">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(maybe_uninit_write_slice)]
</span><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>dst = [MaybeUninit::uninit(); <span class="number">32</span>];
<span class="kw">let </span>src = [<span class="number">0</span>; <span class="number">32</span>];

<span class="kw">let </span>init = MaybeUninit::write_slice(<span class="kw-2">&amp;mut </span>dst, <span class="kw-2">&amp;</span>src);

<span class="macro">assert_eq!</span>(init, src);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(maybe_uninit_write_slice)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+dst+=+%5BMaybeUninit::uninit();+32%5D;%0Alet+src+=+%5B0;+32%5D;%0A%0Alet+init+=+MaybeUninit::write_slice(%26mut+dst,+%26src);%0A%0Aassert_eq!(init,+src);%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(maybe_uninit_write_slice)]
</span><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>vec = Vec::with_capacity(<span class="number">32</span>);
<span class="kw">let </span>src = [<span class="number">0</span>; <span class="number">16</span>];

MaybeUninit::write_slice(<span class="kw-2">&amp;mut </span>vec.spare_capacity_mut()[..src.len()], <span class="kw-2">&amp;</span>src);

<span class="comment">// SAFETY: æˆ‘ä»¬åˆšåˆšå°† len çš„æ‰€æœ‰å…ƒç´ å¤åˆ¶åˆ°äº†å¤‡ç”¨å®¹é‡ä¸­ï¼Œvec çš„ç¬¬ä¸€ä¸ª src.len() å…ƒç´ ç°åœ¨æœ‰æ•ˆã€‚
</span><span class="kw">unsafe </span>{
    vec.set_len(src.len());
}

<span class="macro">assert_eq!</span>(vec, src);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(maybe_uninit_write_slice)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+vec+=+Vec::with_capacity(32);%0Alet+src+=+%5B0;+16%5D;%0A%0AMaybeUninit::write_slice(%26mut+vec.spare_capacity_mut()%5B..src.len()%5D,+%26src);%0A%0A//+SAFETY:+%E6%88%91%E4%BB%AC%E5%88%9A%E5%88%9A%E5%B0%86+len+%E7%9A%84%E6%89%80%E6%9C%89%E5%85%83%E7%B4%A0%E5%A4%8D%E5%88%B6%E5%88%B0%E4%BA%86%E5%A4%87%E7%94%A8%E5%AE%B9%E9%87%8F%E4%B8%AD%EF%BC%8Cvec+%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA+src.len()+%E5%85%83%E7%B4%A0%E7%8E%B0%E5%9C%A8%E6%9C%89%E6%95%88%E3%80%82%0Aunsafe+%7B%0A++++vec.set_len(src.len());%0A%7D%0A%0Aassert_eq!(vec,+src);%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.write_slice_cloned" class="method"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#1116-1158">source</a><h4 class="code-header">pub fn <a href="#method.write_slice_cloned" class="fn">write_slice_cloned</a>&lt;'a&gt;(
    this: &amp;'a mut [<a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;],
    src: &amp;<a class="primitive" href="../primitive.slice.html">[T]</a>
) -&gt; &amp;'a mut <a class="primitive" href="../primitive.slice.html">[T]</a><span class="where fmt-newline">where
    T: <a class="trait" href="../clone/trait.Clone.html" title="trait core::clone::Clone">Clone</a>,</span></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_write_slice</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/79995">#79995</a>)</span></div></span></summary><div class="docblock"><p>å°†å…ƒç´ ä» <code>src</code> å…‹éš†åˆ° <code>this</code>ï¼Œè¿”å›å¯¹ <code>this</code> ç°åœ¨åˆå§‹åŒ–å†…å®¹çš„å¯å˜å¼•ç”¨ã€‚
ä»»ä½•å·²ç»åˆå§‹åŒ–çš„å…ƒç´ éƒ½ä¸ä¼šè¢«ä¸¢å¼ƒã€‚</p>
<p>å¦‚æœ <code>T</code> å®ç° <code>Copy</code>ï¼Œè¯·ä½¿ç”¨ <a href="union.MaybeUninit.html#method.write_slice" title="associated function core::mem::MaybeUninit::write_slice"><code>write_slice</code></a></p>
<p>è¿™ç±»ä¼¼äº <a href="../primitive.slice.html#method.clone_from_slice" title="method slice::clone_from_slice"><code>slice::clone_from_slice</code></a>ï¼Œä½†ä¸ä¼šä¸¢å¼ƒç°æœ‰å…ƒç´ ã€‚</p>
<h5 id="panics-1"><a href="#panics-1">Panics</a></h5>
<p>å¦‚æœä¸¤ä¸ªåˆ‡ç‰‡çš„é•¿åº¦ä¸åŒï¼Œæˆ–è€… <code>Clone</code> panics çš„å®ç°ï¼Œåˆ™æ­¤å‡½æ•°å°†ä¸º panicã€‚</p>
<p>å¦‚æœå­˜åœ¨ panicï¼Œå°†ä¸¢å¼ƒå·²ç»å…‹éš†çš„å…ƒç´ ã€‚</p>
<h5 id="examples-11"><a href="#examples-11">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(maybe_uninit_write_slice)]
</span><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>dst = [MaybeUninit::uninit(), MaybeUninit::uninit(), MaybeUninit::uninit(), MaybeUninit::uninit(), MaybeUninit::uninit()];
<span class="kw">let </span>src = [<span class="string">&quot;wibbly&quot;</span>.to_string(), <span class="string">&quot;wobbly&quot;</span>.to_string(), <span class="string">&quot;timey&quot;</span>.to_string(), <span class="string">&quot;wimey&quot;</span>.to_string(), <span class="string">&quot;stuff&quot;</span>.to_string()];

<span class="kw">let </span>init = MaybeUninit::write_slice_cloned(<span class="kw-2">&amp;mut </span>dst, <span class="kw-2">&amp;</span>src);

<span class="macro">assert_eq!</span>(init, src);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(maybe_uninit_write_slice)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+dst+=+%5BMaybeUninit::uninit(),+MaybeUninit::uninit(),+MaybeUninit::uninit(),+MaybeUninit::uninit(),+MaybeUninit::uninit()%5D;%0Alet+src+=+%5B%22wibbly%22.to_string(),+%22wobbly%22.to_string(),+%22timey%22.to_string(),+%22wimey%22.to_string(),+%22stuff%22.to_string()%5D;%0A%0Alet+init+=+MaybeUninit::write_slice_cloned(%26mut+dst,+%26src);%0A%0Aassert_eq!(init,+src);%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(maybe_uninit_write_slice)]
</span><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>vec = Vec::with_capacity(<span class="number">32</span>);
<span class="kw">let </span>src = [<span class="string">&quot;rust&quot;</span>, <span class="string">&quot;is&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;pretty&quot;</span>, <span class="string">&quot;cool&quot;</span>, <span class="string">&quot;language&quot;</span>];

MaybeUninit::write_slice_cloned(<span class="kw-2">&amp;mut </span>vec.spare_capacity_mut()[..src.len()], <span class="kw-2">&amp;</span>src);

<span class="comment">// SAFETY: æˆ‘ä»¬åˆšåˆšå°† len çš„æ‰€æœ‰å…ƒç´ å…‹éš†åˆ°äº†å¤‡ç”¨å®¹é‡ä¸­ï¼Œvec çš„ç¬¬ä¸€ä¸ª src.len() å…ƒç´ ç°åœ¨æœ‰æ•ˆã€‚
</span><span class="kw">unsafe </span>{
    vec.set_len(src.len());
}

<span class="macro">assert_eq!</span>(vec, src);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(maybe_uninit_write_slice)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+vec+=+Vec::with_capacity(32);%0Alet+src+=+%5B%22rust%22,+%22is%22,+%22a%22,+%22pretty%22,+%22cool%22,+%22language%22%5D;%0A%0AMaybeUninit::write_slice_cloned(%26mut+vec.spare_capacity_mut()%5B..src.len()%5D,+%26src);%0A%0A//+SAFETY:+%E6%88%91%E4%BB%AC%E5%88%9A%E5%88%9A%E5%B0%86+len+%E7%9A%84%E6%89%80%E6%9C%89%E5%85%83%E7%B4%A0%E5%85%8B%E9%9A%86%E5%88%B0%E4%BA%86%E5%A4%87%E7%94%A8%E5%AE%B9%E9%87%8F%E4%B8%AD%EF%BC%8Cvec+%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA+src.len()+%E5%85%83%E7%B4%A0%E7%8E%B0%E5%9C%A8%E6%9C%89%E6%95%88%E3%80%82%0Aunsafe+%7B%0A++++vec.set_len(src.len());%0A%7D%0A%0Aassert_eq!(vec,+src);%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.as_bytes" class="method"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#1178-1183">source</a><h4 class="code-header">pub fn <a href="#method.as_bytes" class="fn">as_bytes</a>(&amp;self) -&gt; &amp;[<a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;<a class="primitive" href="../primitive.u8.html">u8</a>&gt;]</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_as_bytes</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/93092">#93092</a>)</span></div></span></summary><div class="docblock"><p>å°†æ­¤ <code>MaybeUninit</code> çš„å†…å®¹ä½œä¸ºå¯èƒ½æœªåˆå§‹åŒ–çš„å­—èŠ‚åˆ‡ç‰‡è¿”å›ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œå³ä½¿ <code>MaybeUninit</code> çš„å†…å®¹å·²åˆå§‹åŒ–ï¼Œè¯¥å€¼ä»å¯èƒ½åŒ…å«æœªåˆå§‹åŒ–çš„å¡«å……å­—èŠ‚ã€‚</p>
<h5 id="examples-12"><a href="#examples-12">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(maybe_uninit_as_bytes, maybe_uninit_slice)]
</span><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span>val = <span class="number">0x12345678_i32</span>;
<span class="kw">let </span>uninit = MaybeUninit::new(val);
<span class="kw">let </span>uninit_bytes = uninit.as_bytes();
<span class="kw">let </span>bytes = <span class="kw">unsafe </span>{ MaybeUninit::slice_assume_init_ref(uninit_bytes) };
<span class="macro">assert_eq!</span>(bytes, val.to_ne_bytes());</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(maybe_uninit_as_bytes,+maybe_uninit_slice)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+val+=+0x12345678_i32;%0Alet+uninit+=+MaybeUninit::new(val);%0Alet+uninit_bytes+=+uninit.as_bytes();%0Alet+bytes+=+unsafe+%7B+MaybeUninit::slice_assume_init_ref(uninit_bytes)+%7D;%0Aassert_eq!(bytes,+val.to_ne_bytes());%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.as_bytes_mut" class="method"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#1209-1217">source</a><h4 class="code-header">pub fn <a href="#method.as_bytes_mut" class="fn">as_bytes_mut</a>(&amp;mut self) -&gt; &amp;mut [<a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;<a class="primitive" href="../primitive.u8.html">u8</a>&gt;]</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_as_bytes</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/93092">#93092</a>)</span></div></span></summary><div class="docblock"><p>è¿”å›æ­¤ <code>MaybeUninit</code> çš„å†…å®¹ä½œä¸ºå¯èƒ½æœªåˆå§‹åŒ–å­—èŠ‚çš„å¯å˜åˆ‡ç‰‡è¿”å›ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œå³ä½¿ <code>MaybeUninit</code> çš„å†…å®¹å·²åˆå§‹åŒ–ï¼Œè¯¥å€¼ä»å¯èƒ½åŒ…å«æœªåˆå§‹åŒ–çš„å¡«å……å­—èŠ‚ã€‚</p>
<h5 id="examples-13"><a href="#examples-13">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(maybe_uninit_as_bytes)]
</span><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span>val = <span class="number">0x12345678_i32</span>;
<span class="kw">let </span><span class="kw-2">mut </span>uninit = MaybeUninit::new(val);
<span class="kw">let </span>uninit_bytes = uninit.as_bytes_mut();
<span class="kw">if </span><span class="macro">cfg!</span>(target_endian = <span class="string">&quot;little&quot;</span>) {
    uninit_bytes[<span class="number">0</span>].write(<span class="number">0xcd</span>);
} <span class="kw">else </span>{
    uninit_bytes[<span class="number">3</span>].write(<span class="number">0xcd</span>);
}
<span class="kw">let </span>val2 = <span class="kw">unsafe </span>{ uninit.assume_init() };
<span class="macro">assert_eq!</span>(val2, <span class="number">0x123456cd</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(maybe_uninit_as_bytes)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+val+=+0x12345678_i32;%0Alet+mut+uninit+=+MaybeUninit::new(val);%0Alet+uninit_bytes+=+uninit.as_bytes_mut();%0Aif+cfg!(target_endian+=+%22little%22)+%7B%0A++++uninit_bytes%5B0%5D.write(0xcd);%0A%7D+else+%7B%0A++++uninit_bytes%5B3%5D.write(0xcd);%0A%7D%0Alet+val2+=+unsafe+%7B+uninit.assume_init()+%7D;%0Aassert_eq!(val2,+0x123456cd);%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.slice_as_bytes" class="method"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#1239-1243">source</a><h4 class="code-header">pub fn <a href="#method.slice_as_bytes" class="fn">slice_as_bytes</a>(this: &amp;[<a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;]) -&gt; &amp;[<a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;<a class="primitive" href="../primitive.u8.html">u8</a>&gt;]</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_as_bytes</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/93092">#93092</a>)</span></div></span></summary><div class="docblock"><p>å°†æ­¤ <code>MaybeUninit</code> åˆ‡ç‰‡çš„å†…å®¹ä½œä¸ºå¯èƒ½æœªåˆå§‹åŒ–çš„å­—èŠ‚åˆ‡ç‰‡è¿”å›ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œå³ä½¿ <code>MaybeUninit</code> çš„å†…å®¹å·²åˆå§‹åŒ–ï¼Œè¯¥å€¼ä»å¯èƒ½åŒ…å«æœªåˆå§‹åŒ–çš„å¡«å……å­—èŠ‚ã€‚</p>
<h5 id="examples-14"><a href="#examples-14">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(maybe_uninit_as_bytes, maybe_uninit_write_slice, maybe_uninit_slice)]
</span><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span>uninit = [MaybeUninit::new(<span class="number">0x1234u16</span>), MaybeUninit::new(<span class="number">0x5678u16</span>)];
<span class="kw">let </span>uninit_bytes = MaybeUninit::slice_as_bytes(<span class="kw-2">&amp;</span>uninit);
<span class="kw">let </span>bytes = <span class="kw">unsafe </span>{ MaybeUninit::slice_assume_init_ref(<span class="kw-2">&amp;</span>uninit_bytes) };
<span class="kw">let </span>val1 = u16::from_ne_bytes(bytes[<span class="number">0</span>..<span class="number">2</span>].try_into().unwrap());
<span class="kw">let </span>val2 = u16::from_ne_bytes(bytes[<span class="number">2</span>..<span class="number">4</span>].try_into().unwrap());
<span class="macro">assert_eq!</span>(<span class="kw-2">&amp;</span>[val1, val2], <span class="kw-2">&amp;</span>[<span class="number">0x1234u16</span>, <span class="number">0x5678u16</span>]);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(maybe_uninit_as_bytes,+maybe_uninit_write_slice,+maybe_uninit_slice)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+uninit+=+%5BMaybeUninit::new(0x1234u16),+MaybeUninit::new(0x5678u16)%5D;%0Alet+uninit_bytes+=+MaybeUninit::slice_as_bytes(%26uninit);%0Alet+bytes+=+unsafe+%7B+MaybeUninit::slice_assume_init_ref(%26uninit_bytes)+%7D;%0Alet+val1+=+u16::from_ne_bytes(bytes%5B0..2%5D.try_into().unwrap());%0Alet+val2+=+u16::from_ne_bytes(bytes%5B2..4%5D.try_into().unwrap());%0Aassert_eq!(%26%5Bval1,+val2%5D,+%26%5B0x1234u16,+0x5678u16%5D);%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.slice_as_bytes_mut" class="method"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#1268-1272">source</a><h4 class="code-header">pub fn <a href="#method.slice_as_bytes_mut" class="fn">slice_as_bytes_mut</a>(this: &amp;mut [<a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;]) -&gt; &amp;mut [<a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;<a class="primitive" href="../primitive.u8.html">u8</a>&gt;]</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_as_bytes</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/93092">#93092</a>)</span></div></span></summary><div class="docblock"><p>å°† <code>MaybeUninit</code> çš„å¯å˜åˆ‡ç‰‡çš„å†…å®¹ä½œä¸ºå¯èƒ½æœªåˆå§‹åŒ–å­—èŠ‚çš„å¯å˜åˆ‡ç‰‡è¿”å›ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œå³ä½¿ <code>MaybeUninit</code> çš„å†…å®¹å·²åˆå§‹åŒ–ï¼Œè¯¥å€¼ä»å¯èƒ½åŒ…å«æœªåˆå§‹åŒ–çš„å¡«å……å­—èŠ‚ã€‚</p>
<h5 id="examples-15"><a href="#examples-15">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(maybe_uninit_as_bytes, maybe_uninit_write_slice, maybe_uninit_slice)]
</span><span class="kw">use </span>std::mem::MaybeUninit;

<span class="kw">let </span><span class="kw-2">mut </span>uninit = [MaybeUninit::&lt;u16&gt;::uninit(), MaybeUninit::&lt;u16&gt;::uninit()];
<span class="kw">let </span>uninit_bytes = MaybeUninit::slice_as_bytes_mut(<span class="kw-2">&amp;mut </span>uninit);
MaybeUninit::write_slice(uninit_bytes, <span class="kw-2">&amp;</span>[<span class="number">0x12</span>, <span class="number">0x34</span>, <span class="number">0x56</span>, <span class="number">0x78</span>]);
<span class="kw">let </span>vals = <span class="kw">unsafe </span>{ MaybeUninit::slice_assume_init_ref(<span class="kw-2">&amp;</span>uninit) };
<span class="kw">if </span><span class="macro">cfg!</span>(target_endian = <span class="string">&quot;little&quot;</span>) {
    <span class="macro">assert_eq!</span>(vals, <span class="kw-2">&amp;</span>[<span class="number">0x3412u16</span>, <span class="number">0x7856u16</span>]);
} <span class="kw">else </span>{
    <span class="macro">assert_eq!</span>(vals, <span class="kw-2">&amp;</span>[<span class="number">0x1234u16</span>, <span class="number">0x5678u16</span>]);
}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(maybe_uninit_as_bytes,+maybe_uninit_write_slice,+maybe_uninit_slice)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+mut+uninit+=+%5BMaybeUninit::%3Cu16%3E::uninit(),+MaybeUninit::%3Cu16%3E::uninit()%5D;%0Alet+uninit_bytes+=+MaybeUninit::slice_as_bytes_mut(%26mut+uninit);%0AMaybeUninit::write_slice(uninit_bytes,+%26%5B0x12,+0x34,+0x56,+0x78%5D);%0Alet+vals+=+unsafe+%7B+MaybeUninit::slice_assume_init_ref(%26uninit)+%7D;%0Aif+cfg!(target_endian+=+%22little%22)+%7B%0A++++assert_eq!(vals,+%26%5B0x3412u16,+0x7856u16%5D);%0A%7D+else+%7B%0A++++assert_eq!(vals,+%26%5B0x1234u16,+0x5678u16%5D);%0A%7D%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-MaybeUninit%3C%5BT;+N%5D%3E" class="impl"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#1275-1292">source</a><a href="#impl-MaybeUninit%3C%5BT;+N%5D%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T, const N: <a class="primitive" href="../primitive.usize.html">usize</a>&gt; <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;<a class="primitive" href="../primitive.array.html">[T; N]</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.transpose" class="method"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#1288-1291">source</a><h4 class="code-header">pub const fn <a href="#method.transpose" class="fn">transpose</a>(self) -&gt; [<a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;; <a class="primitive" href="../primitive.array.html">N</a>]</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">ğŸ”¬</span><span>This is a nightly-only experimental API. (<code>maybe_uninit_uninit_array_transpose</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/96097">#96097</a>)</span></div></span></summary><div class="docblock"><p>å°† <code>MaybeUninit&lt;[T; N]&gt;</code> ç§»è°ƒä¸º <code>[MaybeUninit&lt;T&gt;; N]</code>ã€‚</p>
<h5 id="examples-16"><a href="#examples-16">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(maybe_uninit_uninit_array_transpose)]

</span><span class="kw">let </span>data: [MaybeUninit&lt;u8&gt;; <span class="number">1000</span>] = MaybeUninit::uninit().transpose();</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(maybe_uninit_uninit_array_transpose)%5D%0Afn+main()+%7B%0Ause+std::mem::MaybeUninit;%0A%0Alet+data:+%5BMaybeUninit%3Cu8%3E;+1000%5D+=+MaybeUninit::uninit().transpose();%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details></div></details></div><h2 id="trait-implementations" class="small-section-header">Trait Implementations<a href="#trait-implementations" class="anchor">Â§</a></h2><div id="trait-implementations-list"><details class="toggle implementors-toggle" open><summary><section id="impl-Clone-for-MaybeUninit%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#255-261">source</a><a href="#impl-Clone-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T: <a class="trait" href="../marker/trait.Copy.html" title="trait core::marker::Copy">Copy</a>&gt; <a class="trait" href="../clone/trait.Clone.html" title="trait core::clone::Clone">Clone</a> for <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.clone" class="method trait-impl"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#257-260">source</a><a href="#method.clone" class="anchor">Â§</a><h4 class="code-header">fn <a href="../clone/trait.Clone.html#tymethod.clone" class="fn">clone</a>(&amp;self) -&gt; Self</h4></section></summary><div class='docblock'>è¿”å›å€¼çš„å‰¯æœ¬ã€‚ <a href="../clone/trait.Clone.html#tymethod.clone">Read more</a></div></details><details class="toggle method-toggle" open><summary><section id="method.clone_from" class="method trait-impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.0.0">1.0.0</span> Â· <a class="srclink" href="../../src/core/clone.rs.html#129-131">source</a></span><a href="#method.clone_from" class="anchor">Â§</a><h4 class="code-header">fn <a href="../clone/trait.Clone.html#method.clone_from" class="fn">clone_from</a>(&amp;mut self, source: <a class="primitive" href="../primitive.reference.html">&amp;Self</a>)</h4></section></summary><div class='docblock'>ä» <code>source</code> æ‰§è¡Œå¤åˆ¶åˆ†é…ã€‚ <a href="../clone/trait.Clone.html#method.clone_from">Read more</a></div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Debug-for-MaybeUninit%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.41.0">1.41.0</span> Â· <a class="srclink" href="../../src/core/mem/maybe_uninit.rs.html#264-268">source</a></span><a href="#impl-Debug-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a> for <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.fmt" class="method trait-impl"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#265-267">source</a><a href="#method.fmt" class="anchor">Â§</a><h4 class="code-header">fn <a href="../fmt/trait.Debug.html#tymethod.fmt" class="fn">fmt</a>(&amp;self, f: &amp;mut <a class="struct" href="../fmt/struct.Formatter.html" title="struct core::fmt::Formatter">Formatter</a>&lt;'_&gt;) -&gt; <a class="type" href="../fmt/type.Result.html" title="type core::fmt::Result">Result</a></h4></section></summary><div class='docblock'>ä½¿ç”¨ç»™å®šçš„æ ¼å¼åŒ–ç¨‹åºæ ¼å¼åŒ–è¯¥å€¼ã€‚ <a href="../fmt/trait.Debug.html#tymethod.fmt">Read more</a></div></details></div></details><section id="impl-Copy-for-MaybeUninit%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/mem/maybe_uninit.rs.html#247">source</a><a href="#impl-Copy-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T: <a class="trait" href="../marker/trait.Copy.html" title="trait core::marker::Copy">Copy</a>&gt; <a class="trait" href="../marker/trait.Copy.html" title="trait core::marker::Copy">Copy</a> for <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;</h3></section></div><h2 id="synthetic-implementations" class="small-section-header">Auto Trait Implementations<a href="#synthetic-implementations" class="anchor">Â§</a></h2><div id="synthetic-implementations-list"><section id="impl-RefUnwindSafe-for-MaybeUninit%3CT%3E" class="impl"><a href="#impl-RefUnwindSafe-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../panic/trait.RefUnwindSafe.html" title="trait core::panic::RefUnwindSafe">RefUnwindSafe</a> for <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../panic/trait.RefUnwindSafe.html" title="trait core::panic::RefUnwindSafe">RefUnwindSafe</a>,</span></h3></section><section id="impl-Send-for-MaybeUninit%3CT%3E" class="impl"><a href="#impl-Send-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../marker/trait.Send.html" title="trait core::marker::Send">Send</a> for <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../marker/trait.Send.html" title="trait core::marker::Send">Send</a>,</span></h3></section><section id="impl-Sync-for-MaybeUninit%3CT%3E" class="impl"><a href="#impl-Sync-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> for <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a>,</span></h3></section><section id="impl-Unpin-for-MaybeUninit%3CT%3E" class="impl"><a href="#impl-Unpin-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a> for <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a>,</span></h3></section><section id="impl-UnwindSafe-for-MaybeUninit%3CT%3E" class="impl"><a href="#impl-UnwindSafe-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../panic/trait.UnwindSafe.html" title="trait core::panic::UnwindSafe">UnwindSafe</a> for <a class="union" href="union.MaybeUninit.html" title="union core::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../panic/trait.UnwindSafe.html" title="trait core::panic::UnwindSafe">UnwindSafe</a>,</span></h3></section></div><h2 id="blanket-implementations" class="small-section-header">Blanket Implementations<a href="#blanket-implementations" class="anchor">Â§</a></h2><div id="blanket-implementations-list"><details class="toggle implementors-toggle"><summary><section id="impl-Any-for-MaybeUninit%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/any.rs.html#200-204">source</a><a href="#impl-Any-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../any/trait.Any.html" title="trait core::any::Any">Any</a> for T<span class="where fmt-newline">where
    T: 'static + ?<a class="trait" href="../marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.type_id" class="method trait-impl"><a class="srclink rightside" href="../../src/core/any.rs.html#201-203">source</a><a href="#method.type_id" class="anchor">Â§</a><h4 class="code-header">fn <a href="../any/trait.Any.html#tymethod.type_id" class="fn">type_id</a>(&amp;self) -&gt; <a class="struct" href="../any/struct.TypeId.html" title="struct core::any::TypeId">TypeId</a></h4></section></summary><div class='docblock'>è·å– <code>self</code> çš„ <code>TypeId</code>ã€‚ <a href="../any/trait.Any.html#tymethod.type_id">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Borrow%3CT%3E-for-MaybeUninit%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/borrow.rs.html#208-213">source</a><a href="#impl-Borrow%3CT%3E-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../borrow/trait.Borrow.html" title="trait core::borrow::Borrow">Borrow</a>&lt;T&gt; for T<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.borrow" class="method trait-impl"><a class="srclink rightside" href="../../src/core/borrow.rs.html#210-212">source</a><a href="#method.borrow" class="anchor">Â§</a><h4 class="code-header">fn <a href="../borrow/trait.Borrow.html#tymethod.borrow" class="fn">borrow</a>(&amp;self) -&gt; <a class="primitive" href="../primitive.reference.html">&amp;T</a></h4></section></summary><div class='docblock'>ä»æ‹¥æœ‰çš„å€¼ä¸­ä¸€æˆä¸å˜åœ°å€Ÿç”¨ã€‚ <a href="../borrow/trait.Borrow.html#tymethod.borrow">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-BorrowMut%3CT%3E-for-MaybeUninit%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/borrow.rs.html#216-220">source</a><a href="#impl-BorrowMut%3CT%3E-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../borrow/trait.BorrowMut.html" title="trait core::borrow::BorrowMut">BorrowMut</a>&lt;T&gt; for T<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.borrow_mut" class="method trait-impl"><a class="srclink rightside" href="../../src/core/borrow.rs.html#217-219">source</a><a href="#method.borrow_mut" class="anchor">Â§</a><h4 class="code-header">fn <a href="../borrow/trait.BorrowMut.html#tymethod.borrow_mut" class="fn">borrow_mut</a>(&amp;mut self) -&gt; <a class="primitive" href="../primitive.reference.html">&amp;mut T</a></h4></section></summary><div class='docblock'>ä»æ‹¥æœ‰çš„å€¼ä¸­å€Ÿç”¨ã€‚ <a href="../borrow/trait.BorrowMut.html#tymethod.borrow_mut">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-From%3CT%3E-for-MaybeUninit%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#723-729">source</a><a href="#impl-From%3CT%3E-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt; for T</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from" class="method trait-impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#726-728">source</a><a href="#method.from" class="anchor">Â§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(t: T) -&gt; T</h4></section></summary><div class="docblock"><p>è¿”å›æœªæ›´æ”¹çš„å‚æ•°ã€‚</p>
</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Into%3CU%3E-for-MaybeUninit%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#707-719">source</a><a href="#impl-Into%3CU%3E-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="../convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;U&gt; for T<span class="where fmt-newline">where
    U: <a class="trait" href="../convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt;,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.into" class="method trait-impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#716-718">source</a><a href="#method.into" class="anchor">Â§</a><h4 class="code-header">fn <a href="../convert/trait.Into.html#tymethod.into" class="fn">into</a>(self) -&gt; U</h4></section></summary><div class="docblock"><p>è°ƒç”¨ <code>U::from(self)</code>ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§è½¬æ¢æ˜¯ <code><a href="../convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt; for U</code> å®ç°é€‰æ‹©æ‰§è¡Œçš„ä»»ä½•æ“ä½œã€‚</p>
</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-TryFrom%3CU%3E-for-MaybeUninit%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#763-773">source</a><a href="#impl-TryFrom%3CU%3E-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="../convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt; for T<span class="where fmt-newline">where
    U: <a class="trait" href="../convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;T&gt;,</span></h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Error-1" class="associatedtype trait-impl"><a href="#associatedtype.Error-1" class="anchor">Â§</a><h4 class="code-header">type <a href="../convert/trait.TryFrom.html#associatedtype.Error" class="associatedtype">Error</a> = <a class="enum" href="../convert/enum.Infallible.html" title="enum core::convert::Infallible">Infallible</a></h4></section></summary><div class='docblock'>å‘ç”Ÿè½¬æ¢é”™è¯¯æ—¶è¿”å›çš„ç±»å‹ã€‚</div></details><details class="toggle method-toggle" open><summary><section id="method.try_from" class="method trait-impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#770-772">source</a><a href="#method.try_from" class="anchor">Â§</a><h4 class="code-header">fn <a href="../convert/trait.TryFrom.html#tymethod.try_from" class="fn">try_from</a>(value: U) -&gt; <a class="enum" href="../result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;T, &lt;T as <a class="trait" href="../convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt;&gt;::<a class="associatedtype" href="../convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>æ‰§è¡Œè½¬æ¢ã€‚</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-TryInto%3CU%3E-for-MaybeUninit%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#748-758">source</a><a href="#impl-TryInto%3CU%3E-for-MaybeUninit%3CT%3E" class="anchor">Â§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="../convert/trait.TryInto.html" title="trait core::convert::TryInto">TryInto</a>&lt;U&gt; for T<span class="where fmt-newline">where
    U: <a class="trait" href="../convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;,</span></h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Error" class="associatedtype trait-impl"><a href="#associatedtype.Error" class="anchor">Â§</a><h4 class="code-header">type <a href="../convert/trait.TryInto.html#associatedtype.Error" class="associatedtype">Error</a> = &lt;U as <a class="trait" href="../convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="../convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a></h4></section></summary><div class='docblock'>å‘ç”Ÿè½¬æ¢é”™è¯¯æ—¶è¿”å›çš„ç±»å‹ã€‚</div></details><details class="toggle method-toggle" open><summary><section id="method.try_into" class="method trait-impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#755-757">source</a><a href="#method.try_into" class="anchor">Â§</a><h4 class="code-header">fn <a href="../convert/trait.TryInto.html#tymethod.try_into" class="fn">try_into</a>(self) -&gt; <a class="enum" href="../result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;U, &lt;U as <a class="trait" href="../convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="../convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>æ‰§è¡Œè½¬æ¢ã€‚</div></details></div></details></div></section></div></main></body></html>