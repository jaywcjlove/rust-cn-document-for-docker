<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="线程安全的引用计数指针。`Arc` 代表原子引用计数。"><title>Arc in std::sync - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-f3501f0f5ae15dfb.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="std" data-themes="" data-resource-suffix="1.71.0" data-rustdoc-version="1.71.0-dev" data-search-js="search-4926e5fc22a5646a.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="sidebar-items1.71.0.js"></script><script defer src="../../static.files/main-f0540c1d82cde29b.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc struct"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../std/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../std/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Arc</a></h2><div class="sidebar-elems"><section><h3><a href="#implementations">Methods</a></h3><ul class="block"><li><a href="#method.as_ptr">as_ptr</a></li><li><a href="#method.assume_init">assume_init</a></li><li><a href="#method.assume_init-1">assume_init</a></li><li><a href="#method.decrement_strong_count">decrement_strong_count</a></li><li><a href="#method.downcast">downcast</a></li><li><a href="#method.downcast_unchecked">downcast_unchecked</a></li><li><a href="#method.downgrade">downgrade</a></li><li><a href="#method.from_raw">from_raw</a></li><li><a href="#method.get_mut">get_mut</a></li><li><a href="#method.get_mut_unchecked">get_mut_unchecked</a></li><li><a href="#method.increment_strong_count">increment_strong_count</a></li><li><a href="#method.into_inner">into_inner</a></li><li><a href="#method.into_raw">into_raw</a></li><li><a href="#method.make_mut">make_mut</a></li><li><a href="#method.new">new</a></li><li><a href="#method.new_cyclic">new_cyclic</a></li><li><a href="#method.new_uninit">new_uninit</a></li><li><a href="#method.new_uninit_slice">new_uninit_slice</a></li><li><a href="#method.new_zeroed">new_zeroed</a></li><li><a href="#method.new_zeroed_slice">new_zeroed_slice</a></li><li><a href="#method.pin">pin</a></li><li><a href="#method.ptr_eq">ptr_eq</a></li><li><a href="#method.strong_count">strong_count</a></li><li><a href="#method.try_new">try_new</a></li><li><a href="#method.try_new_uninit">try_new_uninit</a></li><li><a href="#method.try_new_zeroed">try_new_zeroed</a></li><li><a href="#method.try_pin">try_pin</a></li><li><a href="#method.try_unwrap">try_unwrap</a></li><li><a href="#method.unwrap_or_clone">unwrap_or_clone</a></li><li><a href="#method.weak_count">weak_count</a></li></ul><h3><a href="#trait-implementations">Trait Implementations</a></h3><ul class="block"><li><a href="#impl-AsFd-for-Arc%3CT%3E">AsFd</a></li><li><a href="#impl-AsHandle-for-Arc%3CT%3E">AsHandle</a></li><li><a href="#impl-AsRawFd-for-Arc%3CT%3E">AsRawFd</a></li><li><a href="#impl-AsRef%3CT%3E-for-Arc%3CT%3E">AsRef&lt;T&gt;</a></li><li><a href="#impl-AsSocket-for-Arc%3CT%3E">AsSocket</a></li><li><a href="#impl-Borrow%3CT%3E-for-Arc%3CT%3E">Borrow&lt;T&gt;</a></li><li><a href="#impl-Clone-for-Arc%3CT%3E">Clone</a></li><li><a href="#impl-CoerceUnsized%3CArc%3CU%3E%3E-for-Arc%3CT%3E">CoerceUnsized&lt;Arc&lt;U&gt;&gt;</a></li><li><a href="#impl-Debug-for-Arc%3CT%3E">Debug</a></li><li><a href="#impl-Default-for-Arc%3CT%3E">Default</a></li><li><a href="#impl-Deref-for-Arc%3CT%3E">Deref</a></li><li><a href="#impl-DispatchFromDyn%3CArc%3CU%3E%3E-for-Arc%3CT%3E">DispatchFromDyn&lt;Arc&lt;U&gt;&gt;</a></li><li><a href="#impl-Display-for-Arc%3CT%3E">Display</a></li><li><a href="#impl-Drop-for-Arc%3CT%3E">Drop</a></li><li><a href="#impl-Eq-for-Arc%3CT%3E">Eq</a></li><li><a href="#impl-Error-for-Arc%3CT%3E">Error</a></li><li><a href="#impl-From%3C%26CStr%3E-for-Arc%3CCStr%3E">From&lt;&amp;CStr&gt;</a></li><li><a href="#impl-From%3C%26OsStr%3E-for-Arc%3COsStr%3E">From&lt;&amp;OsStr&gt;</a></li><li><a href="#impl-From%3C%26Path%3E-for-Arc%3CPath%3E">From&lt;&amp;Path&gt;</a></li><li><a href="#impl-From%3C%26%5BT%5D%3E-for-Arc%3C%5BT%5D%3E">From&lt;&amp;[T]&gt;</a></li><li><a href="#impl-From%3C%26str%3E-for-Arc%3Cstr%3E">From&lt;&amp;str&gt;</a></li><li><a href="#impl-From%3CArc%3CW%3E%3E-for-RawWaker">From&lt;Arc&lt;W&gt;&gt;</a></li><li><a href="#impl-From%3CArc%3CW%3E%3E-for-Waker">From&lt;Arc&lt;W&gt;&gt;</a></li><li><a href="#impl-From%3CArc%3Cstr%3E%3E-for-Arc%3C%5Bu8%5D%3E">From&lt;Arc&lt;str&gt;&gt;</a></li><li><a href="#impl-From%3CBox%3CT,+Global%3E%3E-for-Arc%3CT%3E">From&lt;Box&lt;T, Global&gt;&gt;</a></li><li><a href="#impl-From%3CCString%3E-for-Arc%3CCStr%3E">From&lt;CString&gt;</a></li><li><a href="#impl-From%3CCow%3C'a,+B%3E%3E-for-Arc%3CB%3E">From&lt;Cow&lt;&#x27;a, B&gt;&gt;</a></li><li><a href="#impl-From%3COsString%3E-for-Arc%3COsStr%3E">From&lt;OsString&gt;</a></li><li><a href="#impl-From%3CPathBuf%3E-for-Arc%3CPath%3E">From&lt;PathBuf&gt;</a></li><li><a href="#impl-From%3CString%3E-for-Arc%3Cstr%3E">From&lt;String&gt;</a></li><li><a href="#impl-From%3CT%3E-for-Arc%3CT%3E">From&lt;T&gt;</a></li><li><a href="#impl-From%3CVec%3CT,+Global%3E%3E-for-Arc%3C%5BT%5D%3E">From&lt;Vec&lt;T, Global&gt;&gt;</a></li><li><a href="#impl-FromIterator%3CT%3E-for-Arc%3C%5BT%5D%3E">FromIterator&lt;T&gt;</a></li><li><a href="#impl-Hash-for-Arc%3CT%3E">Hash</a></li><li><a href="#impl-Ord-for-Arc%3CT%3E">Ord</a></li><li><a href="#impl-PartialEq%3CArc%3CT%3E%3E-for-Arc%3CT%3E">PartialEq&lt;Arc&lt;T&gt;&gt;</a></li><li><a href="#impl-PartialOrd%3CArc%3CT%3E%3E-for-Arc%3CT%3E">PartialOrd&lt;Arc&lt;T&gt;&gt;</a></li><li><a href="#impl-Pointer-for-Arc%3CT%3E">Pointer</a></li><li><a href="#impl-Send-for-Arc%3CT%3E">Send</a></li><li><a href="#impl-Sync-for-Arc%3CT%3E">Sync</a></li><li><a href="#impl-TryFrom%3CArc%3C%5BT%5D%3E%3E-for-Arc%3C%5BT;+N%5D%3E">TryFrom&lt;Arc&lt;[T]&gt;&gt;</a></li><li><a href="#impl-Unpin-for-Arc%3CT%3E">Unpin</a></li><li><a href="#impl-UnwindSafe-for-Arc%3CT%3E">UnwindSafe</a></li></ul><h3><a href="#synthetic-implementations">Auto Trait Implementations</a></h3><ul class="block"><li><a href="#impl-RefUnwindSafe-for-Arc%3CT%3E">RefUnwindSafe</a></li></ul><h3><a href="#blanket-implementations">Blanket Implementations</a></h3><ul class="block"><li><a href="#impl-Any-for-Arc%3CT%3E">Any</a></li><li><a href="#impl-Borrow%3CT%3E-for-Arc%3CT%3E-1">Borrow&lt;T&gt;</a></li><li><a href="#impl-BorrowMut%3CT%3E-for-Arc%3CT%3E">BorrowMut&lt;T&gt;</a></li><li><a href="#impl-From%3C!%3E-for-Arc%3CT%3E">From&lt;!&gt;</a></li><li><a href="#impl-From%3CT%3E-for-Arc%3CT%3E-1">From&lt;T&gt;</a></li><li><a href="#impl-Into%3CU%3E-for-Arc%3CT%3E">Into&lt;U&gt;</a></li><li><a href="#impl-Provider-for-Arc%3CT%3E">Provider</a></li><li><a href="#impl-ToOwned-for-Arc%3CT%3E">ToOwned</a></li><li><a href="#impl-ToString-for-Arc%3CT%3E">ToString</a></li><li><a href="#impl-TryFrom%3CU%3E-for-Arc%3CT%3E">TryFrom&lt;U&gt;</a></li><li><a href="#impl-TryInto%3CU%3E-for-Arc%3CT%3E">TryInto&lt;U&gt;</a></li></ul></section><h2><a href="index.html">In std::sync</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Struct <a href="../index.html">std</a>::<wbr><a href="index.html">sync</a>::<wbr><a class="struct" href="#">Arc</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><span class="since" title="Stable since Rust version 1.0.0">1.0.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#249">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub struct Arc&lt;T&gt;<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span>{ /* private fields */ }</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>线程安全的引用计数指针。<code>Arc</code> 代表原子引用计数。</p>
<p><code>Arc&lt;T&gt;</code> 类型提供了在堆中分配的 <code>T</code> 类型值的共享所有权。在 <code>Arc</code> 上调用 <a href="../clone/trait.Clone.html#tymethod.clone" title="method std::clone::Clone::clone"><code>clone</code></a> 会生成一个新的 <code>Arc</code> 实例，该实例指向堆上与源 <code>Arc</code> 相同的分配，同时增加了引用计数。
当指向给定分配的最后一个 <code>Arc</code> 指针被销毁时，存储在该分配中的值 (通常称为 “内部值”) 也将被丢弃。</p>
<p>默认情况下，Rust 中的共享引用不允许可变的，<code>Arc</code> 也不例外：您通常无法获得 <code>Arc</code> 内部内容的可变引用。如果需要通过 <code>Arc</code> 进行可变的，请使用 <a href="../../std/sync/struct.Mutex.html"><code>Mutex</code></a>，<a href="../../std/sync/struct.RwLock.html"><code>RwLock</code></a> 或 <a href="atomic/index.html" title="mod std::sync::atomic"><code>Atomic</code></a> 类型之一。</p>
<p><strong>Note</strong>: 此类型仅在支持原子加载和指针存储的平台上可用，其中包括支持 <code>std</code> crate 的所有平台，但并非所有仅支持 <a href="../../alloc/index.html" title="mod alloc"><code>alloc</code></a> 的平台。
这可以在编译时使用 <code>#[cfg(target_has_atomic = &quot;ptr&quot;)]</code> 检测到。</p>
<h3 id="线程安全"><a href="#线程安全">线程安全</a></h3>
<p>与 <a href="../rc/struct.Rc.html" title="struct std::rc::Rc"><code>Rc&lt;T&gt;</code></a> 不同，<code>Arc&lt;T&gt;</code> 使用原子操作进行引用计数。这意味着它是线程安全的。缺点是原子操作比普通的内存访问更昂贵。如果您不共享线程之间的引用计数分配，请考虑使用 <a href="../rc/struct.Rc.html" title="struct std::rc::Rc"><code>Rc&lt;T&gt;</code></a> 来降低开销。
<a href="../rc/struct.Rc.html" title="struct std::rc::Rc"><code>Rc&lt;T&gt;</code></a> 是一个安全的默认值，因为编译器会捕获在线程之间发送 <a href="../rc/struct.Rc.html" title="struct std::rc::Rc"><code>Rc&lt;T&gt;</code></a> 的任何尝试。
但是，一个库可能会选择 <code>Arc&lt;T&gt;</code>，以便为库的消费者提供更大的灵活性。</p>
<p>只要 <code>T</code> 实现 <a href="../marker/trait.Send.html" title="trait std::marker::Send"><code>Send</code></a> 和 <a href="../marker/trait.Sync.html" title="trait std::marker::Sync"><code>Sync</code></a>，<code>Arc&lt;T&gt;</code> 就会实现 <a href="../marker/trait.Send.html" title="trait std::marker::Send"><code>Send</code></a> 和 <a href="../marker/trait.Sync.html" title="trait std::marker::Sync"><code>Sync</code></a>。
为什么不能在 <code>Arc&lt;T&gt;</code> 中放置非线程安全类型 <code>T</code> 使其成为线程安全的？ 起初这可能有点违反直觉：毕竟，<code>Arc&lt;T&gt;</code> 的重点不就是线程安全吗？ 关键在于: <code>Arc&lt;T&gt;</code> 使具有同一数据的多个所有权成为线程安全的，但并未为其数据增加线程安全。</p>
<p>考虑 <code>Arc&lt;<a href="../cell/struct.RefCell.html" title="struct std::cell::RefCell">RefCell&lt;T&gt;</a>&gt;</code>。
<a href="../cell/struct.RefCell.html" title="struct std::cell::RefCell"><code>RefCell&lt;T&gt;</code></a> 不是 <a href="../marker/trait.Sync.html" title="trait std::marker::Sync"><code>Sync</code></a>，如果 <code>Arc&lt;T&gt;</code> 总是 <a href="../marker/trait.Send.html" title="trait std::marker::Send"><code>Send</code></a>，那么 <code>Arc&lt;<a href="../cell/struct.RefCell.html" title="struct std::cell::RefCell">RefCell&lt;T&gt;</a>&gt;</code> 也是。
但是然后我们会遇到一个问题：
<a href="../cell/struct.RefCell.html" title="struct std::cell::RefCell"><code>RefCell&lt;T&gt;</code></a> 不是线程安全的； 它使用非原子操作来跟踪借用计数。</p>
<p>最后，这意味着您可能需要将 <code>Arc&lt;T&gt;</code> 与某种 <a href="../../std/sync/index.html"><code>std::sync</code></a> 类型 (通常为 <a href="../../std/sync/struct.Mutex.html"><code>Mutex&lt;T&gt;</code></a>) 配对。</p>
<h3 id="weak-的中断循环"><a href="#weak-的中断循环"><code>Weak</code> 的中断循环</a></h3>
<p><a href="struct.Arc.html#method.downgrade" title="associated function std::sync::Arc::downgrade"><code>downgrade</code></a> 方法可用于创建非所有者 <a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a> 指针。<a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a> 指针可以 <a href="struct.Weak.html#method.upgrade" title="method std::sync::Weak::upgrade"><code>upgrade</code></a> 为 <code>Arc</code>，但如果存储在分配中的值已经被丢弃，这将返回 <a href="../option/enum.Option.html#variant.None" title="variant std::option::Option::None"><code>None</code></a>。
换句话说，<code>Weak</code> 指针不会使分配内部的值保持活动状态。然而，它们确实使分配（值的后备存储）保持活动状态。</p>
<p><code>Arc</code> 指针之间的循环将永远不会被释放。
因此，<a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a> 用于中断循环。例如，一棵树可能具有从父节点到子节点的强 <code>Arc</code> 指针，以及从子节点返回到其父节点的 <a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a> 指针。</p>
<h2 id="克隆引用"><a href="#克隆引用">克隆引用</a></h2>
<p>使用为 <a href="struct.Arc.html" title="struct std::sync::Arc"><code>Arc&lt;T&gt;</code></a> 和 <a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak&lt;T&gt;</code></a> 实现的 <code>Clone</code> trait 从现有的引用计数指针创建新的引用。</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;
<span class="kw">let </span>foo = Arc::new(<span class="macro">vec!</span>[<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>]);
<span class="comment">// 以下两种语法是等效的。
</span><span class="kw">let </span>a = foo.clone();
<span class="kw">let </span>b = Arc::clone(<span class="kw-2">&amp;</span>foo);
<span class="comment">// a、b 和 foo 都是指向同一内存位置的 Arc</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Alet+foo+=+Arc::new(vec!%5B1.0,+2.0,+3.0%5D);%0A//+%E4%BB%A5%E4%B8%8B%E4%B8%A4%E7%A7%8D%E8%AF%AD%E6%B3%95%E6%98%AF%E7%AD%89%E6%95%88%E7%9A%84%E3%80%82%0Alet+a+=+foo.clone();%0Alet+b+=+Arc::clone(%26foo);%0A//+a%E3%80%81b+%E5%92%8C+foo+%E9%83%BD%E6%98%AF%E6%8C%87%E5%90%91%E5%90%8C%E4%B8%80%E5%86%85%E5%AD%98%E4%BD%8D%E7%BD%AE%E7%9A%84+Arc%0A%7D&amp;edition=2021">Run</a></div>
<h3 id="deref-行为"><a href="#deref-行为"><code>Deref</code> 行为</a></h3>
<p><code>Arc&lt;T&gt;</code> 自动取消对 <code>T</code> 的引用 (通过 <a href="../ops/trait.Deref.html" title="trait std::ops::Deref"><code>Deref</code></a> trait)，因此您可以在类型为 <code>Arc&lt;T&gt;</code> 的值上调用 <code>T</code> 的方法。为了避免与 <code>T</code> 的方法名称冲突，<code>Arc&lt;T&gt;</code> 本身的方法是关联函数，使用 <a href="https://doc.rust-lang.org/book/ch19-03-advanced-traits.html#fully-qualified-syntax-for-disambiguation-calling-methods-with-the-same-name">完全限定语法</a> 调用：</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>my_arc = Arc::new(());
<span class="kw">let </span>my_weak = Arc::downgrade(<span class="kw-2">&amp;</span>my_arc);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+my_arc+=+Arc::new(());%0Alet+my_weak+=+Arc::downgrade(%26my_arc);%0A%7D&amp;edition=2021">Run</a></div>
<p><code>Arc&lt;T&gt;</code> 也可以使用完全限定语法来调用诸如 <code>Clone</code> 之类的 traits 实现。
有些人喜欢使用完全限定的语法，而另一些人则喜欢使用方法调用语法。</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>arc = Arc::new(());
<span class="comment">// 方法调用语法
</span><span class="kw">let </span>arc2 = arc.clone();
<span class="comment">// 完全限定的语法
</span><span class="kw">let </span>arc3 = Arc::clone(<span class="kw-2">&amp;</span>arc);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+arc+=+Arc::new(());%0A//+%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%E8%AF%AD%E6%B3%95%0Alet+arc2+=+arc.clone();%0A//+%E5%AE%8C%E5%85%A8%E9%99%90%E5%AE%9A%E7%9A%84%E8%AF%AD%E6%B3%95%0Alet+arc3+=+Arc::clone(%26arc);%0A%7D&amp;edition=2021">Run</a></div>
<p><a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak&lt;T&gt;</code></a> 不会自动解引用到 <code>T</code>，因为内部值可能已经被丢弃了。</p>
<h2 id="examples"><a href="#examples">Examples</a></h2>
<p>在线程之间共享一些不可变数据：</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;
<span class="kw">use </span>std::thread;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="kw">for _ in </span><span class="number">0</span>..<span class="number">10 </span>{
    <span class="kw">let </span>five = Arc::clone(<span class="kw-2">&amp;</span>five);

    thread::spawn(<span class="kw">move </span>|| {
        <span class="macro">println!</span>(<span class="string">&quot;{five:?}&quot;</span>);
    });
}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Ause+std::thread;%0A%0Alet+five+=+Arc::new(5);%0A%0Afor+_+in+0..10+%7B%0A++++let+five+=+Arc::clone(%26five);%0A%0A++++thread::spawn(move+%7C%7C+%7B%0A++++++++println!(%22%7Bfive:?%7D%22);%0A++++%7D);%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
<p>共享可变的 <a href="atomic/struct.AtomicUsize.html" title="sync::atomic::AtomicUsize"><code>AtomicUsize</code></a>：</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;
<span class="kw">use </span>std::sync::atomic::{AtomicUsize, Ordering};
<span class="kw">use </span>std::thread;

<span class="kw">let </span>val = Arc::new(AtomicUsize::new(<span class="number">5</span>));

<span class="kw">for _ in </span><span class="number">0</span>..<span class="number">10 </span>{
    <span class="kw">let </span>val = Arc::clone(<span class="kw-2">&amp;</span>val);

    thread::spawn(<span class="kw">move </span>|| {
        <span class="kw">let </span>v = val.fetch_add(<span class="number">1</span>, Ordering::SeqCst);
        <span class="macro">println!</span>(<span class="string">&quot;{v:?}&quot;</span>);
    });
}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Ause+std::sync::atomic::%7BAtomicUsize,+Ordering%7D;%0Ause+std::thread;%0A%0Alet+val+=+Arc::new(AtomicUsize::new(5));%0A%0Afor+_+in+0..10+%7B%0A++++let+val+=+Arc::clone(%26val);%0A%0A++++thread::spawn(move+%7C%7C+%7B%0A++++++++let+v+=+val.fetch_add(1,+Ordering::SeqCst);%0A++++++++println!(%22%7Bv:?%7D%22);%0A++++%7D);%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
<p>有关更多一般引用计数示例，请参见 <a href="../rc/index.html#examples" title="mod std::rc"><code>rc</code> 文档</a>。</p>
</div></details><h2 id="implementations" class="small-section-header">Implementations<a href="#implementations" class="anchor">§</a></h2><div id="implementations-list"><details class="toggle implementors-toggle" open><summary><section id="impl-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#353">source</a><a href="#impl-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.new" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#366">source</a><h4 class="code-header">pub fn <a href="#method.new" class="fn">new</a>(data: T) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h4></section></summary><div class="docblock"><p>创建一个新的 <code>Arc&lt;T&gt;</code>。</p>
<h5 id="examples-1"><a href="#examples-1">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.new_cyclic" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.60.0">1.60.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#431-433">source</a></span><h4 class="code-header">pub fn <a href="#method.new_cyclic" class="fn">new_cyclic</a>&lt;F&gt;(data_fn: F) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    F: <a class="trait" href="../ops/trait.FnOnce.html" title="trait std::ops::FnOnce">FnOnce</a>(&amp;<a class="struct" href="struct.Weak.html" title="struct std::sync::Weak">Weak</a>&lt;T&gt;) -&gt; T,</span></h4></section></summary><div class="docblock"><p>创建一个新的 <code>Arc&lt;T&gt;</code>，同时给您一个分配的 <code>Weak&lt;T&gt;</code>，以允许您创建一个 <code>T</code>，它持有一个指向自身的弱指针。</p>
<p>通常，直接或间接循环引用自身的结构体不应该对自身持有强引用以防止内存泄漏。
使用这个函数，您可以在 <code>T</code> 的初始化过程中，在 <code>Arc&lt;T&gt;</code> 创建之前访问弱指针，这样您就可以将它克隆并存储在 <code>T</code> 中。</p>
<p><code>new_cyclic</code> 先给 <code>Arc&lt;T&gt;</code> 分配托管分配，然后调用您的闭包，给这个分配一个 <code>Weak&lt;T&gt;</code>，然后再把您的闭包返回的 <code>T</code> 放入分配中，完成 <code>Arc&lt;T&gt;</code> 的构建。</p>
<p>由于新的 <code>Arc&lt;T&gt;</code> 在 <code>Arc&lt;T&gt;::new_cyclic</code> 返回之前尚未完全构造，因此在闭包内的弱引用上调用 <a href="struct.Weak.html#method.upgrade" title="method std::sync::Weak::upgrade"><code>upgrade</code></a> 将失败并导致 <code>None</code> 值。</p>
<h5 id="panics"><a href="#panics">Panics</a></h5>
<p>如果 <code>data_fn</code> 发生 panic，panic 会传播给调用者，而临时的 <a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak&lt;T&gt;</code></a> 会被正常丢弃。</p>
<h5 id="example"><a href="#example">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::{Arc, Weak};

<span class="kw">struct </span>Gadget {
    me: Weak&lt;Gadget&gt;,
}

<span class="kw">impl </span>Gadget {
    <span class="doccomment">/// 创建一个引用计数的 Gadget。
    </span><span class="kw">fn </span>new() -&gt; Arc&lt;<span class="self">Self</span>&gt; {
        <span class="comment">// `me` 是指向我们正在构建的 `Arc` 的新分配的 `Weak&lt;Gadget&gt;`。
        </span>Arc::new_cyclic(|me| {
            <span class="comment">// 在此处创建实际的结构体。
            </span>Gadget { me: me.clone() }
        })
    }

    <span class="doccomment">/// 返回一个指向 Self 的引用计数指针。
    </span><span class="kw">fn </span>me(<span class="kw-2">&amp;</span><span class="self">self</span>) -&gt; Arc&lt;<span class="self">Self</span>&gt; {
        <span class="self">self</span>.me.upgrade().unwrap()
    }
}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Ballow(dead_code)%5D%0Afn+main()+%7B%0Ause+std::sync::%7BArc,+Weak%7D;%0A%0Astruct+Gadget+%7B%0A++++me:+Weak%3CGadget%3E,%0A%7D%0A%0Aimpl+Gadget+%7B%0A++++///+%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%BC%95%E7%94%A8%E8%AE%A1%E6%95%B0%E7%9A%84+Gadget%E3%80%82%0A++++fn+new()+-%3E+Arc%3CSelf%3E+%7B%0A++++++++//+%60me%60+%E6%98%AF%E6%8C%87%E5%90%91%E6%88%91%E4%BB%AC%E6%AD%A3%E5%9C%A8%E6%9E%84%E5%BB%BA%E7%9A%84+%60Arc%60+%E7%9A%84%E6%96%B0%E5%88%86%E9%85%8D%E7%9A%84+%60Weak%3CGadget%3E%60%E3%80%82%0A++++++++Arc::new_cyclic(%7Cme%7C+%7B%0A++++++++++++//+%E5%9C%A8%E6%AD%A4%E5%A4%84%E5%88%9B%E5%BB%BA%E5%AE%9E%E9%99%85%E7%9A%84%E7%BB%93%E6%9E%84%E4%BD%93%E3%80%82%0A++++++++++++Gadget+%7B+me:+me.clone()+%7D%0A++++++++%7D)%0A++++%7D%0A%0A++++///+%E8%BF%94%E5%9B%9E%E4%B8%80%E4%B8%AA%E6%8C%87%E5%90%91+Self+%E7%9A%84%E5%BC%95%E7%94%A8%E8%AE%A1%E6%95%B0%E6%8C%87%E9%92%88%E3%80%82%0A++++fn+me(%26self)+-%3E+Arc%3CSelf%3E+%7B%0A++++++++self.me.upgrade().unwrap()%0A++++%7D%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.new_uninit" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#508">source</a><h4 class="code-header">pub fn <a href="#method.new_uninit" class="fn">new_uninit</a>() -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="union" href="../mem/union.MaybeUninit.html" title="union std::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;&gt;</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>new_uninit</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/63291">#63291</a>)</span></div></span></summary><div class="docblock"><p>创建一个具有未初始化内容的新 <code>Arc</code>。</p>
<h5 id="examples-2"><a href="#examples-2">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(new_uninit)]
#![feature(get_mut_unchecked)]

</span><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span><span class="kw-2">mut </span>five = Arc::&lt;u32&gt;::new_uninit();

<span class="comment">// 延迟初始化：
</span>Arc::get_mut(<span class="kw-2">&amp;mut </span>five).unwrap().write(<span class="number">5</span>);

<span class="kw">let </span>five = <span class="kw">unsafe </span>{ five.assume_init() };

<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>five, <span class="number">5</span>)</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(new_uninit)%5D%0A%23!%5Bfeature(get_mut_unchecked)%5D%0A%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+mut+five+=+Arc::%3Cu32%3E::new_uninit();%0A%0A//+%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%9A%0AArc::get_mut(%26mut+five).unwrap().write(5);%0A%0Alet+five+=+unsafe+%7B+five.assume_init()+%7D;%0A%0Aassert_eq!(*five,+5)%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.new_zeroed" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#542">source</a><h4 class="code-header">pub fn <a href="#method.new_zeroed" class="fn">new_zeroed</a>() -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="union" href="../mem/union.MaybeUninit.html" title="union std::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;&gt;</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>new_uninit</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/63291">#63291</a>)</span></div></span></summary><div class="docblock"><p>创建一个具有未初始化内容的新 <code>Arc</code>，并用 <code>0</code> 字节填充内存。</p>
<p>有关正确和不正确使用此方法的示例，请参见 <a href="../mem/union.MaybeUninit.html#method.zeroed" title="associated function std::mem::MaybeUninit::zeroed"><code>MaybeUninit::zeroed</code></a>。</p>
<h5 id="examples-3"><a href="#examples-3">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(new_uninit)]

</span><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>zero = Arc::&lt;u32&gt;::new_zeroed();
<span class="kw">let </span>zero = <span class="kw">unsafe </span>{ zero.assume_init() };

<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>zero, <span class="number">0</span>)</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(new_uninit)%5D%0A%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+zero+=+Arc::%3Cu32%3E::new_zeroed();%0Alet+zero+=+unsafe+%7B+zero.assume_init()+%7D;%0A%0Aassert_eq!(*zero,+0)%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.pin" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.33.0">1.33.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#557">source</a></span><h4 class="code-header">pub fn <a href="#method.pin" class="fn">pin</a>(data: T) -&gt; <a class="struct" href="../pin/struct.Pin.html" title="struct std::pin::Pin">Pin</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;&gt;</h4></section></summary><div class="docblock"><p>创建一个新的 <code>Pin&lt;Arc&lt;T&gt;&gt;</code>。
如果 <code>T</code> 未实现 <code>Unpin</code>，则 <code>data</code> 将被固定在内存中并且无法移动。</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.try_pin" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#564">source</a><h4 class="code-header">pub fn <a href="#method.try_pin" class="fn">try_pin</a>(data: T) -&gt; <a class="enum" href="../result/enum.Result.html" title="enum std::result::Result">Result</a>&lt;<a class="struct" href="../pin/struct.Pin.html" title="struct std::pin::Pin">Pin</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;&gt;, <a class="struct" href="../alloc/struct.AllocError.html" title="struct std::alloc::AllocError">AllocError</a>&gt;</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>allocator_api</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/32838">#32838</a>)</span></div></span></summary><div class="docblock"><p>创建一个新的 <code>Pin&lt;Arc&lt;T&gt;&gt;</code>，如果分配失败则返回错误。</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.try_new" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#581">source</a><h4 class="code-header">pub fn <a href="#method.try_new" class="fn">try_new</a>(data: T) -&gt; <a class="enum" href="../result/enum.Result.html" title="enum std::result::Result">Result</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;, <a class="struct" href="../alloc/struct.AllocError.html" title="struct std::alloc::AllocError">AllocError</a>&gt;</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>allocator_api</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/32838">#32838</a>)</span></div></span></summary><div class="docblock"><p>创建一个新的 <code>Arc&lt;T&gt;</code>，如果分配失败，则返回错误。</p>
<h5 id="examples-4"><a href="#examples-4">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(allocator_api)]
</span><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::try_new(<span class="number">5</span>)<span class="question-mark">?</span>;</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(allocator_api)%5D%0Afn+main()+%7B+fn+_inner()+-%3E+Result%3C(),+impl+core::fmt::Debug%3E+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::try_new(5)?;%0AOk::%3C(),+std::alloc::AllocError%3E(())%0A%7D+_inner().unwrap()+%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.try_new_uninit" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#615">source</a><h4 class="code-header">pub fn <a href="#method.try_new_uninit" class="fn">try_new_uninit</a>() -&gt; <a class="enum" href="../result/enum.Result.html" title="enum std::result::Result">Result</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="union" href="../mem/union.MaybeUninit.html" title="union std::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;&gt;, <a class="struct" href="../alloc/struct.AllocError.html" title="struct std::alloc::AllocError">AllocError</a>&gt;</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>allocator_api</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/32838">#32838</a>)</span></div></span></summary><div class="docblock"><p>构造具有未初始化内容的新 <code>Arc</code>，如果分配失败，则返回错误。</p>
<h5 id="examples-5"><a href="#examples-5">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(new_uninit, allocator_api)]
#![feature(get_mut_unchecked)]

</span><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span><span class="kw-2">mut </span>five = Arc::&lt;u32&gt;::try_new_uninit()<span class="question-mark">?</span>;

<span class="comment">// 延迟初始化：
</span>Arc::get_mut(<span class="kw-2">&amp;mut </span>five).unwrap().write(<span class="number">5</span>);

<span class="kw">let </span>five = <span class="kw">unsafe </span>{ five.assume_init() };

<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>five, <span class="number">5</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(new_uninit,+allocator_api)%5D%0A%23!%5Bfeature(get_mut_unchecked)%5D%0A%0Afn+main()+%7B+fn+_inner()+-%3E+Result%3C(),+impl+core::fmt::Debug%3E+%7B%0Ause+std::sync::Arc;%0A%0Alet+mut+five+=+Arc::%3Cu32%3E::try_new_uninit()?;%0A%0A//+%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%9A%0AArc::get_mut(%26mut+five).unwrap().write(5);%0A%0Alet+five+=+unsafe+%7B+five.assume_init()+%7D;%0A%0Aassert_eq!(*five,+5);%0AOk::%3C(),+std::alloc::AllocError%3E(())%0A%7D+_inner().unwrap()+%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.try_new_zeroed" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#648">source</a><h4 class="code-header">pub fn <a href="#method.try_new_zeroed" class="fn">try_new_zeroed</a>() -&gt; <a class="enum" href="../result/enum.Result.html" title="enum std::result::Result">Result</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="union" href="../mem/union.MaybeUninit.html" title="union std::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;&gt;, <a class="struct" href="../alloc/struct.AllocError.html" title="struct std::alloc::AllocError">AllocError</a>&gt;</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>allocator_api</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/32838">#32838</a>)</span></div></span></summary><div class="docblock"><p>创建一个具有未初始化内容的新 <code>Arc</code>，并用 <code>0</code> 字节填充内存，如果分配失败，则返回错误。</p>
<p>有关正确和不正确使用此方法的示例，请参见 <a href="../mem/union.MaybeUninit.html#method.zeroed" title="associated function std::mem::MaybeUninit::zeroed"><code>MaybeUninit::zeroed</code></a>。</p>
<h5 id="examples-6"><a href="#examples-6">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(new_uninit, allocator_api)]

</span><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>zero = Arc::&lt;u32&gt;::try_new_zeroed()<span class="question-mark">?</span>;
<span class="kw">let </span>zero = <span class="kw">unsafe </span>{ zero.assume_init() };

<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>zero, <span class="number">0</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(new_uninit,+allocator_api)%5D%0A%0Afn+main()+%7B+fn+_inner()+-%3E+Result%3C(),+impl+core::fmt::Debug%3E+%7B%0Ause+std::sync::Arc;%0A%0Alet+zero+=+Arc::%3Cu32%3E::try_new_zeroed()?;%0Alet+zero+=+unsafe+%7B+zero.assume_init()+%7D;%0A%0Aassert_eq!(*zero,+0);%0AOk::%3C(),+std::alloc::AllocError%3E(())%0A%7D+_inner().unwrap()+%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.try_unwrap" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.4.0">1.4.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#689">source</a></span><h4 class="code-header">pub fn <a href="#method.try_unwrap" class="fn">try_unwrap</a>(this: <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="enum" href="../result/enum.Result.html" title="enum std::result::Result">Result</a>&lt;T, <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;&gt;</h4></section></summary><div class="docblock"><p>如果 <code>Arc</code> 正好有一个强引用，则返回内部值。</p>
<p>否则，返回的 <a href="../result/enum.Result.html#variant.Err" title="variant std::result::Result::Err"><code>Err</code></a> 将与传入的 <code>Arc</code> 相同。</p>
<p>即使存在突出的弱引用，此操作也将成功。</p>
<p>如果您不想将 <code>Arc</code> 保留在 <a href="../result/enum.Result.html#variant.Err" title="variant std::result::Result::Err"><code>Err</code></a> 外壳中，强烈建议改用 <a href="struct.Arc.html#method.into_inner" title="associated function std::sync::Arc::into_inner"><code>Arc::into_inner</code></a>。
立即抛弃 <a href="../result/enum.Result.html#variant.Err" title="variant std::result::Result::Err"><code>Err</code></a> 有效，载荷，就像在表达式 <code>Arc::try_unwrap(this).ok()</code> 中一样，仍然可以导致强制使用计数抛弃为零，<code>Arc</code> 的内部值为抛弃:
例如，如果两个线程都在并行中执行这个表达式，那么就有一个竞争条件。
线程可以首先检查它们是否通过 <code>Arc::try_unwrap</code> 拥有它们的 <code>Arc</code> 的最后一个克隆，然后在调用中将它们的 <code>Arc</code> 丢弃到 <a href="../result/enum.Result.html#method.ok" title="method std::result::Result::ok"><code>ok</code></a>，将强引用计数从 2 降为零。</p>
<h5 id="examples-7"><a href="#examples-7">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>x = Arc::new(<span class="number">3</span>);
<span class="macro">assert_eq!</span>(Arc::try_unwrap(x), <span class="prelude-val">Ok</span>(<span class="number">3</span>));

<span class="kw">let </span>x = Arc::new(<span class="number">4</span>);
<span class="kw">let </span>_y = Arc::clone(<span class="kw-2">&amp;</span>x);
<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>Arc::try_unwrap(x).unwrap_err(), <span class="number">4</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+x+=+Arc::new(3);%0Aassert_eq!(Arc::try_unwrap(x),+Ok(3));%0A%0Alet+x+=+Arc::new(4);%0Alet+_y+=+Arc::clone(%26x);%0Aassert_eq!(*Arc::try_unwrap(x).unwrap_err(),+4);%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.into_inner" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.70.0">1.70.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#799">source</a></span><h4 class="code-header">pub fn <a href="#method.into_inner" class="fn">into_inner</a>(this: <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="enum" href="../option/enum.Option.html" title="enum std::option::Option">Option</a>&lt;T&gt;</h4></section></summary><div class="docblock"><p>如果 <code>Arc</code> 正好有一个强引用，则返回内部值。</p>
<p>否则，返回 <a href="../option/enum.Option.html#variant.None" title="variant std::option::Option::None"><code>None</code></a>，<code>Arc</code> 为丢弃。</p>
<p>即使存在突出的弱引用，此操作也将成功。</p>
<p>如果在这个 <code>Arc</code> 的每个克隆上调用 <code>Arc::into_inner</code>，则可以保证恰好有一个调用返回内部值。
这特别意味着内部值不是丢弃。</p>
<p>类似的表达式 <code>Arc::try_unwrap(this).ok()</code> 不提供这样的保证。
请参见下面的最后一个示例和 <a href="struct.Arc.html#method.try_unwrap" title="associated function std::sync::Arc::try_unwrap"><code>Arc::try_unwrap</code></a> 的文档。</p>
<h5 id="examples-8"><a href="#examples-8">Examples</a></h5>
<p>演示 <code>Arc::into_inner</code> 提供的保证的最小示例。</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>x = Arc::new(<span class="number">3</span>);
<span class="kw">let </span>y = Arc::clone(<span class="kw-2">&amp;</span>x);

<span class="comment">// 两个线程在 `Arc` 的两个克隆上调用 `Arc::into_inner`:
</span><span class="kw">let </span>x_thread = std::thread::spawn(|| Arc::into_inner(x));
<span class="kw">let </span>y_thread = std::thread::spawn(|| Arc::into_inner(y));

<span class="kw">let </span>x_inner_value = x_thread.join().unwrap();
<span class="kw">let </span>y_inner_value = y_thread.join().unwrap();

<span class="comment">// 其中一个线程保证接收到内部值:
</span><span class="macro">assert!</span>(<span class="macro">matches!</span>(
    (x_inner_value, y_inner_value),
    (<span class="prelude-val">None</span>, <span class="prelude-val">Some</span>(<span class="number">3</span>)) | (<span class="prelude-val">Some</span>(<span class="number">3</span>), <span class="prelude-val">None</span>)
));
<span class="comment">// 如果线程改为调用 `Arc::try_unwrap(x).ok()` 和 `Arc::try_unwrap(y).ok()`，结果也可能是 `(None, None)`。</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+x+=+Arc::new(3);%0Alet+y+=+Arc::clone(%26x);%0A%0A//+%E4%B8%A4%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%9C%A8+%60Arc%60+%E7%9A%84%E4%B8%A4%E4%B8%AA%E5%85%8B%E9%9A%86%E4%B8%8A%E8%B0%83%E7%94%A8+%60Arc::into_inner%60:%0Alet+x_thread+=+std::thread::spawn(%7C%7C+Arc::into_inner(x));%0Alet+y_thread+=+std::thread::spawn(%7C%7C+Arc::into_inner(y));%0A%0Alet+x_inner_value+=+x_thread.join().unwrap();%0Alet+y_inner_value+=+y_thread.join().unwrap();%0A%0A//+%E5%85%B6%E4%B8%AD%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E4%BF%9D%E8%AF%81%E6%8E%A5%E6%94%B6%E5%88%B0%E5%86%85%E9%83%A8%E5%80%BC:%0Aassert!(matches!(%0A++++(x_inner_value,+y_inner_value),%0A++++(None,+Some(3))+%7C+(Some(3),+None)%0A));%0A//+%E5%A6%82%E6%9E%9C%E7%BA%BF%E7%A8%8B%E6%94%B9%E4%B8%BA%E8%B0%83%E7%94%A8+%60Arc::try_unwrap(x).ok()%60+%E5%92%8C+%60Arc::try_unwrap(y).ok()%60%EF%BC%8C%E7%BB%93%E6%9E%9C%E4%B9%9F%E5%8F%AF%E8%83%BD%E6%98%AF+%60(None,+None)%60%E3%80%82%0A%7D&amp;edition=2021">Run</a></div>
<p>一个更实际的例子证明需要 <code>Arc::into_inner</code>:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="comment">// 使用 `Arc` 定义一个简单的单向链表:
</span><span class="attr">#[derive(Clone)]
</span><span class="kw">struct </span>LinkedList&lt;T&gt;(<span class="prelude-ty">Option</span>&lt;Arc&lt;Node&lt;T&gt;&gt;&gt;);
<span class="kw">struct </span>Node&lt;T&gt;(T, <span class="prelude-ty">Option</span>&lt;Arc&lt;Node&lt;T&gt;&gt;&gt;);

<span class="comment">// 丢掉依赖于 `Arc` 的析构函数的 long `LinkedList&lt;T&gt;` 会导致栈溢出。
// 为了防止这种情况，我们可以提供一个手动的 `Drop` 实现，它在循环中进行销毁:
</span><span class="kw">impl</span>&lt;T&gt; Drop <span class="kw">for </span>LinkedList&lt;T&gt; {
    <span class="kw">fn </span>drop(<span class="kw-2">&amp;mut </span><span class="self">self</span>) {
        <span class="kw">let </span><span class="kw-2">mut </span>link = <span class="self">self</span>.<span class="number">0</span>.take();
        <span class="kw">while let </span><span class="prelude-val">Some</span>(arc_node) = link.take() {
            <span class="kw">if let </span><span class="prelude-val">Some</span>(Node(_value, next)) = Arc::into_inner(arc_node) {
                link = next;
            }
        }
    }
}

<span class="comment">// 省略 `new` 和 `push` 的实现
</span><span class="kw">impl</span>&lt;T&gt; LinkedList&lt;T&gt; {
    <span class="comment">/* ... */
</span>}

<span class="comment">// 如果 `Drop` impl 使用的是 `Arc::try_unwrap(arc).ok()` 而不是 `Arc::into_inner(arc)`，则尽管手动 `Drop` impl，以下代码仍可能导致栈溢出。

// 创建一个长列表并克隆它
</span><span class="kw">let </span><span class="kw-2">mut </span>x = LinkedList::new();
<span class="kw">for </span>i <span class="kw">in </span><span class="number">0</span>..<span class="number">100000 </span>{
    x.push(i); <span class="comment">// 将 i 添加到 x 的前面
</span>}
<span class="kw">let </span>y = x.clone();

<span class="comment">// 丢弃并行中的克隆人
</span><span class="kw">let </span>x_thread = std::thread::spawn(|| drop(x));
<span class="kw">let </span>y_thread = std::thread::spawn(|| drop(y));
x_thread.join().unwrap();
y_thread.join().unwrap();</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0A//+%E4%BD%BF%E7%94%A8+%60Arc%60+%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E5%8D%95%E5%90%91%E9%93%BE%E8%A1%A8:%0A%23%5Bderive(Clone)%5D%0Astruct+LinkedList%3CT%3E(Option%3CArc%3CNode%3CT%3E%3E%3E);%0Astruct+Node%3CT%3E(T,+Option%3CArc%3CNode%3CT%3E%3E%3E);%0A%0A//+%E4%B8%A2%E6%8E%89%E4%BE%9D%E8%B5%96%E4%BA%8E+%60Arc%60+%E7%9A%84%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0%E7%9A%84+long+%60LinkedList%3CT%3E%60+%E4%BC%9A%E5%AF%BC%E8%87%B4%E6%A0%88%E6%BA%A2%E5%87%BA%E3%80%82%0A//+%E4%B8%BA%E4%BA%86%E9%98%B2%E6%AD%A2%E8%BF%99%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E6%8F%90%E4%BE%9B%E4%B8%80%E4%B8%AA%E6%89%8B%E5%8A%A8%E7%9A%84+%60Drop%60+%E5%AE%9E%E7%8E%B0%EF%BC%8C%E5%AE%83%E5%9C%A8%E5%BE%AA%E7%8E%AF%E4%B8%AD%E8%BF%9B%E8%A1%8C%E9%94%80%E6%AF%81:%0Aimpl%3CT%3E+Drop+for+LinkedList%3CT%3E+%7B%0A++++fn+drop(%26mut+self)+%7B%0A++++++++let+mut+link+=+self.0.take();%0A++++++++while+let+Some(arc_node)+=+link.take()+%7B%0A++++++++++++if+let+Some(Node(_value,+next))+=+Arc::into_inner(arc_node)+%7B%0A++++++++++++++++link+=+next;%0A++++++++++++%7D%0A++++++++%7D%0A++++%7D%0A%7D%0A%0A//+%E7%9C%81%E7%95%A5+%60new%60+%E5%92%8C+%60push%60+%E7%9A%84%E5%AE%9E%E7%8E%B0%0Aimpl%3CT%3E+LinkedList%3CT%3E+%7B%0A++++/*+...+*/%0A++fn+new()+-%3E+Self+%7B%0A++++++LinkedList(None)%0A++%7D%0A++fn+push(%26mut+self,+x:+T)+%7B%0A++++++self.0+=+Some(Arc::new(Node(x,+self.0.take())));%0A++%7D%0A%7D%0A%0A//+%E5%A6%82%E6%9E%9C+%60Drop%60+impl+%E4%BD%BF%E7%94%A8%E7%9A%84%E6%98%AF+%60Arc::try_unwrap(arc).ok()%60+%E8%80%8C%E4%B8%8D%E6%98%AF+%60Arc::into_inner(arc)%60%EF%BC%8C%E5%88%99%E5%B0%BD%E7%AE%A1%E6%89%8B%E5%8A%A8+%60Drop%60+impl%EF%BC%8C%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%E4%BB%8D%E5%8F%AF%E8%83%BD%E5%AF%BC%E8%87%B4%E6%A0%88%E6%BA%A2%E5%87%BA%E3%80%82%0A%0A//+%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E9%95%BF%E5%88%97%E8%A1%A8%E5%B9%B6%E5%85%8B%E9%9A%86%E5%AE%83%0Alet+mut+x+=+LinkedList::new();%0Afor+i+in+0..100000+%7B%0A++++x.push(i);+//+%E5%B0%86+i+%E6%B7%BB%E5%8A%A0%E5%88%B0+x+%E7%9A%84%E5%89%8D%E9%9D%A2%0A%7D%0Alet+y+=+x.clone();%0A%0A//+%E4%B8%A2%E5%BC%83%E5%B9%B6%E8%A1%8C%E4%B8%AD%E7%9A%84%E5%85%8B%E9%9A%86%E4%BA%BA%0Alet+x_thread+=+std::thread::spawn(%7C%7C+drop(x));%0Alet+y_thread+=+std::thread::spawn(%7C%7C+drop(y));%0Ax_thread.join().unwrap();%0Ay_thread.join().unwrap();%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Arc%3C%5BT%5D%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#825">source</a><a href="#impl-Arc%3C%5BT%5D%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.new_uninit_slice" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#852">source</a><h4 class="code-header">pub fn <a href="#method.new_uninit_slice" class="fn">new_uninit_slice</a>(len: <a class="primitive" href="../primitive.usize.html">usize</a>) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;[<a class="union" href="../mem/union.MaybeUninit.html" title="union std::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;]&gt;</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>new_uninit</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/63291">#63291</a>)</span></div></span></summary><div class="docblock"><p>创建一个具有未初始化内容的新原子引用计数切片。</p>
<h5 id="examples-9"><a href="#examples-9">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(new_uninit)]
#![feature(get_mut_unchecked)]

</span><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span><span class="kw-2">mut </span>values = Arc::&lt;[u32]&gt;::new_uninit_slice(<span class="number">3</span>);

<span class="comment">// 延迟初始化：
</span><span class="kw">let </span>data = Arc::get_mut(<span class="kw-2">&amp;mut </span>values).unwrap();
data[<span class="number">0</span>].write(<span class="number">1</span>);
data[<span class="number">1</span>].write(<span class="number">2</span>);
data[<span class="number">2</span>].write(<span class="number">3</span>);

<span class="kw">let </span>values = <span class="kw">unsafe </span>{ values.assume_init() };

<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>values, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(new_uninit)%5D%0A%23!%5Bfeature(get_mut_unchecked)%5D%0A%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+mut+values+=+Arc::%3C%5Bu32%5D%3E::new_uninit_slice(3);%0A%0A//+%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%9A%0Alet+data+=+Arc::get_mut(%26mut+values).unwrap();%0Adata%5B0%5D.write(1);%0Adata%5B1%5D.write(2);%0Adata%5B2%5D.write(3);%0A%0Alet+values+=+unsafe+%7B+values.assume_init()+%7D;%0A%0Aassert_eq!(*values,+%5B1,+2,+3%5D)%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.new_zeroed_slice" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#880">source</a><h4 class="code-header">pub fn <a href="#method.new_zeroed_slice" class="fn">new_zeroed_slice</a>(len: <a class="primitive" href="../primitive.usize.html">usize</a>) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;[<a class="union" href="../mem/union.MaybeUninit.html" title="union std::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;]&gt;</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>new_uninit</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/63291">#63291</a>)</span></div></span></summary><div class="docblock"><p>创建一个具有未初始化内容的新原子引用计数切片，内存中填充 <code>0</code> 字节。</p>
<p>有关正确和不正确使用此方法的示例，请参见 <a href="../mem/union.MaybeUninit.html#method.zeroed" title="associated function std::mem::MaybeUninit::zeroed"><code>MaybeUninit::zeroed</code></a>。</p>
<h5 id="examples-10"><a href="#examples-10">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(new_uninit)]

</span><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>values = Arc::&lt;[u32]&gt;::new_zeroed_slice(<span class="number">3</span>);
<span class="kw">let </span>values = <span class="kw">unsafe </span>{ values.assume_init() };

<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>values, [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>])</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(new_uninit)%5D%0A%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+values+=+Arc::%3C%5Bu32%5D%3E::new_zeroed_slice(3);%0Alet+values+=+unsafe+%7B+values.assume_init()+%7D;%0A%0Aassert_eq!(*values,+%5B0,+0,+0%5D)%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Arc%3CMaybeUninit%3CT%3E%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#894">source</a><a href="#impl-Arc%3CMaybeUninit%3CT%3E%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="union" href="../mem/union.MaybeUninit.html" title="union std::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.assume_init" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#927">source</a><h4 class="code-header">pub unsafe fn <a href="#method.assume_init" class="fn">assume_init</a>(self) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>new_uninit</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/63291">#63291</a>)</span></div></span></summary><div class="docblock"><p>转换为 <code>Arc&lt;T&gt;</code>。</p>
<h5 id="safety"><a href="#safety">Safety</a></h5>
<p>与 <a href="../mem/union.MaybeUninit.html#method.assume_init" title="method std::mem::MaybeUninit::assume_init"><code>MaybeUninit::assume_init</code></a> 一样，由调用者负责确保内部值确实处于初始化状态。</p>
<p>在内容尚未完全初始化时调用此方法会立即导致未定义的行为。</p>
<h5 id="examples-11"><a href="#examples-11">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(new_uninit)]
#![feature(get_mut_unchecked)]

</span><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span><span class="kw-2">mut </span>five = Arc::&lt;u32&gt;::new_uninit();

<span class="comment">// 延迟初始化：
</span>Arc::get_mut(<span class="kw-2">&amp;mut </span>five).unwrap().write(<span class="number">5</span>);

<span class="kw">let </span>five = <span class="kw">unsafe </span>{ five.assume_init() };

<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>five, <span class="number">5</span>)</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(new_uninit)%5D%0A%23!%5Bfeature(get_mut_unchecked)%5D%0A%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+mut+five+=+Arc::%3Cu32%3E::new_uninit();%0A%0A//+%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%9A%0AArc::get_mut(%26mut+five).unwrap().write(5);%0A%0Alet+five+=+unsafe+%7B+five.assume_init()+%7D;%0A%0Aassert_eq!(*five,+5)%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Arc%3C%5BMaybeUninit%3CT%3E%5D%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#932">source</a><a href="#impl-Arc%3C%5BMaybeUninit%3CT%3E%5D%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;[<a class="union" href="../mem/union.MaybeUninit.html" title="union std::mem::MaybeUninit">MaybeUninit</a>&lt;T&gt;]&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.assume_init-1" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#968">source</a><h4 class="code-header">pub unsafe fn <a href="#method.assume_init-1" class="fn">assume_init</a>(self) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt;</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>new_uninit</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/63291">#63291</a>)</span></div></span></summary><div class="docblock"><p>转换为 <code>Arc&lt;[T]&gt;</code>。</p>
<h5 id="safety-1"><a href="#safety-1">Safety</a></h5>
<p>与 <a href="../mem/union.MaybeUninit.html#method.assume_init" title="method std::mem::MaybeUninit::assume_init"><code>MaybeUninit::assume_init</code></a> 一样，由调用者负责确保内部值确实处于初始化状态。</p>
<p>在内容尚未完全初始化时调用此方法会立即导致未定义的行为。</p>
<h5 id="examples-12"><a href="#examples-12">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(new_uninit)]
#![feature(get_mut_unchecked)]

</span><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span><span class="kw-2">mut </span>values = Arc::&lt;[u32]&gt;::new_uninit_slice(<span class="number">3</span>);

<span class="comment">// 延迟初始化：
</span><span class="kw">let </span>data = Arc::get_mut(<span class="kw-2">&amp;mut </span>values).unwrap();
data[<span class="number">0</span>].write(<span class="number">1</span>);
data[<span class="number">1</span>].write(<span class="number">2</span>);
data[<span class="number">2</span>].write(<span class="number">3</span>);

<span class="kw">let </span>values = <span class="kw">unsafe </span>{ values.assume_init() };

<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>values, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(new_uninit)%5D%0A%23!%5Bfeature(get_mut_unchecked)%5D%0A%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+mut+values+=+Arc::%3C%5Bu32%5D%3E::new_uninit_slice(3);%0A%0A//+%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%9A%0Alet+data+=+Arc::get_mut(%26mut+values).unwrap();%0Adata%5B0%5D.write(1);%0Adata%5B1%5D.write(2);%0Adata%5B2%5D.write(3);%0A%0Alet+values+=+unsafe+%7B+values.assume_init()+%7D;%0A%0Aassert_eq!(*values,+%5B1,+2,+3%5D)%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Arc%3CT%3E-1" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#973">source</a><a href="#impl-Arc%3CT%3E-1" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.into_raw" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.17.0">1.17.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#990">source</a></span><h4 class="code-header">pub fn <a href="#method.into_raw" class="fn">into_raw</a>(this: <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.pointer.html">*const T</a></h4></section></summary><div class="docblock"><p>消耗 <code>Arc</code>，返回包装的指针。</p>
<p>为避免内存泄漏，必须使用 <a href="struct.Arc.html#method.from_raw" title="associated function std::sync::Arc::from_raw"><code>Arc::from_raw</code></a> 将指针转换回 <code>Arc</code>。</p>
<h5 id="examples-13"><a href="#examples-13">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>x = Arc::new(<span class="string">&quot;hello&quot;</span>.to_owned());
<span class="kw">let </span>x_ptr = Arc::into_raw(x);
<span class="macro">assert_eq!</span>(<span class="kw">unsafe </span>{ <span class="kw-2">&amp;*</span>x_ptr }, <span class="string">&quot;hello&quot;</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+x+=+Arc::new(%22hello%22.to_owned());%0Alet+x_ptr+=+Arc::into_raw(x);%0Aassert_eq!(unsafe+%7B+%26*x_ptr+%7D,+%22hello%22);%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.as_ptr" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.45.0">1.45.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#1014">source</a></span><h4 class="code-header">pub fn <a href="#method.as_ptr" class="fn">as_ptr</a>(this: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.pointer.html">*const T</a></h4></section></summary><div class="docblock"><p>为数据提供裸指针。</p>
<p>计数不会受到任何影响，并且不会消耗 <code>Arc</code>。
只要 <code>Arc</code> 中有大量计数，指针就有效。</p>
<h5 id="examples-14"><a href="#examples-14">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>x = Arc::new(<span class="string">&quot;hello&quot;</span>.to_owned());
<span class="kw">let </span>y = Arc::clone(<span class="kw-2">&amp;</span>x);
<span class="kw">let </span>x_ptr = Arc::as_ptr(<span class="kw-2">&amp;</span>x);
<span class="macro">assert_eq!</span>(x_ptr, Arc::as_ptr(<span class="kw-2">&amp;</span>y));
<span class="macro">assert_eq!</span>(<span class="kw">unsafe </span>{ <span class="kw-2">&amp;*</span>x_ptr }, <span class="string">&quot;hello&quot;</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+x+=+Arc::new(%22hello%22.to_owned());%0Alet+y+=+Arc::clone(%26x);%0Alet+x_ptr+=+Arc::as_ptr(%26x);%0Aassert_eq!(x_ptr,+Arc::as_ptr(%26y));%0Aassert_eq!(unsafe+%7B+%26*x_ptr+%7D,+%22hello%22);%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.from_raw" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.17.0">1.17.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#1061">source</a></span><h4 class="code-header">pub unsafe fn <a href="#method.from_raw" class="fn">from_raw</a>(ptr: <a class="primitive" href="../primitive.pointer.html">*const T</a>) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h4></section></summary><div class="docblock"><p>从裸指针构造 <code>Arc&lt;T&gt;</code>。</p>
<p>裸指针必须事先由调用返回到 <a href="struct.Arc.html#method.into_raw" title="associated function std::sync::Arc::into_raw"><code>Arc&lt;U&gt;::into_raw</code></a>，其中 <code>U</code> 的大小和对齐方式必须与 <code>T</code> 相同。
如果 <code>U</code> 是 <code>T</code>，这是很简单的。
请注意，如果 <code>U</code> 不是 <code>T</code>，但是具有相同的大小和对齐方式，则基本上就像对不同类型的引用进行转换一样。
有关在这种情况下适用的限制的更多信息，请参见 <a href="../mem/fn.transmute.html" title="fn std::mem::transmute"><code>mem::transmute</code></a>。</p>
<p><code>from_raw</code> 的用户必须确保 <code>T</code> 的特定值仅被丢弃一次。</p>
<p>此函数不安全，因为使用不当可能会导致内存不安全，即使从未访问返回的 <code>Arc&lt;T&gt;</code> 也是如此。</p>
<h5 id="examples-15"><a href="#examples-15">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>x = Arc::new(<span class="string">&quot;hello&quot;</span>.to_owned());
<span class="kw">let </span>x_ptr = Arc::into_raw(x);

<span class="kw">unsafe </span>{
    <span class="comment">// 转换回 `Arc` 以防止泄漏。
    </span><span class="kw">let </span>x = Arc::from_raw(x_ptr);
    <span class="macro">assert_eq!</span>(<span class="kw-2">&amp;*</span>x, <span class="string">&quot;hello&quot;</span>);

    <span class="comment">// 进一步调用 `Arc::from_raw(x_ptr)` 将导致内存不安全。
</span>}

<span class="comment">// 当 `x` 超出上面的作用域时，其内存将被释放，所以 `x_ptr` 现在悬垂了！</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+x+=+Arc::new(%22hello%22.to_owned());%0Alet+x_ptr+=+Arc::into_raw(x);%0A%0Aunsafe+%7B%0A++++//+%E8%BD%AC%E6%8D%A2%E5%9B%9E+%60Arc%60+%E4%BB%A5%E9%98%B2%E6%AD%A2%E6%B3%84%E6%BC%8F%E3%80%82%0A++++let+x+=+Arc::from_raw(x_ptr);%0A++++assert_eq!(%26*x,+%22hello%22);%0A%0A++++//+%E8%BF%9B%E4%B8%80%E6%AD%A5%E8%B0%83%E7%94%A8+%60Arc::from_raw(x_ptr)%60+%E5%B0%86%E5%AF%BC%E8%87%B4%E5%86%85%E5%AD%98%E4%B8%8D%E5%AE%89%E5%85%A8%E3%80%82%0A%7D%0A%0A//+%E5%BD%93+%60x%60+%E8%B6%85%E5%87%BA%E4%B8%8A%E9%9D%A2%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%97%B6%EF%BC%8C%E5%85%B6%E5%86%85%E5%AD%98%E5%B0%86%E8%A2%AB%E9%87%8A%E6%94%BE%EF%BC%8C%E6%89%80%E4%BB%A5+%60x_ptr%60+%E7%8E%B0%E5%9C%A8%E6%82%AC%E5%9E%82%E4%BA%86%EF%BC%81%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.downgrade" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.4.0">1.4.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#1086">source</a></span><h4 class="code-header">pub fn <a href="#method.downgrade" class="fn">downgrade</a>(this: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="struct" href="struct.Weak.html" title="struct std::sync::Weak">Weak</a>&lt;T&gt;</h4></section></summary><div class="docblock"><p>创建一个指向该分配的新 <a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a> 指针。</p>
<h5 id="examples-16"><a href="#examples-16">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="kw">let </span>weak_five = Arc::downgrade(<span class="kw-2">&amp;</span>five);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0A%0Alet+weak_five+=+Arc::downgrade(%26five);%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.weak_count" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.15.0">1.15.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#1143">source</a></span><h4 class="code-header">pub fn <a href="#method.weak_count" class="fn">weak_count</a>(this: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.usize.html">usize</a></h4></section></summary><div class="docblock"><p>获取指向该分配的 <a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a> 指针的数量。</p>
<h5 id="safety-2"><a href="#safety-2">Safety</a></h5>
<p>此方法本身是安全的，但正确使用它需要格外小心。
另一个线程可以随时更改弱引用计数，包括潜在地在调用此方法与对结果进行操作之间。</p>
<h5 id="examples-17"><a href="#examples-17">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);
<span class="kw">let </span>_weak_five = Arc::downgrade(<span class="kw-2">&amp;</span>five);

<span class="comment">// 此断言是确定性的，因为我们尚未在线程之间共享 `Arc` 或 `Weak`。
</span><span class="macro">assert_eq!</span>(<span class="number">1</span>, Arc::weak_count(<span class="kw-2">&amp;</span>five));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0Alet+_weak_five+=+Arc::downgrade(%26five);%0A%0A//+%E6%AD%A4%E6%96%AD%E8%A8%80%E6%98%AF%E7%A1%AE%E5%AE%9A%E6%80%A7%E7%9A%84%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%88%91%E4%BB%AC%E5%B0%9A%E6%9C%AA%E5%9C%A8%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%AB+%60Arc%60+%E6%88%96+%60Weak%60%E3%80%82%0Aassert_eq!(1,+Arc::weak_count(%26five));%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.strong_count" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.15.0">1.15.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#1173">source</a></span><h4 class="code-header">pub fn <a href="#method.strong_count" class="fn">strong_count</a>(this: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.usize.html">usize</a></h4></section></summary><div class="docblock"><p>获取指向此分配的强 (<code>Arc</code>) 指针的数量。</p>
<h5 id="safety-3"><a href="#safety-3">Safety</a></h5>
<p>此方法本身是安全的，但正确使用它需要格外小心。
另一个线程可以随时更改强引用计数，包括潜在地在调用此方法与对结果进行操作之间。</p>
<h5 id="examples-18"><a href="#examples-18">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);
<span class="kw">let </span>_also_five = Arc::clone(<span class="kw-2">&amp;</span>five);

<span class="comment">// 此断言是确定性的，因为我们尚未在线程之间共享 `Arc`。
</span><span class="macro">assert_eq!</span>(<span class="number">2</span>, Arc::strong_count(<span class="kw-2">&amp;</span>five));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0Alet+_also_five+=+Arc::clone(%26five);%0A%0A//+%E6%AD%A4%E6%96%AD%E8%A8%80%E6%98%AF%E7%A1%AE%E5%AE%9A%E6%80%A7%E7%9A%84%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%88%91%E4%BB%AC%E5%B0%9A%E6%9C%AA%E5%9C%A8%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%AB+%60Arc%60%E3%80%82%0Aassert_eq!(2,+Arc::strong_count(%26five));%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.increment_strong_count" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.51.0">1.51.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#1205">source</a></span><h4 class="code-header">pub unsafe fn <a href="#method.increment_strong_count" class="fn">increment_strong_count</a>(ptr: <a class="primitive" href="../primitive.pointer.html">*const T</a>)</h4></section></summary><div class="docblock"><p>与提供的指针关联的 <code>Arc&lt;T&gt;</code> 上的强引用计数加 1。</p>
<h5 id="safety-4"><a href="#safety-4">Safety</a></h5>
<p>指针必须已经通过 <code>Arc::into_raw</code> 获得，并且关联的 <code>Arc</code> 实例必须有效 (即
在此方法的持续时间内，强引用计数必须至少为 1)。</p>
<h5 id="examples-19"><a href="#examples-19">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="kw">unsafe </span>{
    <span class="kw">let </span>ptr = Arc::into_raw(five);
    Arc::increment_strong_count(ptr);

    <span class="comment">// 此断言是确定性的，因为我们尚未在线程之间共享 `Arc`。
    </span><span class="kw">let </span>five = Arc::from_raw(ptr);
    <span class="macro">assert_eq!</span>(<span class="number">2</span>, Arc::strong_count(<span class="kw-2">&amp;</span>five));
}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0A%0Aunsafe+%7B%0A++++let+ptr+=+Arc::into_raw(five);%0A++++Arc::increment_strong_count(ptr);%0A%0A++++//+%E6%AD%A4%E6%96%AD%E8%A8%80%E6%98%AF%E7%A1%AE%E5%AE%9A%E6%80%A7%E7%9A%84%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%88%91%E4%BB%AC%E5%B0%9A%E6%9C%AA%E5%9C%A8%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%AB+%60Arc%60%E3%80%82%0A++++let+five+=+Arc::from_raw(ptr);%0A++++assert_eq!(2,+Arc::strong_count(%26five));%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.decrement_strong_count" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.51.0">1.51.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#1244">source</a></span><h4 class="code-header">pub unsafe fn <a href="#method.decrement_strong_count" class="fn">decrement_strong_count</a>(ptr: <a class="primitive" href="../primitive.pointer.html">*const T</a>)</h4></section></summary><div class="docblock"><p>将与提供的指针关联的 <code>Arc&lt;T&gt;</code> 上的强引用计数减 1。</p>
<h5 id="safety-5"><a href="#safety-5">Safety</a></h5>
<p>指针必须已经通过 <code>Arc::into_raw</code> 获得，并且关联的 <code>Arc</code> 实例必须有效 (即
调用此方法时，强引用计数必须至少为 1)。
此方法可用于释放最终的 <code>Arc</code> 和后备存储，但不应在最终的 <code>Arc</code> 释放后调用。</p>
<h5 id="examples-20"><a href="#examples-20">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="kw">unsafe </span>{
    <span class="kw">let </span>ptr = Arc::into_raw(five);
    Arc::increment_strong_count(ptr);

    <span class="comment">// 这些断言是确定性的，因为我们尚未在线程之间共享 `Arc`。
    </span><span class="kw">let </span>five = Arc::from_raw(ptr);
    <span class="macro">assert_eq!</span>(<span class="number">2</span>, Arc::strong_count(<span class="kw-2">&amp;</span>five));
    Arc::decrement_strong_count(ptr);
    <span class="macro">assert_eq!</span>(<span class="number">1</span>, Arc::strong_count(<span class="kw-2">&amp;</span>five));
}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0A%0Aunsafe+%7B%0A++++let+ptr+=+Arc::into_raw(five);%0A++++Arc::increment_strong_count(ptr);%0A%0A++++//+%E8%BF%99%E4%BA%9B%E6%96%AD%E8%A8%80%E6%98%AF%E7%A1%AE%E5%AE%9A%E6%80%A7%E7%9A%84%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%88%91%E4%BB%AC%E5%B0%9A%E6%9C%AA%E5%9C%A8%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%AB+%60Arc%60%E3%80%82%0A++++let+five+=+Arc::from_raw(ptr);%0A++++assert_eq!(2,+Arc::strong_count(%26five));%0A++++Arc::decrement_strong_count(ptr);%0A++++assert_eq!(1,+Arc::strong_count(%26five));%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.ptr_eq" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.17.0">1.17.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#1289">source</a></span><h4 class="code-header">pub fn <a href="#method.ptr_eq" class="fn">ptr_eq</a>(this: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;, other: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>如果两个 <code>Arc</code> 以类似于 <a href="../ptr/fn.eq.html" title="ptr::eq"><code>ptr::eq</code></a> 的方式指向相同的分配，则返回 <code>true</code>。
比较 <code>dyn Trait</code> 指针时的注意事项，请参见 <a href="../ptr/fn.eq.html" title="ptr::eq">that function</a>。</p>
<h5 id="examples-21"><a href="#examples-21">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);
<span class="kw">let </span>same_five = Arc::clone(<span class="kw-2">&amp;</span>five);
<span class="kw">let </span>other_five = Arc::new(<span class="number">5</span>);

<span class="macro">assert!</span>(Arc::ptr_eq(<span class="kw-2">&amp;</span>five, <span class="kw-2">&amp;</span>same_five));
<span class="macro">assert!</span>(!Arc::ptr_eq(<span class="kw-2">&amp;</span>five, <span class="kw-2">&amp;</span>other_five));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0Alet+same_five+=+Arc::clone(%26five);%0Alet+other_five+=+Arc::new(5);%0A%0Aassert!(Arc::ptr_eq(%26five,+%26same_five));%0Aassert!(!Arc::ptr_eq(%26five,+%26other_five));%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Arc%3CT%3E-2" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#1552">source</a><a href="#impl-Arc%3CT%3E-2" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../clone/trait.Clone.html" title="trait std::clone::Clone">Clone</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.make_mut" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.4.0">1.4.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#1606">source</a></span><h4 class="code-header">pub fn <a href="#method.make_mut" class="fn">make_mut</a>(this: &amp;mut <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.reference.html">&amp;mut T</a></h4></section></summary><div class="docblock"><p>对给定的 <code>Arc</code> 进行可变引用。</p>
<p>如果有其他 <code>Arc</code> 指针指向同一分配，则 <code>make_mut</code> 会将内部值 <a href="../clone/trait.Clone.html#tymethod.clone" title="method std::clone::Clone::clone"><code>clone</code></a> 到新分配以确保唯一的所有权。
这也称为写时克隆。</p>
<p>但是，如果没有其他 <code>Arc</code> 指针指向这个分配，而是一些 <a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a> 指针，那么 <a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a> 指针将被分离，内部值不会被克隆。</p>
<p>另请参见 <a href="struct.Arc.html#method.get_mut" title="associated function std::sync::Arc::get_mut"><code>get_mut</code></a>，它将失败而不是克隆内部值或分离 <a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a> 指针。</p>
<h5 id="examples-22"><a href="#examples-22">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span><span class="kw-2">mut </span>data = Arc::new(<span class="number">5</span>);

<span class="kw-2">*</span>Arc::make_mut(<span class="kw-2">&amp;mut </span>data) += <span class="number">1</span>;         <span class="comment">// 不会克隆任何东西
</span><span class="kw">let </span><span class="kw-2">mut </span>other_data = Arc::clone(<span class="kw-2">&amp;</span>data); <span class="comment">// 不会克隆内部数据
</span><span class="kw-2">*</span>Arc::make_mut(<span class="kw-2">&amp;mut </span>data) += <span class="number">1</span>;         <span class="comment">// 克隆内部数据
</span><span class="kw-2">*</span>Arc::make_mut(<span class="kw-2">&amp;mut </span>data) += <span class="number">1</span>;         <span class="comment">// 不会克隆任何东西
</span><span class="kw-2">*</span>Arc::make_mut(<span class="kw-2">&amp;mut </span>other_data) <span class="kw-2">*</span>= <span class="number">2</span>;   <span class="comment">// 不会克隆任何东西

// 现在，`data` 和 `other_data` 指向不同的分配。
</span><span class="macro">assert_eq!</span>(<span class="kw-2">*</span>data, <span class="number">8</span>);
<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>other_data, <span class="number">12</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+mut+data+=+Arc::new(5);%0A%0A*Arc::make_mut(%26mut+data)+%2B=+1;+++++++++//+%E4%B8%8D%E4%BC%9A%E5%85%8B%E9%9A%86%E4%BB%BB%E4%BD%95%E4%B8%9C%E8%A5%BF%0Alet+mut+other_data+=+Arc::clone(%26data);+//+%E4%B8%8D%E4%BC%9A%E5%85%8B%E9%9A%86%E5%86%85%E9%83%A8%E6%95%B0%E6%8D%AE%0A*Arc::make_mut(%26mut+data)+%2B=+1;+++++++++//+%E5%85%8B%E9%9A%86%E5%86%85%E9%83%A8%E6%95%B0%E6%8D%AE%0A*Arc::make_mut(%26mut+data)+%2B=+1;+++++++++//+%E4%B8%8D%E4%BC%9A%E5%85%8B%E9%9A%86%E4%BB%BB%E4%BD%95%E4%B8%9C%E8%A5%BF%0A*Arc::make_mut(%26mut+other_data)+*=+2;+++//+%E4%B8%8D%E4%BC%9A%E5%85%8B%E9%9A%86%E4%BB%BB%E4%BD%95%E4%B8%9C%E8%A5%BF%0A%0A//+%E7%8E%B0%E5%9C%A8%EF%BC%8C%60data%60+%E5%92%8C+%60other_data%60+%E6%8C%87%E5%90%91%E4%B8%8D%E5%90%8C%E7%9A%84%E5%88%86%E9%85%8D%E3%80%82%0Aassert_eq!(*data,+8);%0Aassert_eq!(*other_data,+12);%0A%7D&amp;edition=2021">Run</a></div>
<p><a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a> 指针将被分离:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span><span class="kw-2">mut </span>data = Arc::new(<span class="number">75</span>);
<span class="kw">let </span>weak = Arc::downgrade(<span class="kw-2">&amp;</span>data);

<span class="macro">assert!</span>(<span class="number">75 </span>== <span class="kw-2">*</span>data);
<span class="macro">assert!</span>(<span class="number">75 </span>== <span class="kw-2">*</span>weak.upgrade().unwrap());

<span class="kw-2">*</span>Arc::make_mut(<span class="kw-2">&amp;mut </span>data) += <span class="number">1</span>;

<span class="macro">assert!</span>(<span class="number">76 </span>== <span class="kw-2">*</span>data);
<span class="macro">assert!</span>(weak.upgrade().is_none());</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+mut+data+=+Arc::new(75);%0Alet+weak+=+Arc::downgrade(%26data);%0A%0Aassert!(75+==+*data);%0Aassert!(75+==+*weak.upgrade().unwrap());%0A%0A*Arc::make_mut(%26mut+data)+%2B=+1;%0A%0Aassert!(76+==+*data);%0Aassert!(weak.upgrade().is_none());%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.unwrap_or_clone" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#1690">source</a><h4 class="code-header">pub fn <a href="#method.unwrap_or_clone" class="fn">unwrap_or_clone</a>(this: <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; T</h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>arc_unwrap_or_clone</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/93610">#93610</a>)</span></div></span></summary><div class="docblock"><p>如果我们有 <code>T</code> 的唯一引用，那就打开它。否则，克隆 <code>T</code> 并返回克隆。</p>
<p>假设 <code>arc_t</code> 是 <code>Arc&lt;T&gt;</code> 类型，这个函数在功能上等同于 <code>(*arc_t).clone()</code>，但会尽可能避免克隆内部值。</p>
<h5 id="examples-23"><a href="#examples-23">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(arc_unwrap_or_clone)]
</span><span class="kw">let </span>inner = String::from(<span class="string">&quot;test&quot;</span>);
<span class="kw">let </span>ptr = inner.as_ptr();

<span class="kw">let </span>arc = Arc::new(inner);
<span class="kw">let </span>inner = Arc::unwrap_or_clone(arc);
<span class="comment">// 内部值没有被克隆
</span><span class="macro">assert!</span>(ptr::eq(ptr, inner.as_ptr()));

<span class="kw">let </span>arc = Arc::new(inner);
<span class="kw">let </span>arc2 = arc.clone();
<span class="kw">let </span>inner = Arc::unwrap_or_clone(arc);
<span class="comment">// 因为有两个引用，我们不得不克隆内部值。
</span><span class="macro">assert!</span>(!ptr::eq(ptr, inner.as_ptr()));
<span class="comment">// `arc2` 是最后一个引用，所以当我们展开它时，我们会得到原来的 `String`。
</span><span class="kw">let </span>inner = Arc::unwrap_or_clone(arc2);
<span class="macro">assert!</span>(ptr::eq(ptr, inner.as_ptr()));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(arc_unwrap_or_clone)%5D%0Afn+main()+%7B%0Ause+std::%7Bptr,+sync::Arc%7D;%0Alet+inner+=+String::from(%22test%22);%0Alet+ptr+=+inner.as_ptr();%0A%0Alet+arc+=+Arc::new(inner);%0Alet+inner+=+Arc::unwrap_or_clone(arc);%0A//+%E5%86%85%E9%83%A8%E5%80%BC%E6%B2%A1%E6%9C%89%E8%A2%AB%E5%85%8B%E9%9A%86%0Aassert!(ptr::eq(ptr,+inner.as_ptr()));%0A%0Alet+arc+=+Arc::new(inner);%0Alet+arc2+=+arc.clone();%0Alet+inner+=+Arc::unwrap_or_clone(arc);%0A//+%E5%9B%A0%E4%B8%BA%E6%9C%89%E4%B8%A4%E4%B8%AA%E5%BC%95%E7%94%A8%EF%BC%8C%E6%88%91%E4%BB%AC%E4%B8%8D%E5%BE%97%E4%B8%8D%E5%85%8B%E9%9A%86%E5%86%85%E9%83%A8%E5%80%BC%E3%80%82%0Aassert!(!ptr::eq(ptr,+inner.as_ptr()));%0A//+%60arc2%60+%E6%98%AF%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E5%BC%95%E7%94%A8%EF%BC%8C%E6%89%80%E4%BB%A5%E5%BD%93%E6%88%91%E4%BB%AC%E5%B1%95%E5%BC%80%E5%AE%83%E6%97%B6%EF%BC%8C%E6%88%91%E4%BB%AC%E4%BC%9A%E5%BE%97%E5%88%B0%E5%8E%9F%E6%9D%A5%E7%9A%84+%60String%60%E3%80%82%0Alet+inner+=+Arc::unwrap_or_clone(arc2);%0Aassert!(ptr::eq(ptr,+inner.as_ptr()));%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Arc%3CT%3E-3" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#1695">source</a><a href="#impl-Arc%3CT%3E-3" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.get_mut" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.4.0">1.4.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#1722">source</a></span><h4 class="code-header">pub fn <a href="#method.get_mut" class="fn">get_mut</a>(this: &amp;mut <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="enum" href="../option/enum.Option.html" title="enum std::option::Option">Option</a>&lt;<a class="primitive" href="../primitive.reference.html">&amp;mut T</a>&gt;</h4></section></summary><div class="docblock"><p>如果没有其他 <code>Arc</code> 或 <a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a> 指向相同分配的指针，则返回给定 <code>Arc</code> 的可变引用。</p>
<p>否则返回 <a href="../option/enum.Option.html#variant.None" title="variant std::option::Option::None"><code>None</code></a>，因为更改共享值并不安全。</p>
<p>另见 <a href="struct.Arc.html#method.make_mut" title="associated function std::sync::Arc::make_mut"><code>make_mut</code></a>，当有其他 <code>Arc</code> 指针时，它将 <a href="../clone/trait.Clone.html#tymethod.clone" title="method std::clone::Clone::clone"><code>clone</code></a> 内部值。</p>
<h5 id="examples-24"><a href="#examples-24">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span><span class="kw-2">mut </span>x = Arc::new(<span class="number">3</span>);
<span class="kw-2">*</span>Arc::get_mut(<span class="kw-2">&amp;mut </span>x).unwrap() = <span class="number">4</span>;
<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>x, <span class="number">4</span>);

<span class="kw">let </span>_y = Arc::clone(<span class="kw-2">&amp;</span>x);
<span class="macro">assert!</span>(Arc::get_mut(<span class="kw-2">&amp;mut </span>x).is_none());</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+mut+x+=+Arc::new(3);%0A*Arc::get_mut(%26mut+x).unwrap()+=+4;%0Aassert_eq!(*x,+4);%0A%0Alet+_y+=+Arc::clone(%26x);%0Aassert!(Arc::get_mut(%26mut+x).is_none());%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.get_mut_unchecked" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#1797">source</a><h4 class="code-header">pub unsafe fn <a href="#method.get_mut_unchecked" class="fn">get_mut_unchecked</a>(this: &amp;mut <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.reference.html">&amp;mut T</a></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>get_mut_unchecked</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/63292">#63292</a>)</span></div></span></summary><div class="docblock"><p>将变量引用返回给定的 <code>Arc</code>，而不进行任何检查。</p>
<p>另请参见 <a href="struct.Arc.html#method.get_mut" title="associated function std::sync::Arc::get_mut"><code>get_mut</code></a>，它是安全的并且进行适当的检查。</p>
<h5 id="safety-6"><a href="#safety-6">Safety</a></h5>
<p>如果存在指向同一分配的任何其他 <code>Arc</code> 或 <a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a> 指针，则在返回的借用期间，它们不得被解引用或具有活动借用，并且它们的内部类型必须与此 Rc 的内部类型完全相同 (包括生命周)。
如果不存在这样的指针 (例如紧接在 <code>Arc::new</code> 之后)，则情况很简单。</p>
<h5 id="examples-25"><a href="#examples-25">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(get_mut_unchecked)]

</span><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span><span class="kw-2">mut </span>x = Arc::new(String::new());
<span class="kw">unsafe </span>{
    Arc::get_mut_unchecked(<span class="kw-2">&amp;mut </span>x).push_str(<span class="string">&quot;foo&quot;</span>)
}
<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>x, <span class="string">&quot;foo&quot;</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(get_mut_unchecked)%5D%0A%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+mut+x+=+Arc::new(String::new());%0Aunsafe+%7B%0A++++Arc::get_mut_unchecked(%26mut+x).push_str(%22foo%22)%0A%7D%0Aassert_eq!(*x,+%22foo%22);%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
<p>指向同一分配的其他 <code>Arc</code> 指针必须指向同一类型。</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(get_mut_unchecked)]

</span><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>x: Arc&lt;str&gt; = Arc::from(<span class="string">&quot;Hello, world!&quot;</span>);
<span class="kw">let </span><span class="kw-2">mut </span>y: Arc&lt;[u8]&gt; = x.clone().into();
<span class="kw">unsafe </span>{
    <span class="comment">// 这是未定义的行为，因为 x 的内部类型是 str，而不是 [u8]
    </span>Arc::get_mut_unchecked(<span class="kw-2">&amp;mut </span>y).fill(<span class="number">0xff</span>); <span class="comment">// 0xff 在 UTF-8 中无效
</span>}
<span class="macro">println!</span>(<span class="string">&quot;{}&quot;</span>, <span class="kw-2">&amp;*</span>x); <span class="comment">// str 中的 UTF-8 无效</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(get_mut_unchecked)%5D%0A%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+x:+Arc%3Cstr%3E+=+Arc::from(%22Hello,+world!%22);%0Alet+mut+y:+Arc%3C%5Bu8%5D%3E+=+x.clone().into();%0Aunsafe+%7B%0A++++//+%E8%BF%99%E6%98%AF%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%EF%BC%8C%E5%9B%A0%E4%B8%BA+x+%E7%9A%84%E5%86%85%E9%83%A8%E7%B1%BB%E5%9E%8B%E6%98%AF+str%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AF+%5Bu8%5D%0A++++Arc::get_mut_unchecked(%26mut+y).fill(0xff);+//+0xff+%E5%9C%A8+UTF-8+%E4%B8%AD%E6%97%A0%E6%95%88%0A%7D%0Aprintln!(%22%7B%7D%22,+%26*x);+//+str+%E4%B8%AD%E7%9A%84+UTF-8+%E6%97%A0%E6%95%88%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
<p>指向同一分配的其他 <code>Arc</code> 指针必须指向完全相同的类型，包括生命周期。</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(get_mut_unchecked)]

</span><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>x: Arc&lt;<span class="kw-2">&amp;</span>str&gt; = Arc::new(<span class="string">&quot;Hello, world!&quot;</span>);
{
    <span class="kw">let </span>s = String::from(<span class="string">&quot;Oh, no!&quot;</span>);
    <span class="kw">let </span><span class="kw-2">mut </span>y: Arc&lt;<span class="kw-2">&amp;</span>str&gt; = x.clone().into();
    <span class="kw">unsafe </span>{
        <span class="comment">// 这是未定义的行为，因为 x 的内部类型是 &amp;&#39;long str，而不是 &amp;&#39;short str
        </span><span class="kw-2">*</span>Arc::get_mut_unchecked(<span class="kw-2">&amp;mut </span>y) = <span class="kw-2">&amp;</span>s;
    }
}
<span class="macro">println!</span>(<span class="string">&quot;{}&quot;</span>, <span class="kw-2">&amp;*</span>x); <span class="comment">// Use-after-free</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(get_mut_unchecked)%5D%0A%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+x:+Arc%3C%26str%3E+=+Arc::new(%22Hello,+world!%22);%0A%7B%0A++++let+s+=+String::from(%22Oh,+no!%22);%0A++++let+mut+y:+Arc%3C%26str%3E+=+x.clone().into();%0A++++unsafe+%7B%0A++++++++//+%E8%BF%99%E6%98%AF%E6%9C%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A1%8C%E4%B8%BA%EF%BC%8C%E5%9B%A0%E4%B8%BA+x+%E7%9A%84%E5%86%85%E9%83%A8%E7%B1%BB%E5%9E%8B%E6%98%AF+%26'long+str%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AF+%26'short+str%0A++++++++*Arc::get_mut_unchecked(%26mut+y)+=+%26s;%0A++++%7D%0A%7D%0Aprintln!(%22%7B%7D%22,+%26*x);+//+Use-after-free%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Arc%3Cdyn+Any+%2B+Send+%2B+Sync+%2B+'static%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#1904">source</a><a href="#impl-Arc%3Cdyn+Any+%2B+Send+%2B+Sync+%2B+'static%3E" class="anchor">§</a><h3 class="code-header">impl <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;dyn <a class="trait" href="../any/trait.Any.html" title="trait std::any::Any">Any</a> + <a class="trait" href="../marker/trait.Send.html" title="trait std::marker::Send">Send</a> + <a class="trait" href="../marker/trait.Sync.html" title="trait std::marker::Sync">Sync</a> + 'static&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.downcast" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.29.0">1.29.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#1925-1927">source</a></span><h4 class="code-header">pub fn <a href="#method.downcast" class="fn">downcast</a>&lt;T&gt;(self) -&gt; <a class="enum" href="../result/enum.Result.html" title="enum std::result::Result">Result</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;, <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;dyn <a class="trait" href="../any/trait.Any.html" title="trait std::any::Any">Any</a> + <a class="trait" href="../marker/trait.Send.html" title="trait std::marker::Send">Send</a> + <a class="trait" href="../marker/trait.Sync.html" title="trait std::marker::Sync">Sync</a> + 'static&gt;&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../any/trait.Any.html" title="trait std::any::Any">Any</a> + <a class="trait" href="../marker/trait.Send.html" title="trait std::marker::Send">Send</a> + <a class="trait" href="../marker/trait.Sync.html" title="trait std::marker::Sync">Sync</a>,</span></h4></section></summary><div class="docblock"><p>尝试将 <code>Arc&lt;dyn Any + Send + Sync&gt;</code> 转换为具体类型。</p>
<h5 id="examples-26"><a href="#examples-26">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::any::Any;
<span class="kw">use </span>std::sync::Arc;

<span class="kw">fn </span>print_if_string(value: Arc&lt;<span class="kw">dyn </span>Any + Send + Sync&gt;) {
    <span class="kw">if let </span><span class="prelude-val">Ok</span>(string) = value.downcast::&lt;String&gt;() {
        <span class="macro">println!</span>(<span class="string">&quot;String ({}): {}&quot;</span>, string.len(), string);
    }
}

<span class="kw">let </span>my_string = <span class="string">&quot;Hello World&quot;</span>.to_string();
print_if_string(Arc::new(my_string));
print_if_string(Arc::new(<span class="number">0i8</span>));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::any::Any;%0Ause+std::sync::Arc;%0A%0Afn+print_if_string(value:+Arc%3Cdyn+Any+%2B+Send+%2B+Sync%3E)+%7B%0A++++if+let+Ok(string)+=+value.downcast::%3CString%3E()+%7B%0A++++++++println!(%22String+(%7B%7D):+%7B%7D%22,+string.len(),+string);%0A++++%7D%0A%7D%0A%0Alet+my_string+=+%22Hello+World%22.to_string();%0Aprint_if_string(Arc::new(my_string));%0Aprint_if_string(Arc::new(0i8));%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.downcast_unchecked" class="method"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#1968-1970">source</a><h4 class="code-header">pub unsafe fn <a href="#method.downcast_unchecked" class="fn">downcast_unchecked</a>&lt;T&gt;(self) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../any/trait.Any.html" title="trait std::any::Any">Any</a> + <a class="trait" href="../marker/trait.Send.html" title="trait std::marker::Send">Send</a> + <a class="trait" href="../marker/trait.Sync.html" title="trait std::marker::Sync">Sync</a>,</span></h4></section><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>downcast_unchecked</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/90850">#90850</a>)</span></div></span></summary><div class="docblock"><p>将 <code>Arc&lt;dyn Any + Send + Sync&gt;</code> 向下转换为具体类型。</p>
<p>有关安全的替代方案，请参见 <a href="struct.Arc.html#method.downcast" title="method std::sync::Arc::downcast"><code>downcast</code></a>。</p>
<h5 id="examples-27"><a href="#examples-27">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#![feature(downcast_unchecked)]

</span><span class="kw">use </span>std::any::Any;
<span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>x: Arc&lt;<span class="kw">dyn </span>Any + Send + Sync&gt; = Arc::new(<span class="number">1_usize</span>);

<span class="kw">unsafe </span>{
    <span class="macro">assert_eq!</span>(<span class="kw-2">*</span>x.downcast_unchecked::&lt;usize&gt;(), <span class="number">1</span>);
}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0A%23!%5Bfeature(downcast_unchecked)%5D%0A%0Afn+main()+%7B%0Ause+std::any::Any;%0Ause+std::sync::Arc;%0A%0Alet+x:+Arc%3Cdyn+Any+%2B+Send+%2B+Sync%3E+=+Arc::new(1_usize);%0A%0Aunsafe+%7B%0A++++assert_eq!(*x.downcast_unchecked::%3Cusize%3E(),+1);%0A%7D%0A%7D&amp;version=nightly&amp;edition=2021">Run</a></div>
<h5 id="safety-7"><a href="#safety-7">Safety</a></h5>
<p>包含的值必须是 <code>T</code> 类型。
使用不正确的类型调用此方法是 <em>未定义的行为</em>。</p>
</div></details></div></details></div><h2 id="trait-implementations" class="small-section-header">Trait Implementations<a href="#trait-implementations" class="anchor">§</a></h2><div id="trait-implementations-list"><details class="toggle implementors-toggle" open><summary><section id="impl-AsFd-for-Arc%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.64.0">1.64.0</span> · <a class="srclink" href="../../src/std/os/fd/owned.rs.html#395-400">source</a></span><a href="#impl-AsFd-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T: <a class="trait" href="../os/fd/trait.AsFd.html" title="trait std::os::fd::AsFd">AsFd</a>&gt; <a class="trait" href="../os/fd/trait.AsFd.html" title="trait std::os::fd::AsFd">AsFd</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h3></section></summary><div class="docblock"><p>这个 impl 允许在 Arc 上实现需要 <code>AsFd</code> 的 traits。</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::net::UdpSocket;
<span class="kw">use </span>std::sync::Arc;

<span class="kw">trait </span>MyTrait: AsFd {}
<span class="kw">impl </span>MyTrait <span class="kw">for </span>Arc&lt;UdpSocket&gt; {}
<span class="kw">impl </span>MyTrait <span class="kw">for </span>Box&lt;UdpSocket&gt; {}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0A%23%5Bcfg(any(unix,+target_os+=+%22wasi%22))%5D+mod+group_cfg+%7B%0A%23%5Bcfg(target_os+=+%22wasi%22)%5D%0Ause+std::os::wasi::io::AsFd;%0A%23%5Bcfg(unix)%5D%0Ause+std::os::unix::io::AsFd;%0Ause+std::net::UdpSocket;%0Ause+std::sync::Arc;%0A%0Atrait+MyTrait:+AsFd+%7B%7D%0Aimpl+MyTrait+for+Arc%3CUdpSocket%3E+%7B%7D%0Aimpl+MyTrait+for+Box%3CUdpSocket%3E+%7B%7D%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
</div><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.as_fd" class="method trait-impl"><a class="srclink rightside" href="../../src/std/os/fd/owned.rs.html#397-399">source</a><a href="#method.as_fd" class="anchor">§</a><h4 class="code-header">fn <a href="../os/fd/trait.AsFd.html#tymethod.as_fd" class="fn">as_fd</a>(&amp;self) -&gt; <a class="struct" href="../os/fd/struct.BorrowedFd.html" title="struct std::os::fd::BorrowedFd">BorrowedFd</a>&lt;'_&gt;</h4></section></summary><div class='docblock'>借用文件描述符。 <a href="../os/fd/trait.AsFd.html#tymethod.as_fd">Read more</a></div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-AsHandle-for-Arc%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.71.0">1.71.0</span> · <a class="srclink" href="../../src/std/os/windows/io/handle.rs.html#453-458">source</a></span><a href="#impl-AsHandle-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T: <a class="trait" href="../os/windows/io/trait.AsHandle.html" title="trait std::os::windows::io::AsHandle">AsHandle</a>&gt; <a class="trait" href="../os/windows/io/trait.AsHandle.html" title="trait std::os::windows::io::AsHandle">AsHandle</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h3><span class="item-info"><div class="stab portability">Available on <strong>Windows</strong> only.</div></span></section></summary><div class="docblock"><p>这个 impl 允许在 Arc 上实现需要 <code>AsHandle</code> 的 traits。</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::fs::File;
<span class="kw">use </span>std::sync::Arc;

<span class="kw">trait </span>MyTrait: AsHandle {}
<span class="kw">impl </span>MyTrait <span class="kw">for </span>Arc&lt;File&gt; {}
<span class="kw">impl </span>MyTrait <span class="kw">for </span>Box&lt;File&gt; {}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0A%23%5Bcfg(windows)%5D+mod+group_cfg+%7B%0Ause+std::os::windows::io::AsHandle;%0Ause+std::fs::File;%0Ause+std::sync::Arc;%0A%0Atrait+MyTrait:+AsHandle+%7B%7D%0Aimpl+MyTrait+for+Arc%3CFile%3E+%7B%7D%0Aimpl+MyTrait+for+Box%3CFile%3E+%7B%7D%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
</div><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.as_handle" class="method trait-impl"><a class="srclink rightside" href="../../src/std/os/windows/io/handle.rs.html#455-457">source</a><a href="#method.as_handle" class="anchor">§</a><h4 class="code-header">fn <a href="../os/windows/io/trait.AsHandle.html#tymethod.as_handle" class="fn">as_handle</a>(&amp;self) -&gt; <a class="struct" href="../os/windows/io/struct.BorrowedHandle.html" title="struct std::os::windows::io::BorrowedHandle">BorrowedHandle</a>&lt;'_&gt;</h4></section></summary><div class='docblock'>借用句柄。 <a href="../os/windows/io/trait.AsHandle.html#tymethod.as_handle">Read more</a></div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-AsRawFd-for-Arc%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.63.0">1.63.0</span> · <a class="srclink" href="../../src/std/os/fd/raw.rs.html#250-255">source</a></span><a href="#impl-AsRawFd-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T: <a class="trait" href="../os/fd/trait.AsRawFd.html" title="trait std::os::fd::AsRawFd">AsRawFd</a>&gt; <a class="trait" href="../os/fd/trait.AsRawFd.html" title="trait std::os::fd::AsRawFd">AsRawFd</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h3></section></summary><div class="docblock"><p>这个 impl 允许在 Arc 上实现需要 <code>AsRawFd</code> 的 traits。</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::net::UdpSocket;
<span class="kw">use </span>std::sync::Arc;
<span class="kw">trait </span>MyTrait: AsRawFd {
}
<span class="kw">impl </span>MyTrait <span class="kw">for </span>Arc&lt;UdpSocket&gt; {}
<span class="kw">impl </span>MyTrait <span class="kw">for </span>Box&lt;UdpSocket&gt; {}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0A%23%5Bcfg(any(unix,+target_os+=+%22wasi%22))%5D+mod+group_cfg+%7B%0A%23%5Bcfg(target_os+=+%22wasi%22)%5D%0Ause+std::os::wasi::io::AsRawFd;%0A%23%5Bcfg(unix)%5D%0Ause+std::os::unix::io::AsRawFd;%0Ause+std::net::UdpSocket;%0Ause+std::sync::Arc;%0Atrait+MyTrait:+AsRawFd+%7B%0A%7D%0Aimpl+MyTrait+for+Arc%3CUdpSocket%3E+%7B%7D%0Aimpl+MyTrait+for+Box%3CUdpSocket%3E+%7B%7D%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
</div><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.as_raw_fd" class="method trait-impl"><a class="srclink rightside" href="../../src/std/os/fd/raw.rs.html#252-254">source</a><a href="#method.as_raw_fd" class="anchor">§</a><h4 class="code-header">fn <a href="../os/fd/trait.AsRawFd.html#tymethod.as_raw_fd" class="fn">as_raw_fd</a>(&amp;self) -&gt; <a class="type" href="../os/fd/type.RawFd.html" title="type std::os::fd::RawFd">RawFd</a></h4></section></summary><div class='docblock'>提取原始文件描述符。 <a href="../os/fd/trait.AsRawFd.html#tymethod.as_raw_fd">Read more</a></div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-AsRef%3CT%3E-for-Arc%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.5.0">1.5.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2922">source</a></span><a href="#impl-AsRef%3CT%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../convert/trait.AsRef.html" title="trait std::convert::AsRef">AsRef</a>&lt;T&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.as_ref" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2923">source</a><a href="#method.as_ref" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.AsRef.html#tymethod.as_ref" class="fn">as_ref</a>(&amp;self) -&gt; <a class="primitive" href="../primitive.reference.html">&amp;T</a></h4></section></summary><div class='docblock'>将此类型转换为 (通常是推断的) 输入类型的共享引用。</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-AsSocket-for-Arc%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.71.0">1.71.0</span> · <a class="srclink" href="../../src/std/os/windows/io/socket.rs.html#270-275">source</a></span><a href="#impl-AsSocket-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T: <a class="trait" href="../os/windows/io/trait.AsSocket.html" title="trait std::os::windows::io::AsSocket">AsSocket</a>&gt; <a class="trait" href="../os/windows/io/trait.AsSocket.html" title="trait std::os::windows::io::AsSocket">AsSocket</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h3><span class="item-info"><div class="stab portability">Available on <strong>Windows</strong> only.</div></span></section></summary><div class="docblock"><p>这个 impl 允许在 Arc 上实现需要 <code>AsSocket</code> 的 traits。</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::net::UdpSocket;
<span class="kw">use </span>std::sync::Arc;

<span class="kw">trait </span>MyTrait: AsSocket {}
<span class="kw">impl </span>MyTrait <span class="kw">for </span>Arc&lt;UdpSocket&gt; {}
<span class="kw">impl </span>MyTrait <span class="kw">for </span>Box&lt;UdpSocket&gt; {}</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0A%23%5Bcfg(windows)%5D+mod+group_cfg+%7B%0Ause+std::os::windows::io::AsSocket;%0Ause+std::net::UdpSocket;%0Ause+std::sync::Arc;%0A%0Atrait+MyTrait:+AsSocket+%7B%7D%0Aimpl+MyTrait+for+Arc%3CUdpSocket%3E+%7B%7D%0Aimpl+MyTrait+for+Box%3CUdpSocket%3E+%7B%7D%0A%7D%0A%7D&amp;edition=2021">Run</a></div>
</div><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.as_socket" class="method trait-impl"><a class="srclink rightside" href="../../src/std/os/windows/io/socket.rs.html#272-274">source</a><a href="#method.as_socket" class="anchor">§</a><h4 class="code-header">fn <a href="../os/windows/io/trait.AsSocket.html#tymethod.as_socket" class="fn">as_socket</a>(&amp;self) -&gt; <a class="struct" href="../os/windows/io/struct.BorrowedSocket.html" title="struct std::os::windows::io::BorrowedSocket">BorrowedSocket</a>&lt;'_&gt;</h4></section></summary><div class='docblock'>借用套接字。</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Borrow%3CT%3E-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2915">source</a><a href="#impl-Borrow%3CT%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../borrow/trait.Borrow.html" title="trait std::borrow::Borrow">Borrow</a>&lt;T&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.borrow" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2916">source</a><a href="#method.borrow" class="anchor">§</a><h4 class="code-header">fn <a href="../borrow/trait.Borrow.html#tymethod.borrow" class="fn">borrow</a>(&amp;self) -&gt; <a class="primitive" href="../primitive.reference.html">&amp;T</a></h4></section></summary><div class='docblock'>从拥有的值中一成不变地借用。 <a href="../borrow/trait.Borrow.html#tymethod.borrow">Read more</a></div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Clone-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#1486">source</a><a href="#impl-Clone-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../clone/trait.Clone.html" title="trait std::clone::Clone">Clone</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.clone" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#1502">source</a><a href="#method.clone" class="anchor">§</a><h4 class="code-header">fn <a href="../clone/trait.Clone.html#tymethod.clone" class="fn">clone</a>(&amp;self) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h4></section></summary><div class="docblock"><p>克隆 <code>Arc</code> 指针。</p>
<p>这将创建另一个指向相同分配的指针，从而增加了强引用计数。</p>
<h5 id="examples-37"><a href="#examples-37">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="kw">let _ </span>= Arc::clone(<span class="kw-2">&amp;</span>five);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0A%0Alet+_+=+Arc::clone(%26five);%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.clone_from" class="method trait-impl"><a class="srclink rightside" href="../../src/core/clone.rs.html#129">source</a><a href="#method.clone_from" class="anchor">§</a><h4 class="code-header">fn <a href="../clone/trait.Clone.html#method.clone_from" class="fn">clone_from</a>(&amp;mut self, source: <a class="primitive" href="../primitive.reference.html">&amp;Self</a>)</h4></section></summary><div class='docblock'>从 <code>source</code> 执行复制分配。 <a href="../clone/trait.Clone.html#method.clone_from">Read more</a></div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Debug-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2610">source</a><a href="#impl-Debug-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../fmt/trait.Debug.html" title="trait std::fmt::Debug">Debug</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../fmt/trait.Debug.html" title="trait std::fmt::Debug">Debug</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.fmt-1" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2611">source</a><a href="#method.fmt-1" class="anchor">§</a><h4 class="code-header">fn <a href="../fmt/trait.Debug.html#tymethod.fmt" class="fn">fmt</a>(&amp;self, f: &amp;mut <a class="struct" href="../fmt/struct.Formatter.html" title="struct std::fmt::Formatter">Formatter</a>&lt;'_&gt;) -&gt; <a class="enum" href="../result/enum.Result.html" title="enum std::result::Result">Result</a>&lt;<a class="primitive" href="../primitive.unit.html">()</a>, <a class="struct" href="../fmt/struct.Error.html" title="struct std::fmt::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>使用给定的格式化程序格式化该值。 <a href="../fmt/trait.Debug.html#tymethod.fmt">Read more</a></div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Default-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2625">source</a><a href="#impl-Default-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../default/trait.Default.html" title="trait std::default::Default">Default</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../default/trait.Default.html" title="trait std::default::Default">Default</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.default" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2636">source</a><a href="#method.default" class="anchor">§</a><h4 class="code-header">fn <a href="../default/trait.Default.html#tymethod.default" class="fn">default</a>() -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h4></section></summary><div class="docblock"><p>用 <code>T</code> 的 <code>Default</code> 值创建一个新的 <code>Arc&lt;T&gt;</code>。</p>
<h5 id="examples-29"><a href="#examples-29">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>x: Arc&lt;i32&gt; = Default::default();
<span class="macro">assert_eq!</span>(<span class="kw-2">*</span>x, <span class="number">0</span>);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+x:+Arc%3Ci32%3E+=+Default::default();%0Aassert_eq!(*x,+0);%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Deref-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#1540">source</a><a href="#impl-Deref-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../ops/trait.Deref.html" title="trait std::ops::Deref">Deref</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Target" class="associatedtype trait-impl"><a href="#associatedtype.Target" class="anchor">§</a><h4 class="code-header">type <a href="../ops/trait.Deref.html#associatedtype.Target" class="associatedtype">Target</a> = T</h4></section></summary><div class='docblock'>解引用后的结果类型。</div></details><details class="toggle method-toggle" open><summary><section id="method.deref" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#1544">source</a><a href="#method.deref" class="anchor">§</a><h4 class="code-header">fn <a href="../ops/trait.Deref.html#tymethod.deref" class="fn">deref</a>(&amp;self) -&gt; <a class="primitive" href="../primitive.reference.html">&amp;T</a></h4></section></summary><div class='docblock'>解引用值。</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Display-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2603">source</a><a href="#impl-Display-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../fmt/trait.Display.html" title="trait std::fmt::Display">Display</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../fmt/trait.Display.html" title="trait std::fmt::Display">Display</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.fmt-2" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2604">source</a><a href="#method.fmt-2" class="anchor">§</a><h4 class="code-header">fn <a href="../fmt/trait.Display.html#tymethod.fmt" class="fn">fmt</a>(&amp;self, f: &amp;mut <a class="struct" href="../fmt/struct.Formatter.html" title="struct std::fmt::Formatter">Formatter</a>&lt;'_&gt;) -&gt; <a class="enum" href="../result/enum.Result.html" title="enum std::result::Result">Result</a>&lt;<a class="primitive" href="../primitive.unit.html">()</a>, <a class="struct" href="../fmt/struct.Error.html" title="struct std::fmt::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>使用给定的格式化程序格式化该值。 <a href="../fmt/trait.Display.html#tymethod.fmt">Read more</a></div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Drop-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#1833">source</a><a href="#impl-Drop-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../ops/trait.Drop.html" title="trait std::ops::Drop">Drop</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.drop" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#1860">source</a><a href="#method.drop" class="anchor">§</a><h4 class="code-header">fn <a href="../ops/trait.Drop.html#tymethod.drop" class="fn">drop</a>(&amp;mut self)</h4></section></summary><div class="docblock"><p>丢弃 <code>Arc</code>。</p>
<p>这将减少强引用计数。
如果强引用计数达到零，那么唯一的其他引用 (如果有) 是 <a href="struct.Weak.html" title="struct std::sync::Weak"><code>Weak</code></a>，因此我们将 <code>drop</code> 作为内部值。</p>
<h5 id="examples-38"><a href="#examples-38">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">struct </span>Foo;

<span class="kw">impl </span>Drop <span class="kw">for </span>Foo {
    <span class="kw">fn </span>drop(<span class="kw-2">&amp;mut </span><span class="self">self</span>) {
        <span class="macro">println!</span>(<span class="string">&quot;dropped!&quot;</span>);
    }
}

<span class="kw">let </span>foo  = Arc::new(Foo);
<span class="kw">let </span>foo2 = Arc::clone(<span class="kw-2">&amp;</span>foo);

drop(foo);    <span class="comment">// 不打印任何东西
</span>drop(foo2);   <span class="comment">// 打印 &quot;dropped!&quot;</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Astruct+Foo;%0A%0Aimpl+Drop+for+Foo+%7B%0A++++fn+drop(%26mut+self)+%7B%0A++++++++println!(%22dropped!%22);%0A++++%7D%0A%7D%0A%0Alet+foo++=+Arc::new(Foo);%0Alet+foo2+=+Arc::clone(%26foo);%0A%0Adrop(foo);++++//+%E4%B8%8D%E6%89%93%E5%8D%B0%E4%BB%BB%E4%BD%95%E4%B8%9C%E8%A5%BF%0Adrop(foo2);+++//+%E6%89%93%E5%8D%B0+%22dropped!%22%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Error-for-Arc%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.52.0">1.52.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2954">source</a></span><a href="#impl-Error-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../error/trait.Error.html" title="trait std::error::Error">Error</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../error/trait.Error.html" title="trait std::error::Error">Error</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.description" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2956">source</a><a href="#method.description" class="anchor">§</a><h4 class="code-header">fn <a href="../error/trait.Error.html#method.description" class="fn">description</a>(&amp;self) -&gt; &amp;<a class="primitive" href="../primitive.str.html">str</a></h4></section></summary><span class="item-info"><div class="stab deprecated"><span class="emoji">👎</span><span>Deprecated since 1.42.0: use the Display impl or to_string()</span></div></span><div class='docblock'> <a href="../error/trait.Error.html#method.description">Read more</a></div></details><details class="toggle method-toggle" open><summary><section id="method.cause" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2961">source</a><a href="#method.cause" class="anchor">§</a><h4 class="code-header">fn <a href="../error/trait.Error.html#method.cause" class="fn">cause</a>(&amp;self) -&gt; <a class="enum" href="../option/enum.Option.html" title="enum std::option::Option">Option</a>&lt;&amp;dyn <a class="trait" href="../error/trait.Error.html" title="trait std::error::Error">Error</a>&gt;</h4></section></summary><span class="item-info"><div class="stab deprecated"><span class="emoji">👎</span><span>Deprecated since 1.33.0: replaced by Error::source, which can support downcasting</span></div></span></details><details class="toggle method-toggle" open><summary><section id="method.source" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2965">source</a><a href="#method.source" class="anchor">§</a><h4 class="code-header">fn <a href="../error/trait.Error.html#method.source" class="fn">source</a>(&amp;self) -&gt; <a class="enum" href="../option/enum.Option.html" title="enum std::option::Option">Option</a>&lt;&amp;(dyn <a class="trait" href="../error/trait.Error.html" title="trait std::error::Error">Error</a> + 'static)&gt;</h4></section></summary><div class='docblock'>此错误的下级来源 (如果有)。 <a href="../error/trait.Error.html#method.source">Read more</a></div></details><details class="toggle method-toggle" open><summary><section id="method.provide" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2969">source</a><a href="#method.provide" class="anchor">§</a><h4 class="code-header">fn <a href="../error/trait.Error.html#method.provide" class="fn">provide</a>&lt;'a&gt;(&amp;'a self, req: &amp;mut <a class="struct" href="../any/struct.Demand.html" title="struct std::any::Demand">Demand</a>&lt;'a&gt;)</h4></section></summary><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>error_generic_member_access</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/99301">#99301</a>)</span></div></span><div class='docblock'>提供对用于错误报告的上下文的基于类型的访问。 <a href="../error/trait.Error.html#method.provide">Read more</a></div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3C%26%5BT%5D%3E-for-Arc%3C%5BT%5D%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.21.0">1.21.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2672">source</a></span><a href="#impl-From%3C%26%5BT%5D%3E-for-Arc%3C%5BT%5D%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;&amp;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../clone/trait.Clone.html" title="trait std::clone::Clone">Clone</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-1" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2684">source</a><a href="#method.from-1" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(v: &amp;<a class="primitive" href="../primitive.slice.html">[T]</a>) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt;</h4></section></summary><div class="docblock"><p>分配一个引用计数的切片，并通过克隆 <code>v</code> 的项来填充它。</p>
<h5 id="example-1"><a href="#example-1">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>original: <span class="kw-2">&amp;</span>[i32] = <span class="kw-2">&amp;</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];
<span class="kw">let </span>shared: Arc&lt;[i32]&gt; = Arc::from(original);
<span class="macro">assert_eq!</span>(<span class="kw-2">&amp;</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="kw-2">&amp;</span>shared[..]);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Alet+original:+%26%5Bi32%5D+=+%26%5B1,+2,+3%5D;%0Alet+shared:+Arc%3C%5Bi32%5D%3E+=+Arc::from(original);%0Aassert_eq!(%26%5B1,+2,+3%5D,+%26shared%5B..%5D);%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3C%26CStr%3E-for-Arc%3CCStr%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.24.0">1.24.0</span> · <a class="srclink" href="../../src/alloc/ffi/c_str.rs.html#878">source</a></span><a href="#impl-From%3C%26CStr%3E-for-Arc%3CCStr%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;&amp;<a class="struct" href="../ffi/struct.CStr.html" title="struct std::ffi::CStr">CStr</a>&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="struct" href="../ffi/struct.CStr.html" title="struct std::ffi::CStr">CStr</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-11" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/ffi/c_str.rs.html#882">source</a><a href="#method.from-11" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(s: &amp;<a class="struct" href="../ffi/struct.CStr.html" title="struct std::ffi::CStr">CStr</a>) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="struct" href="../ffi/struct.CStr.html" title="struct std::ffi::CStr">CStr</a>&gt;</h4></section></summary><div class="docblock"><p>通过将内容复制到新分配的 <a href="struct.Arc.html" title="struct std::sync::Arc"><code>Arc</code></a> 中，将 <code>&amp;CStr</code> 转换为 <code>Arc&lt;CStr&gt;</code>。</p>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3C%26OsStr%3E-for-Arc%3COsStr%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.24.0">1.24.0</span> · <a class="srclink" href="../../src/std/ffi/os_str.rs.html#1045-1052">source</a></span><a href="#impl-From%3C%26OsStr%3E-for-Arc%3COsStr%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;&amp;<a class="struct" href="../ffi/struct.OsStr.html" title="struct std::ffi::OsStr">OsStr</a>&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="struct" href="../ffi/struct.OsStr.html" title="struct std::ffi::OsStr">OsStr</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-15" class="method trait-impl"><a class="srclink rightside" href="../../src/std/ffi/os_str.rs.html#1048-1051">source</a><a href="#method.from-15" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(s: &amp;<a class="struct" href="../ffi/struct.OsStr.html" title="struct std::ffi::OsStr">OsStr</a>) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="struct" href="../ffi/struct.OsStr.html" title="struct std::ffi::OsStr">OsStr</a>&gt;</h4></section></summary><div class="docblock"><p>将字符串复制到新分配的 <code><a href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a href="../ffi/struct.OsStr.html" title="struct std::ffi::OsStr">OsStr</a>&gt;</code> 中。</p>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3C%26Path%3E-for-Arc%3CPath%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.24.0">1.24.0</span> · <a class="srclink" href="../../src/std/path.rs.html#1871-1878">source</a></span><a href="#impl-From%3C%26Path%3E-for-Arc%3CPath%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;&amp;<a class="struct" href="../path/struct.Path.html" title="struct std::path::Path">Path</a>&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="struct" href="../path/struct.Path.html" title="struct std::path::Path">Path</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-14" class="method trait-impl"><a class="srclink rightside" href="../../src/std/path.rs.html#1874-1877">source</a><a href="#method.from-14" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(s: &amp;<a class="struct" href="../path/struct.Path.html" title="struct std::path::Path">Path</a>) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="struct" href="../path/struct.Path.html" title="struct std::path::Path">Path</a>&gt;</h4></section></summary><div class="docblock"><p>通过将 <a href="../path/struct.Path.html" title="struct std::path::Path"><code>Path</code></a> 数据复制到新的 <a href="struct.Arc.html" title="struct std::sync::Arc"><code>Arc</code></a> 缓冲区，将 <a href="../path/struct.Path.html" title="struct std::path::Path"><code>Path</code></a> 转换为 <a href="struct.Arc.html" title="struct std::sync::Arc"><code>Arc</code></a>。</p>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3C%26str%3E-for-Arc%3Cstr%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.21.0">1.21.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2691">source</a></span><a href="#impl-From%3C%26str%3E-for-Arc%3Cstr%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;&amp;<a class="primitive" href="../primitive.str.html">str</a>&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.str.html">str</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-8" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2702">source</a><a href="#method.from-8" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(v: &amp;<a class="primitive" href="../primitive.str.html">str</a>) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.str.html">str</a>&gt;</h4></section></summary><div class="docblock"><p>分配一个引用计数的 <code>str</code> 并将 <code>v</code> 复制到其中。</p>
<h5 id="example-7"><a href="#example-7">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>shared: Arc&lt;str&gt; = Arc::from(<span class="string">&quot;eggplant&quot;</span>);
<span class="macro">assert_eq!</span>(<span class="string">&quot;eggplant&quot;</span>, <span class="kw-2">&amp;</span>shared[..]);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Alet+shared:+Arc%3Cstr%3E+=+Arc::from(%22eggplant%22);%0Aassert_eq!(%22eggplant%22,+%26shared%5B..%5D);%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3CArc%3CW%3E%3E-for-RawWaker" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.51.0">1.51.0</span> · <a class="srclink" href="../../src/alloc/task.rs.html#108">source</a></span><a href="#impl-From%3CArc%3CW%3E%3E-for-RawWaker" class="anchor">§</a><h3 class="code-header">impl&lt;W&gt; <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;W&gt;&gt; for <a class="struct" href="../task/struct.RawWaker.html" title="struct std::task::RawWaker">RawWaker</a><span class="where fmt-newline">where
    W: <a class="trait" href="../task/trait.Wake.html" title="trait std::task::Wake">Wake</a> + <a class="trait" href="../marker/trait.Send.html" title="trait std::marker::Send">Send</a> + <a class="trait" href="../marker/trait.Sync.html" title="trait std::marker::Sync">Sync</a> + 'static,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-10" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/task.rs.html#112">source</a><a href="#method.from-10" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(waker: <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;W&gt;) -&gt; <a class="struct" href="../task/struct.RawWaker.html" title="struct std::task::RawWaker">RawWaker</a></h4></section></summary><div class="docblock"><p>使用 <code>Wake</code> 类型作为 <code>RawWaker</code>。</p>
<p>此转换不使用堆分配或原子操作。</p>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3CArc%3CW%3E%3E-for-Waker" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.51.0">1.51.0</span> · <a class="srclink" href="../../src/alloc/task.rs.html#96">source</a></span><a href="#impl-From%3CArc%3CW%3E%3E-for-Waker" class="anchor">§</a><h3 class="code-header">impl&lt;W&gt; <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;W&gt;&gt; for <a class="struct" href="../task/struct.Waker.html" title="struct std::task::Waker">Waker</a><span class="where fmt-newline">where
    W: <a class="trait" href="../task/trait.Wake.html" title="trait std::task::Wake">Wake</a> + <a class="trait" href="../marker/trait.Send.html" title="trait std::marker::Send">Send</a> + <a class="trait" href="../marker/trait.Sync.html" title="trait std::marker::Sync">Sync</a> + 'static,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/task.rs.html#100">source</a><a href="#method.from" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(waker: <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;W&gt;) -&gt; <a class="struct" href="../task/struct.Waker.html" title="struct std::task::Waker">Waker</a></h4></section></summary><div class="docblock"><p>使用 <code>Wake</code> 类型作为 <code>Waker</code>。</p>
<p>此转换不使用堆分配或原子操作。</p>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3CArc%3Cstr%3E%3E-for-Arc%3C%5Bu8%5D%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.62.0">1.62.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2798">source</a></span><a href="#impl-From%3CArc%3Cstr%3E%3E-for-Arc%3C%5Bu8%5D%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.str.html">str</a>&gt;&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;[<a class="primitive" href="../primitive.u8.html">u8</a>]&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-3" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2810">source</a><a href="#method.from-3" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(rc: <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.str.html">str</a>&gt;) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;[<a class="primitive" href="../primitive.u8.html">u8</a>]&gt;</h4></section></summary><div class="docblock"><p>将原子引用计数的字符串切片转换为字节切片。</p>
<h5 id="example-3"><a href="#example-3">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>string: Arc&lt;str&gt; = Arc::from(<span class="string">&quot;eggplant&quot;</span>);
<span class="kw">let </span>bytes: Arc&lt;[u8]&gt; = Arc::from(string);
<span class="macro">assert_eq!</span>(<span class="string">&quot;eggplant&quot;</span>.as_bytes(), bytes.as_ref());</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Alet+string:+Arc%3Cstr%3E+=+Arc::from(%22eggplant%22);%0Alet+bytes:+Arc%3C%5Bu8%5D%3E+=+Arc::from(string);%0Aassert_eq!(%22eggplant%22.as_bytes(),+bytes.as_ref());%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3CBox%3CT,+Global%3E%3E-for-Arc%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.21.0">1.21.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2729">source</a></span><a href="#impl-From%3CBox%3CT,+Global%3E%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;<a class="struct" href="../boxed/struct.Box.html" title="struct std::boxed::Box">Box</a>&lt;T, <a class="struct" href="../alloc/struct.Global.html" title="struct std::alloc::Global">Global</a>&gt;&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-5" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2741">source</a><a href="#method.from-5" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(v: <a class="struct" href="../boxed/struct.Box.html" title="struct std::boxed::Box">Box</a>&lt;T, <a class="struct" href="../alloc/struct.Global.html" title="struct std::alloc::Global">Global</a>&gt;) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h4></section></summary><div class="docblock"><p>将 boxed 对象移动到新的引用计数分配。</p>
<h5 id="example-4"><a href="#example-4">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>unique: Box&lt;str&gt; = Box::from(<span class="string">&quot;eggplant&quot;</span>);
<span class="kw">let </span>shared: Arc&lt;str&gt; = Arc::from(unique);
<span class="macro">assert_eq!</span>(<span class="string">&quot;eggplant&quot;</span>, <span class="kw-2">&amp;</span>shared[..]);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Alet+unique:+Box%3Cstr%3E+=+Box::from(%22eggplant%22);%0Alet+shared:+Arc%3Cstr%3E+=+Arc::from(unique);%0Aassert_eq!(%22eggplant%22,+%26shared%5B..%5D);%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3CCString%3E-for-Arc%3CCStr%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.24.0">1.24.0</span> · <a class="srclink" href="../../src/alloc/ffi/c_str.rs.html#866">source</a></span><a href="#impl-From%3CCString%3E-for-Arc%3CCStr%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;<a class="struct" href="../ffi/struct.CString.html" title="struct std::ffi::CString">CString</a>&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="struct" href="../ffi/struct.CStr.html" title="struct std::ffi::CStr">CStr</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-4" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/ffi/c_str.rs.html#870">source</a><a href="#method.from-4" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(s: <a class="struct" href="../ffi/struct.CString.html" title="struct std::ffi::CString">CString</a>) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="struct" href="../ffi/struct.CStr.html" title="struct std::ffi::CStr">CStr</a>&gt;</h4></section></summary><div class="docblock"><p>通过将 <a href="../ffi/struct.CString.html" title="struct std::ffi::CString"><code>CString</code></a> 数据移动到新的 <a href="struct.Arc.html" title="struct std::sync::Arc"><code>Arc</code></a> 缓冲区中，将 <a href="../ffi/struct.CString.html" title="struct std::ffi::CString"><code>CString</code></a> 转换为 <code><a href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a href="../ffi/struct.CStr.html" title="struct std::ffi::CStr">CStr</a>&gt;</code>。</p>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3CCow%3C'a,+B%3E%3E-for-Arc%3CB%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.45.0">1.45.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2771">source</a></span><a href="#impl-From%3CCow%3C'a,+B%3E%3E-for-Arc%3CB%3E" class="anchor">§</a><h3 class="code-header">impl&lt;'a, B&gt; <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;<a class="enum" href="../borrow/enum.Cow.html" title="enum std::borrow::Cow">Cow</a>&lt;'a, B&gt;&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;B&gt;<span class="where fmt-newline">where
    B: <a class="trait" href="../borrow/trait.ToOwned.html" title="trait std::borrow::ToOwned">ToOwned</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,
    <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;B&gt;: <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;<a class="primitive" href="../primitive.reference.html">&amp;'a B</a>&gt; + <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;&lt;B as <a class="trait" href="../borrow/trait.ToOwned.html" title="trait std::borrow::ToOwned">ToOwned</a>&gt;::<a class="associatedtype" href="../borrow/trait.ToOwned.html#associatedtype.Owned" title="type std::borrow::ToOwned::Owned">Owned</a>&gt;,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-9" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2789">source</a><a href="#method.from-9" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(cow: <a class="enum" href="../borrow/enum.Cow.html" title="enum std::borrow::Cow">Cow</a>&lt;'a, B&gt;) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;B&gt;</h4></section></summary><div class="docblock"><p>通过复制其内容，从写时克隆指针创建一个原子引用计数指针。</p>
<h5 id="example-8"><a href="#example-8">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>cow: Cow&lt;<span class="lifetime">&#39;_</span>, str&gt; = Cow::Borrowed(<span class="string">&quot;eggplant&quot;</span>);
<span class="kw">let </span>shared: Arc&lt;str&gt; = Arc::from(cow);
<span class="macro">assert_eq!</span>(<span class="string">&quot;eggplant&quot;</span>, <span class="kw-2">&amp;</span>shared[..]);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Ause+std::borrow::Cow;%0Alet+cow:+Cow%3C'_,+str%3E+=+Cow::Borrowed(%22eggplant%22);%0Alet+shared:+Arc%3Cstr%3E+=+Arc::from(cow);%0Aassert_eq!(%22eggplant%22,+%26shared%5B..%5D);%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3COsString%3E-for-Arc%3COsStr%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.24.0">1.24.0</span> · <a class="srclink" href="../../src/std/ffi/os_str.rs.html#1034-1042">source</a></span><a href="#impl-From%3COsString%3E-for-Arc%3COsStr%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;<a class="struct" href="../ffi/struct.OsString.html" title="struct std::ffi::OsString">OsString</a>&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="struct" href="../ffi/struct.OsStr.html" title="struct std::ffi::OsStr">OsStr</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-12" class="method trait-impl"><a class="srclink rightside" href="../../src/std/ffi/os_str.rs.html#1038-1041">source</a><a href="#method.from-12" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(s: <a class="struct" href="../ffi/struct.OsString.html" title="struct std::ffi::OsString">OsString</a>) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="struct" href="../ffi/struct.OsStr.html" title="struct std::ffi::OsStr">OsStr</a>&gt;</h4></section></summary><div class="docblock"><p>通过将 <a href="../ffi/struct.OsString.html" title="struct std::ffi::OsString"><code>OsString</code></a> 数据移动到新的 <a href="struct.Arc.html" title="struct std::sync::Arc"><code>Arc</code></a> 缓冲区中，将 <a href="../ffi/struct.OsString.html" title="struct std::ffi::OsString"><code>OsString</code></a> 转换为 <code><a href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a href="../ffi/struct.OsStr.html" title="struct std::ffi::OsStr">OsStr</a>&gt;</code>。</p>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3CPathBuf%3E-for-Arc%3CPath%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.24.0">1.24.0</span> · <a class="srclink" href="../../src/std/path.rs.html#1860-1868">source</a></span><a href="#impl-From%3CPathBuf%3E-for-Arc%3CPath%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;<a class="struct" href="../path/struct.PathBuf.html" title="struct std::path::PathBuf">PathBuf</a>&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="struct" href="../path/struct.Path.html" title="struct std::path::Path">Path</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-13" class="method trait-impl"><a class="srclink rightside" href="../../src/std/path.rs.html#1864-1867">source</a><a href="#method.from-13" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(s: <a class="struct" href="../path/struct.PathBuf.html" title="struct std::path::PathBuf">PathBuf</a>) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="struct" href="../path/struct.Path.html" title="struct std::path::Path">Path</a>&gt;</h4></section></summary><div class="docblock"><p>通过将 <a href="../path/struct.PathBuf.html" title="struct std::path::PathBuf"><code>PathBuf</code></a> 数据移动到新的 <a href="struct.Arc.html" title="struct std::sync::Arc"><code>Arc</code></a> 缓冲区中，将 <a href="../path/struct.PathBuf.html" title="struct std::path::PathBuf"><code>PathBuf</code></a> 转换为 <code><a href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a href="../path/struct.Path.html" title="struct std::path::Path">Path</a>&gt;</code>。</p>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3CString%3E-for-Arc%3Cstr%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.21.0">1.21.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2710">source</a></span><a href="#impl-From%3CString%3E-for-Arc%3Cstr%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;<a class="struct" href="../string/struct.String.html" title="struct std::string::String">String</a>&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.str.html">str</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-7" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2722">source</a><a href="#method.from-7" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(v: <a class="struct" href="../string/struct.String.html" title="struct std::string::String">String</a>) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.str.html">str</a>&gt;</h4></section></summary><div class="docblock"><p>分配一个引用计数的 <code>str</code> 并将 <code>v</code> 复制到其中。</p>
<h5 id="example-6"><a href="#example-6">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>unique: String = <span class="string">&quot;eggplant&quot;</span>.to_owned();
<span class="kw">let </span>shared: Arc&lt;str&gt; = Arc::from(unique);
<span class="macro">assert_eq!</span>(<span class="string">&quot;eggplant&quot;</span>, <span class="kw-2">&amp;</span>shared[..]);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Alet+unique:+String+=+%22eggplant%22.to_owned();%0Alet+shared:+Arc%3Cstr%3E+=+Arc::from(unique);%0Aassert_eq!(%22eggplant%22,+%26shared%5B..%5D);%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3CT%3E-for-Arc%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.6.0">1.6.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2650">source</a></span><a href="#impl-From%3CT%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;T&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-2" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2665">source</a><a href="#method.from-2" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(t: T) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;</h4></section></summary><div class="docblock"><p>将 <code>T</code> 转换为 <code>Arc&lt;T&gt;</code></p>
<p>转换将值移动到新分配的 <code>Arc</code> 中。
相当于调用 <code>Arc::new(t)</code>。</p>
<h5 id="example-2"><a href="#example-2">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>x = <span class="number">5</span>;
<span class="kw">let </span>arc = Arc::new(<span class="number">5</span>);

<span class="macro">assert_eq!</span>(Arc::from(x), arc);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Alet+x+=+5;%0Alet+arc+=+Arc::new(5);%0A%0Aassert_eq!(Arc::from(x),+arc);%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-From%3CVec%3CT,+Global%3E%3E-for-Arc%3C%5BT%5D%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.21.0">1.21.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2748">source</a></span><a href="#impl-From%3CVec%3CT,+Global%3E%3E-for-Arc%3C%5BT%5D%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;<a class="struct" href="../vec/struct.Vec.html" title="struct std::vec::Vec">Vec</a>&lt;T, <a class="struct" href="../alloc/struct.Global.html" title="struct std::alloc::Global">Global</a>&gt;&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-6" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2760">source</a><a href="#method.from-6" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(v: <a class="struct" href="../vec/struct.Vec.html" title="struct std::vec::Vec">Vec</a>&lt;T, <a class="struct" href="../alloc/struct.Global.html" title="struct std::alloc::Global">Global</a>&gt;) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt;</h4></section></summary><div class="docblock"><p>分配一个引用计数的切片，并将 <code>v</code> 的项移入其中。</p>
<h5 id="example-5"><a href="#example-5">Example</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>unique: Vec&lt;i32&gt; = <span class="macro">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];
<span class="kw">let </span>shared: Arc&lt;[i32]&gt; = Arc::from(unique);
<span class="macro">assert_eq!</span>(<span class="kw-2">&amp;</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="kw-2">&amp;</span>shared[..]);</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Alet+unique:+Vec%3Ci32%3E+=+vec!%5B1,+2,+3%5D;%0Alet+shared:+Arc%3C%5Bi32%5D%3E+=+Arc::from(unique);%0Aassert_eq!(%26%5B1,+2,+3%5D,+%26shared%5B..%5D);%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-FromIterator%3CT%3E-for-Arc%3C%5BT%5D%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.37.0">1.37.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2831">source</a></span><a href="#impl-FromIterator%3CT%3E-for-Arc%3C%5BT%5D%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../iter/trait.FromIterator.html" title="trait std::iter::FromIterator">FromIterator</a>&lt;T&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from_iter" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2870">source</a><a href="#method.from_iter" class="anchor">§</a><h4 class="code-header">fn <a href="../iter/trait.FromIterator.html#tymethod.from_iter" class="fn">from_iter</a>&lt;I&gt;(iter: I) -&gt; <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt;<span class="where fmt-newline">where
    I: <a class="trait" href="../iter/trait.IntoIterator.html" title="trait std::iter::IntoIterator">IntoIterator</a>&lt;Item = T&gt;,</span></h4></section></summary><div class="docblock"><p>获取 <code>Iterator</code> 中的每个元素，并将其收集到 <code>Arc&lt;[T]&gt;</code> 中。</p>
<h5 id="性能特点"><a href="#性能特点">性能特点</a></h5><h6 id="一般情况"><a href="#一般情况">一般情况</a></h6>
<p>在一般情况下，首先要收集到 <code>Vec&lt;T&gt;</code> 中来收集到 <code>Arc&lt;[T]&gt;</code> 中。也就是说，编写以下内容时：</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>evens: Arc&lt;[u8]&gt; = (<span class="number">0</span>..<span class="number">10</span>).filter(|<span class="kw-2">&amp;</span>x| x % <span class="number">2 </span>== <span class="number">0</span>).collect();</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Alet+evens:+Arc%3C%5Bu8%5D%3E+=+(0..10).filter(%7C%26x%7C+x+%25+2+==+0).collect();%0Aassert_eq!(%26*evens,+%26%5B0,+2,+4,+6,+8%5D);%0A%7D&amp;edition=2021">Run</a></div>
<p>这就像我们写的那样：</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>evens: Arc&lt;[u8]&gt; = (<span class="number">0</span>..<span class="number">10</span>).filter(|<span class="kw-2">&amp;</span>x| x % <span class="number">2 </span>== <span class="number">0</span>)
    .collect::&lt;Vec&lt;<span class="kw">_</span>&gt;&gt;() <span class="comment">// 第一组分配在此处发生。
    </span>.into(); <span class="comment">// `Arc&lt;[T]&gt;` 的第二个分配在此处进行。</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Alet+evens:+Arc%3C%5Bu8%5D%3E+=+(0..10).filter(%7C%26x%7C+x+%25+2+==+0)%0A++++.collect::%3CVec%3C_%3E%3E()+//+%E7%AC%AC%E4%B8%80%E7%BB%84%E5%88%86%E9%85%8D%E5%9C%A8%E6%AD%A4%E5%A4%84%E5%8F%91%E7%94%9F%E3%80%82%0A++++.into();+//+%60Arc%3C%5BT%5D%3E%60+%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E5%88%86%E9%85%8D%E5%9C%A8%E6%AD%A4%E5%A4%84%E8%BF%9B%E8%A1%8C%E3%80%82%0Aassert_eq!(%26*evens,+%26%5B0,+2,+4,+6,+8%5D);%0A%7D&amp;edition=2021">Run</a></div>
<p>这将分配构造 <code>Vec&lt;T&gt;</code> 所需的次数，然后分配一次，以将 <code>Vec&lt;T&gt;</code> 转换为 <code>Arc&lt;[T]&gt;</code>。</p>
<h6 id="已知长度的迭代器"><a href="#已知长度的迭代器">已知长度的迭代器</a></h6>
<p>当您的 <code>Iterator</code> 实现 <code>TrustedLen</code> 且大小正确时，将为 <code>Arc&lt;[T]&gt;</code> 进行一次分配。例如：</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>evens: Arc&lt;[u8]&gt; = (<span class="number">0</span>..<span class="number">10</span>).collect(); <span class="comment">// 这里只进行一次分配。</span></code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Alet+evens:+Arc%3C%5Bu8%5D%3E+=+(0..10).collect();+//+%E8%BF%99%E9%87%8C%E5%8F%AA%E8%BF%9B%E8%A1%8C%E4%B8%80%E6%AC%A1%E5%88%86%E9%85%8D%E3%80%82%0Aassert_eq!(%26*evens,+%26*(0..10).collect::%3CVec%3C_%3E%3E());%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Hash-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2642">source</a><a href="#impl-Hash-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../hash/trait.Hash.html" title="trait std::hash::Hash">Hash</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../hash/trait.Hash.html" title="trait std::hash::Hash">Hash</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.hash" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2643">source</a><a href="#method.hash" class="anchor">§</a><h4 class="code-header">fn <a href="../hash/trait.Hash.html#tymethod.hash" class="fn">hash</a>&lt;H&gt;(&amp;self, state: <a class="primitive" href="../primitive.reference.html">&amp;mut H</a>)<span class="where fmt-newline">where
    H: <a class="trait" href="../hash/trait.Hasher.html" title="trait std::hash::Hasher">Hasher</a>,</span></h4></section></summary><div class='docblock'>将该值输入给定的 <a href="../hash/trait.Hasher.html" title="trait std::hash::Hasher"><code>Hasher</code></a>。 <a href="../hash/trait.Hash.html#tymethod.hash">Read more</a></div></details><details class="toggle method-toggle" open><summary><section id="method.hash_slice" class="method trait-impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.3.0">1.3.0</span> · <a class="srclink" href="../../src/core/hash/mod.rs.html#237-239">source</a></span><a href="#method.hash_slice" class="anchor">§</a><h4 class="code-header">fn <a href="../hash/trait.Hash.html#method.hash_slice" class="fn">hash_slice</a>&lt;H&gt;(data: &amp;<a class="primitive" href="../primitive.slice.html">[Self]</a>, state: <a class="primitive" href="../primitive.reference.html">&amp;mut H</a>)<span class="where fmt-newline">where
    H: <a class="trait" href="../hash/trait.Hasher.html" title="trait std::hash::Hasher">Hasher</a>,
    Self: <a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h4></section></summary><div class='docblock'>将这种类型的切片送入给定的 <a href="../hash/trait.Hasher.html" title="trait std::hash::Hasher"><code>Hasher</code></a> 中。 <a href="../hash/trait.Hash.html#method.hash_slice">Read more</a></div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Ord-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2580">source</a><a href="#impl-Ord-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../cmp/trait.Ord.html" title="trait std::cmp::Ord">Ord</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../cmp/trait.Ord.html" title="trait std::cmp::Ord">Ord</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.cmp" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2595">source</a><a href="#method.cmp" class="anchor">§</a><h4 class="code-header">fn <a href="../cmp/trait.Ord.html#tymethod.cmp" class="fn">cmp</a>(&amp;self, other: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="enum" href="../cmp/enum.Ordering.html" title="enum std::cmp::Ordering">Ordering</a></h4></section></summary><div class="docblock"><p>两个 <code>Arc</code> 的比较。</p>
<p>通过调用 <code>cmp()</code> 的内部值来比较两者。</p>
<h5 id="examples-28"><a href="#examples-28">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;
<span class="kw">use </span>std::cmp::Ordering;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="macro">assert_eq!</span>(Ordering::Less, five.cmp(<span class="kw-2">&amp;</span>Arc::new(<span class="number">6</span>)));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Ause+std::cmp::Ordering;%0A%0Alet+five+=+Arc::new(5);%0A%0Aassert_eq!(Ordering::Less,+five.cmp(%26Arc::new(6)));%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.max" class="method trait-impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.21.0">1.21.0</span> · <a class="srclink" href="../../src/core/cmp.rs.html#790-792">source</a></span><a href="#method.max" class="anchor">§</a><h4 class="code-header">fn <a href="../cmp/trait.Ord.html#method.max" class="fn">max</a>(self, other: Self) -&gt; Self<span class="where fmt-newline">where
    Self: <a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h4></section></summary><div class='docblock'>比较并返回两个值中的最大值。 <a href="../cmp/trait.Ord.html#method.max">Read more</a></div></details><details class="toggle method-toggle" open><summary><section id="method.min" class="method trait-impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.21.0">1.21.0</span> · <a class="srclink" href="../../src/core/cmp.rs.html#810-812">source</a></span><a href="#method.min" class="anchor">§</a><h4 class="code-header">fn <a href="../cmp/trait.Ord.html#method.min" class="fn">min</a>(self, other: Self) -&gt; Self<span class="where fmt-newline">where
    Self: <a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h4></section></summary><div class='docblock'>比较并返回两个值中的最小值。 <a href="../cmp/trait.Ord.html#method.min">Read more</a></div></details><details class="toggle method-toggle" open><summary><section id="method.clamp" class="method trait-impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.50.0">1.50.0</span> · <a class="srclink" href="../../src/core/cmp.rs.html#835-838">source</a></span><a href="#method.clamp" class="anchor">§</a><h4 class="code-header">fn <a href="../cmp/trait.Ord.html#method.clamp" class="fn">clamp</a>(self, min: Self, max: Self) -&gt; Self<span class="where fmt-newline">where
    Self: <a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a> + <a class="trait" href="../cmp/trait.PartialOrd.html" title="trait std::cmp::PartialOrd">PartialOrd</a>&lt;Self&gt;,</span></h4></section></summary><div class='docblock'>将值限制在某个时间间隔内。 <a href="../cmp/trait.Ord.html#method.clamp">Read more</a></div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-PartialEq%3CArc%3CT%3E%3E-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2446">source</a><a href="#impl-PartialEq%3CArc%3CT%3E%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../cmp/trait.PartialEq.html" title="trait std::cmp::PartialEq">PartialEq</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../cmp/trait.PartialEq.html" title="trait std::cmp::PartialEq">PartialEq</a>&lt;T&gt; + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.eq" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2465">source</a><a href="#method.eq" class="anchor">§</a><h4 class="code-header">fn <a href="../cmp/trait.PartialEq.html#tymethod.eq" class="fn">eq</a>(&amp;self, other: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>两个 <code>Arc</code> 的相等性。</p>
<p>即使两个 <code>Arc</code> 的内部值相等，即使它们存储在不同的分配中，它们也相等。</p>
<p>如果 <code>T</code> 还实现了 <code>Eq</code> (暗示相等的反射性)，则指向同一分配的两个 Arc 总是相等的。</p>
<h5 id="examples-30"><a href="#examples-30">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="macro">assert!</span>(five == Arc::new(<span class="number">5</span>));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0A%0Aassert!(five+==+Arc::new(5));%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.ne" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2486">source</a><a href="#method.ne" class="anchor">§</a><h4 class="code-header">fn <a href="../cmp/trait.PartialEq.html#method.ne" class="fn">ne</a>(&amp;self, other: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>两个 <code>Arc</code> 的不等式。</p>
<p>如果两个 <code>Arc</code> 的内部值不相等，则它们不相等。</p>
<p>如果 <code>T</code> 也实现了 <code>Eq</code> (暗示相等的，反射，性)，则指向相同值的两个 <code>Arc</code> 总是相等的。</p>
<h5 id="examples-31"><a href="#examples-31">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="macro">assert!</span>(five != Arc::new(<span class="number">6</span>));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0A%0Aassert!(five+!=+Arc::new(6));%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-PartialOrd%3CArc%3CT%3E%3E-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2492">source</a><a href="#impl-PartialOrd%3CArc%3CT%3E%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../cmp/trait.PartialOrd.html" title="trait std::cmp::PartialOrd">PartialOrd</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../cmp/trait.PartialOrd.html" title="trait std::cmp::PartialOrd">PartialOrd</a>&lt;T&gt; + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.partial_cmp" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2507">source</a><a href="#method.partial_cmp" class="anchor">§</a><h4 class="code-header">fn <a href="../cmp/trait.PartialOrd.html#tymethod.partial_cmp" class="fn">partial_cmp</a>(&amp;self, other: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="enum" href="../option/enum.Option.html" title="enum std::option::Option">Option</a>&lt;<a class="enum" href="../cmp/enum.Ordering.html" title="enum std::cmp::Ordering">Ordering</a>&gt;</h4></section></summary><div class="docblock"><p>两个 <code>Arc</code> 的部分比较。</p>
<p>通过调用 <code>partial_cmp()</code> 的内部值来比较两者。</p>
<h5 id="examples-32"><a href="#examples-32">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;
<span class="kw">use </span>std::cmp::Ordering;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="macro">assert_eq!</span>(<span class="prelude-val">Some</span>(Ordering::Less), five.partial_cmp(<span class="kw-2">&amp;</span>Arc::new(<span class="number">6</span>)));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0Ause+std::cmp::Ordering;%0A%0Alet+five+=+Arc::new(5);%0A%0Aassert_eq!(Some(Ordering::Less),+five.partial_cmp(%26Arc::new(6)));%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.lt" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2524">source</a><a href="#method.lt" class="anchor">§</a><h4 class="code-header">fn <a href="../cmp/trait.PartialOrd.html#method.lt" class="fn">lt</a>(&amp;self, other: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>小于两个 Arc 的比较。</p>
<p>通过调用 <code>&lt;</code> 的内部值来比较两者。</p>
<h5 id="examples-33"><a href="#examples-33">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="macro">assert!</span>(five &lt; Arc::new(<span class="number">6</span>));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0A%0Aassert!(five+%3C+Arc::new(6));%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.le" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2541">source</a><a href="#method.le" class="anchor">§</a><h4 class="code-header">fn <a href="../cmp/trait.PartialOrd.html#method.le" class="fn">le</a>(&amp;self, other: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>两个 <code>Arc</code> 的小于或等于比较。</p>
<p>通过调用 <code>&lt;=</code> 的内部值来比较两者。</p>
<h5 id="examples-34"><a href="#examples-34">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="macro">assert!</span>(five &lt;= Arc::new(<span class="number">5</span>));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0A%0Aassert!(five+%3C=+Arc::new(5));%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.gt" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2558">source</a><a href="#method.gt" class="anchor">§</a><h4 class="code-header">fn <a href="../cmp/trait.PartialOrd.html#method.gt" class="fn">gt</a>(&amp;self, other: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>大于两个 <code>Arc</code> 的比较。</p>
<p>通过调用 <code>&gt;</code> 的内部值来比较两者。</p>
<h5 id="examples-35"><a href="#examples-35">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="macro">assert!</span>(five &gt; Arc::new(<span class="number">4</span>));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0A%0Aassert!(five+%3E+Arc::new(4));%0A%7D&amp;edition=2021">Run</a></div>
</div></details><details class="toggle method-toggle" open><summary><section id="method.ge" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2575">source</a><a href="#method.ge" class="anchor">§</a><h4 class="code-header">fn <a href="../cmp/trait.PartialOrd.html#method.ge" class="fn">ge</a>(&amp;self, other: &amp;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;) -&gt; <a class="primitive" href="../primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>两个 <code>Arc</code> 的大于或等于比较。</p>
<p>通过调用 <code>&gt;=</code> 的内部值来比较两者。</p>
<h5 id="examples-36"><a href="#examples-36">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::sync::Arc;

<span class="kw">let </span>five = Arc::new(<span class="number">5</span>);

<span class="macro">assert!</span>(five &gt;= Arc::new(<span class="number">5</span>));</code></pre><a class="test-arrow" target="_blank" href="https://play.rust-lang.org/?code=%23!%5Ballow(unused)%5D%0Afn+main()+%7B%0Ause+std::sync::Arc;%0A%0Alet+five+=+Arc::new(5);%0A%0Aassert!(five+%3E=+Arc::new(5));%0A%7D&amp;edition=2021">Run</a></div>
</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-Pointer-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2617">source</a><a href="#impl-Pointer-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../fmt/trait.Pointer.html" title="trait std::fmt::Pointer">Pointer</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.fmt" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2618">source</a><a href="#method.fmt" class="anchor">§</a><h4 class="code-header">fn <a href="../fmt/trait.Pointer.html#tymethod.fmt" class="fn">fmt</a>(&amp;self, f: &amp;mut <a class="struct" href="../fmt/struct.Formatter.html" title="struct std::fmt::Formatter">Formatter</a>&lt;'_&gt;) -&gt; <a class="enum" href="../result/enum.Result.html" title="enum std::result::Result">Result</a>&lt;<a class="primitive" href="../primitive.unit.html">()</a>, <a class="struct" href="../fmt/struct.Error.html" title="struct std::fmt::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>使用给定的格式化程序格式化该值。</div></details></div></details><details class="toggle implementors-toggle" open><summary><section id="impl-TryFrom%3CArc%3C%5BT%5D%3E%3E-for-Arc%3C%5BT;+N%5D%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.43.0">1.43.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2817">source</a></span><a href="#impl-TryFrom%3CArc%3C%5BT%5D%3E%3E-for-Arc%3C%5BT;+N%5D%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T, const N: <a class="primitive" href="../primitive.usize.html">usize</a>&gt; <a class="trait" href="../convert/trait.TryFrom.html" title="trait std::convert::TryFrom">TryFrom</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt;&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.array.html">[T; N]</a>&gt;</h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Error" class="associatedtype trait-impl"><a href="#associatedtype.Error" class="anchor">§</a><h4 class="code-header">type <a href="../convert/trait.TryFrom.html#associatedtype.Error" class="associatedtype">Error</a> = <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt;</h4></section></summary><div class='docblock'>发生转换错误时返回的类型。</div></details><details class="toggle method-toggle" open><summary><section id="method.try_from" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2820">source</a><a href="#method.try_from" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.TryFrom.html#tymethod.try_from" class="fn">try_from</a>(
    boxed_slice: <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt;
) -&gt; <a class="enum" href="../result/enum.Result.html" title="enum std::result::Result">Result</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.array.html">[T; N]</a>&gt;, &lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.array.html">[T; N]</a>&gt; as <a class="trait" href="../convert/trait.TryFrom.html" title="trait std::convert::TryFrom">TryFrom</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;<a class="primitive" href="../primitive.slice.html">[T]</a>&gt;&gt;&gt;::<a class="associatedtype" href="../convert/trait.TryFrom.html#associatedtype.Error" title="type std::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>执行转换。</div></details></div></details><section id="impl-CoerceUnsized%3CArc%3CU%3E%3E-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#263">source</a><a href="#impl-CoerceUnsized%3CArc%3CU%3E%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="../ops/trait.CoerceUnsized.html" title="trait std::ops::CoerceUnsized">CoerceUnsized</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;U&gt;&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../marker/trait.Unsize.html" title="trait std::marker::Unsize">Unsize</a>&lt;U&gt; + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,
    U: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section><section id="impl-DispatchFromDyn%3CArc%3CU%3E%3E-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#266">source</a><a href="#impl-DispatchFromDyn%3CArc%3CU%3E%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="../ops/trait.DispatchFromDyn.html" title="trait std::ops::DispatchFromDyn">DispatchFromDyn</a>&lt;<a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;U&gt;&gt; for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../marker/trait.Unsize.html" title="trait std::marker::Unsize">Unsize</a>&lt;U&gt; + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,
    U: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section><section id="impl-Eq-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#2600">source</a><a href="#impl-Eq-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../cmp/trait.Eq.html" title="trait std::cmp::Eq">Eq</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../cmp/trait.Eq.html" title="trait std::cmp::Eq">Eq</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section><section id="impl-Send-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#255">source</a><a href="#impl-Send-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../marker/trait.Send.html" title="trait std::marker::Send">Send</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../marker/trait.Sync.html" title="trait std::marker::Sync">Sync</a> + <a class="trait" href="../marker/trait.Send.html" title="trait std::marker::Send">Send</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section><section id="impl-Sync-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/sync.rs.html#257">source</a><a href="#impl-Sync-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../marker/trait.Sync.html" title="trait std::marker::Sync">Sync</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../marker/trait.Sync.html" title="trait std::marker::Sync">Sync</a> + <a class="trait" href="../marker/trait.Send.html" title="trait std::marker::Send">Send</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section><section id="impl-Unpin-for-Arc%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.33.0">1.33.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#2929">source</a></span><a href="#impl-Unpin-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../marker/trait.Unpin.html" title="trait std::marker::Unpin">Unpin</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section><section id="impl-UnwindSafe-for-Arc%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.9.0">1.9.0</span> · <a class="srclink" href="../../src/alloc/sync.rs.html#260">source</a></span><a href="#impl-UnwindSafe-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../panic/trait.UnwindSafe.html" title="trait std::panic::UnwindSafe">UnwindSafe</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../panic/trait.RefUnwindSafe.html" title="trait std::panic::RefUnwindSafe">RefUnwindSafe</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></div><h2 id="synthetic-implementations" class="small-section-header">Auto Trait Implementations<a href="#synthetic-implementations" class="anchor">§</a></h2><div id="synthetic-implementations-list"><section id="impl-RefUnwindSafe-for-Arc%3CT%3E" class="impl"><a href="#impl-RefUnwindSafe-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>&gt; <a class="trait" href="../panic/trait.RefUnwindSafe.html" title="trait std::panic::RefUnwindSafe">RefUnwindSafe</a> for <a class="struct" href="struct.Arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;<span class="where fmt-newline">where
    T: <a class="trait" href="../panic/trait.RefUnwindSafe.html" title="trait std::panic::RefUnwindSafe">RefUnwindSafe</a>,</span></h3></section></div><h2 id="blanket-implementations" class="small-section-header">Blanket Implementations<a href="#blanket-implementations" class="anchor">§</a></h2><div id="blanket-implementations-list"><details class="toggle implementors-toggle"><summary><section id="impl-Any-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/any.rs.html#200">source</a><a href="#impl-Any-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../any/trait.Any.html" title="trait std::any::Any">Any</a> for T<span class="where fmt-newline">where
    T: 'static + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.type_id" class="method trait-impl"><a class="srclink rightside" href="../../src/core/any.rs.html#201">source</a><a href="#method.type_id" class="anchor">§</a><h4 class="code-header">fn <a href="../any/trait.Any.html#tymethod.type_id" class="fn">type_id</a>(&amp;self) -&gt; <a class="struct" href="../any/struct.TypeId.html" title="struct std::any::TypeId">TypeId</a></h4></section></summary><div class='docblock'>获取 <code>self</code> 的 <code>TypeId</code>。 <a href="../any/trait.Any.html#tymethod.type_id">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Borrow%3CT%3E-for-Arc%3CT%3E-1" class="impl"><a class="srclink rightside" href="../../src/core/borrow.rs.html#208">source</a><a href="#impl-Borrow%3CT%3E-for-Arc%3CT%3E-1" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../borrow/trait.Borrow.html" title="trait std::borrow::Borrow">Borrow</a>&lt;T&gt; for T<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.borrow-1" class="method trait-impl"><a class="srclink rightside" href="../../src/core/borrow.rs.html#210">source</a><a href="#method.borrow-1" class="anchor">§</a><h4 class="code-header">fn <a href="../borrow/trait.Borrow.html#tymethod.borrow" class="fn">borrow</a>(&amp;self) -&gt; <a class="primitive" href="../primitive.reference.html">&amp;T</a></h4></section></summary><div class='docblock'>从拥有的值中一成不变地借用。 <a href="../borrow/trait.Borrow.html#tymethod.borrow">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-BorrowMut%3CT%3E-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/borrow.rs.html#216">source</a><a href="#impl-BorrowMut%3CT%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../borrow/trait.BorrowMut.html" title="trait std::borrow::BorrowMut">BorrowMut</a>&lt;T&gt; for T<span class="where fmt-newline">where
    T: ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.borrow_mut" class="method trait-impl"><a class="srclink rightside" href="../../src/core/borrow.rs.html#217">source</a><a href="#method.borrow_mut" class="anchor">§</a><h4 class="code-header">fn <a href="../borrow/trait.BorrowMut.html#tymethod.borrow_mut" class="fn">borrow_mut</a>(&amp;mut self) -&gt; <a class="primitive" href="../primitive.reference.html">&amp;mut T</a></h4></section></summary><div class='docblock'>从拥有的值中借用。 <a href="../borrow/trait.BorrowMut.html#tymethod.borrow_mut">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-From%3C!%3E-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#740">source</a><a href="#impl-From%3C!%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;<a class="primitive" href="../primitive.never.html">!</a>&gt; for T</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-17" class="method trait-impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#741">source</a><a href="#method.from-17" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(t: <a class="primitive" href="../primitive.never.html">!</a>) -&gt; T</h4></section></summary><div class='docblock'>从输入类型转换为此类型。</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-From%3CT%3E-for-Arc%3CT%3E-1" class="impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#723">source</a><a href="#impl-From%3CT%3E-for-Arc%3CT%3E-1" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;T&gt; for T</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from-16" class="method trait-impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#726">source</a><a href="#method.from-16" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.From.html#tymethod.from" class="fn">from</a>(t: T) -&gt; T</h4></section></summary><div class="docblock"><p>返回未更改的参数。</p>
</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Into%3CU%3E-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#707">source</a><a href="#impl-Into%3CU%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="../convert/trait.Into.html" title="trait std::convert::Into">Into</a>&lt;U&gt; for T<span class="where fmt-newline">where
    U: <a class="trait" href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;T&gt;,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.into" class="method trait-impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#716">source</a><a href="#method.into" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.Into.html#tymethod.into" class="fn">into</a>(self) -&gt; U</h4></section></summary><div class="docblock"><p>调用 <code>U::from(self)</code>。</p>
<p>也就是说，这种转换是 <code><a href="../convert/trait.From.html" title="trait std::convert::From">From</a>&lt;T&gt; for U</code> 实现选择执行的任何操作。</p>
</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Provider-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/error.rs.html#198">source</a><a href="#impl-Provider-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;E&gt; <a class="trait" href="../any/trait.Provider.html" title="trait std::any::Provider">Provider</a> for E<span class="where fmt-newline">where
    E: <a class="trait" href="../error/trait.Error.html" title="trait std::error::Error">Error</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.provide-1" class="method trait-impl"><a class="srclink rightside" href="../../src/core/error.rs.html#202">source</a><a href="#method.provide-1" class="anchor">§</a><h4 class="code-header">fn <a href="../any/trait.Provider.html#tymethod.provide" class="fn">provide</a>&lt;'a&gt;(&amp;'a self, demand: &amp;mut <a class="struct" href="../any/struct.Demand.html" title="struct std::any::Demand">Demand</a>&lt;'a&gt;)</h4></section></summary><span class="item-info"><div class="stab unstable"><span class="emoji">🔬</span><span>This is a nightly-only experimental API. (<code>provide_any</code>&nbsp;<a href="https://github.com/rust-lang/rust/issues/96024">#96024</a>)</span></div></span><div class='docblock'>数据提供者应实现此方法以提供他们能够通过使用 <code>demand</code> 提供的<em>所有</em>值。 <a href="../any/trait.Provider.html#tymethod.provide">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-ToOwned-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/borrow.rs.html#82">source</a><a href="#impl-ToOwned-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../borrow/trait.ToOwned.html" title="trait std::borrow::ToOwned">ToOwned</a> for T<span class="where fmt-newline">where
    T: <a class="trait" href="../clone/trait.Clone.html" title="trait std::clone::Clone">Clone</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Owned" class="associatedtype trait-impl"><a href="#associatedtype.Owned" class="anchor">§</a><h4 class="code-header">type <a href="../borrow/trait.ToOwned.html#associatedtype.Owned" class="associatedtype">Owned</a> = T</h4></section></summary><div class='docblock'>获得所有权后的结果类型。</div></details><details class="toggle method-toggle" open><summary><section id="method.to_owned" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/borrow.rs.html#87">source</a><a href="#method.to_owned" class="anchor">§</a><h4 class="code-header">fn <a href="../borrow/trait.ToOwned.html#tymethod.to_owned" class="fn">to_owned</a>(&amp;self) -&gt; T</h4></section></summary><div class='docblock'>从借用的数据创建拥有的数据，通常是通过克隆。 <a href="../borrow/trait.ToOwned.html#tymethod.to_owned">Read more</a></div></details><details class="toggle method-toggle" open><summary><section id="method.clone_into" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/borrow.rs.html#91">source</a><a href="#method.clone_into" class="anchor">§</a><h4 class="code-header">fn <a href="../borrow/trait.ToOwned.html#method.clone_into" class="fn">clone_into</a>(&amp;self, target: <a class="primitive" href="../primitive.reference.html">&amp;mut T</a>)</h4></section></summary><div class='docblock'>使用借来的数据来替换拥有的数据，通常是通过克隆。 <a href="../borrow/trait.ToOwned.html#method.clone_into">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-ToString-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/alloc/string.rs.html#2513">source</a><a href="#impl-ToString-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="../string/trait.ToString.html" title="trait std::string::ToString">ToString</a> for T<span class="where fmt-newline">where
    T: <a class="trait" href="../fmt/trait.Display.html" title="trait std::fmt::Display">Display</a> + ?<a class="trait" href="../marker/trait.Sized.html" title="trait std::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.to_string" class="method trait-impl"><a class="srclink rightside" href="../../src/alloc/string.rs.html#2519">source</a><a href="#method.to_string" class="anchor">§</a><h4 class="code-header">default fn <a href="../string/trait.ToString.html#tymethod.to_string" class="fn">to_string</a>(&amp;self) -&gt; <a class="struct" href="../string/struct.String.html" title="struct std::string::String">String</a></h4></section></summary><div class='docblock'>将给定值转换为 <code>String</code>。 <a href="../string/trait.ToString.html#tymethod.to_string">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-TryFrom%3CU%3E-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#763">source</a><a href="#impl-TryFrom%3CU%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="../convert/trait.TryFrom.html" title="trait std::convert::TryFrom">TryFrom</a>&lt;U&gt; for T<span class="where fmt-newline">where
    U: <a class="trait" href="../convert/trait.Into.html" title="trait std::convert::Into">Into</a>&lt;T&gt;,</span></h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Error-1" class="associatedtype trait-impl"><a href="#associatedtype.Error-1" class="anchor">§</a><h4 class="code-header">type <a href="../convert/trait.TryFrom.html#associatedtype.Error" class="associatedtype">Error</a> = <a class="enum" href="../convert/enum.Infallible.html" title="enum std::convert::Infallible">Infallible</a></h4></section></summary><div class='docblock'>发生转换错误时返回的类型。</div></details><details class="toggle method-toggle" open><summary><section id="method.try_from-1" class="method trait-impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#770">source</a><a href="#method.try_from-1" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.TryFrom.html#tymethod.try_from" class="fn">try_from</a>(value: U) -&gt; <a class="enum" href="../result/enum.Result.html" title="enum std::result::Result">Result</a>&lt;T, &lt;T as <a class="trait" href="../convert/trait.TryFrom.html" title="trait std::convert::TryFrom">TryFrom</a>&lt;U&gt;&gt;::<a class="associatedtype" href="../convert/trait.TryFrom.html#associatedtype.Error" title="type std::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>执行转换。</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-TryInto%3CU%3E-for-Arc%3CT%3E" class="impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#748">source</a><a href="#impl-TryInto%3CU%3E-for-Arc%3CT%3E" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="../convert/trait.TryInto.html" title="trait std::convert::TryInto">TryInto</a>&lt;U&gt; for T<span class="where fmt-newline">where
    U: <a class="trait" href="../convert/trait.TryFrom.html" title="trait std::convert::TryFrom">TryFrom</a>&lt;T&gt;,</span></h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Error-2" class="associatedtype trait-impl"><a href="#associatedtype.Error-2" class="anchor">§</a><h4 class="code-header">type <a href="../convert/trait.TryInto.html#associatedtype.Error" class="associatedtype">Error</a> = &lt;U as <a class="trait" href="../convert/trait.TryFrom.html" title="trait std::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="../convert/trait.TryFrom.html#associatedtype.Error" title="type std::convert::TryFrom::Error">Error</a></h4></section></summary><div class='docblock'>发生转换错误时返回的类型。</div></details><details class="toggle method-toggle" open><summary><section id="method.try_into" class="method trait-impl"><a class="srclink rightside" href="../../src/core/convert/mod.rs.html#755">source</a><a href="#method.try_into" class="anchor">§</a><h4 class="code-header">fn <a href="../convert/trait.TryInto.html#tymethod.try_into" class="fn">try_into</a>(self) -&gt; <a class="enum" href="../result/enum.Result.html" title="enum std::result::Result">Result</a>&lt;U, &lt;U as <a class="trait" href="../convert/trait.TryFrom.html" title="trait std::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="../convert/trait.TryFrom.html#associatedtype.Error" title="type std::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>执行转换。</div></details></div></details></div></section></div></main></body></html>